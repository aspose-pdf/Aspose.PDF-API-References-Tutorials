---
title: Добавить элемент структуры в элемент
linktitle: Добавить элемент структуры в элемент
second_title: Справочник по API Aspose.PDF для .NET
description: Узнайте, как добавлять элементы структуры доступности в PDF-файлы с помощью Aspose.PDF для .NET в этом подробном пошаговом руководстве.
type: docs
weight: 20
url: /ru/net/programming-with-tagged-pdf/add-structure-element-into-element/
---
## Введение

В современном цифровом мире доступность является ключевым фактором. Каждый должен иметь равный доступ к информации, и предоставление ее в формате, в котором все люди могут легко ориентироваться, имеет решающее значение. В этом руководстве мы рассмотрим, как улучшить доступность PDF, добавив элементы структуры с помощью Aspose.PDF для .NET. Эта мощная библиотека позволяет разработчикам работать с PDF-документами без проблем, позволяя им создавать тегированные PDF-файлы, соответствующие стандартам доступности.

## Предпосылки

Прежде чем начать путешествие в мир элементов структуры PDF, давайте убедимся, что у вас есть все необходимое:

1.  Визуальная Студия: Это ваша IDE, где вы будете писать и запускать свой код C#. Вы можете загрузить его с[Visual Studio](https://visualstudio.microsoft.com/) если вы еще этого не сделали.
2.  Библиотека Aspose.PDF для .NET: Вам понадобится библиотека для работы с PDF-файлами. Загрузите последнюю версию с сайта[Сайт Aspose](https://releases.aspose.com/pdf/net/). Эта библиотека имеет решающее значение для нашего проекта.
3. Базовые знания C#: Знакомство с синтаксисом C# и объектно-ориентированным программированием будет полезным. Если вы можете с радостью написать несколько строк на C#, вы готовы!
4. Каталог PDF-документов: создайте каталог в своей системе, в котором вы будете хранить входные и выходные PDF-файлы для этого руководства.

Теперь, когда у нас есть все необходимые инструменты и знания, давайте соберем необходимые пакеты, чтобы начать работу!

## Импортные пакеты

Для начала давайте импортируем необходимые пространства имен. Убедитесь, что в верхней части вашего файла C# есть следующее:

```csharp
using Aspose.Pdf.LogicalStructure;
using Aspose.Pdf.Tagged;
using System;
```

Эти пространства имен предоставляют вам доступ к классам и методам, необходимым для работы с вашими PDF-документами и создания тегированного контента. Теперь давайте перейдем к сути вопроса и начнем кодировать!

## Шаг 1: Настройте каталог документов

Прежде чем приступить к кодированию, нам нужно определить, где мы будем сохранять наши файлы. Это имеет решающее значение для бесперебойной работы нашего скрипта.

```csharp
// Определите путь к каталогу документов.
string dataDir = "YOUR DOCUMENT DIRECTORY"; 
```

 Заменять`"YOUR DOCUMENT DIRECTORY"` с фактическим путем, где вы хотите сохранить ваши PDF-файлы. Это может быть что-то вроде`C:\\PDFs\\`.

## Шаг 2: Создайте новый PDF-документ

Теперь, когда у нас есть набор каталогов, давайте создадим PDF-документ, в который добавим элементы нашей структуры.

```csharp
Document document = new Document();
```

 Эта строка инициализирует новый экземпляр`Document` класс, позволяющий нам начать работу с нашим PDF-контентом.

## Шаг 3: Доступ и настройка тегированного контента

Как только ваш документ будет готов, пришло время настроить тегированный контент, который необходим для обеспечения доступности.

### Инициализировать тегированный контент

```csharp
ITaggedContent taggedContent = document.TaggedContent;
```

Эта строка обеспечивает доступ к тегированному содержимому вашего PDF-файла. Тегированное содержимое необходимо для считывателей экрана, чтобы точно интерпретировать ваш документ.

### Установить метаданные документа

Вам нужно будет дать своему документу правильное название и определить язык.

```csharp
taggedContent.SetTitle("Text Elements Example");
taggedContent.SetLanguage("en-US");
```

Это расширяет метаданные документа и повышает его доступность.

## Шаг 4: Создание и добавление элементов структуры

Давайте добавим немного структуры! Это включает в себя создание абзацев и элементов span для создания правильно отформатированного и размеченного документа.

### Создать корневой структурный элемент

```csharp
StructureElement rootElement = taggedContent.RootElement;
```

Теперь мы создадим наш первый набор абзацев и элементов span.

### Создать элемент первого абзаца

```csharp
ParagraphElement p1 = taggedContent.CreateParagraphElement();
rootElement.AppendChild(p1);
```

Здесь мы инициализируем новый элемент абзаца и добавляем его к корневому элементу структуры. Это отправная точка вашего контента!

### Добавить элементы Span в абзац

```csharp
SpanElement span11 = taggedContent.CreateSpanElement();
span11.SetText("Span_11");
SpanElement span12 = taggedContent.CreateSpanElement();
span12.SetText(" and Span_12.");
```

 The`span` элементы — это как мини-абзацы внутри нашего большего абзаца. Они позволяют более точно контролировать форматирование текста.

### Объедините все это

Теперь давайте построим полный абзац со всеми элементами вместе:

```csharp
p1.SetText("Paragraph with ");
p1.AppendChild(span11);
p1.AppendChild(span12);
```

### Повторите для дополнительных абзацев.

Повторите этот процесс для дополнительных абзацев:

```csharp
ParagraphElement p2 = taggedContent.CreateParagraphElement();
rootElement.AppendChild(p2);
SpanElement span21 = taggedContent.CreateSpanElement();
span21.SetText("Span_21");
SpanElement span22 = taggedContent.CreateSpanElement();
span22.SetText("Span_22.");
p2.AppendChild(span21);
p2.SetText(" and ");
p2.AppendChild(span22);
```

 Просто продолжай творить`ParagraphElement` песок`SpanElement` s, добавляя их к`rootElement` таким же образом, как показано выше для`p1`.

## Шаг 5: Сохраните документ

Когда все элементы структуры будут на своих местах, настанет время сохранить ваш PDF-документ.

### Укажите путь к выходному файлу

```csharp
string outFile = dataDir + "AddStructureElementIntoElement_Output.pdf";
```

### Сохранить документ

```csharp
document.Save(outFile);
```

Вот тут-то и происходит волшебство! Ваш документ сохраняется по указанному пути выходного файла.

## Шаг 6: Проверка соответствия PDF/UA

Последний шаг — проверка соответствия вашего документа стандартам доступности PDF/UA.

Для проверки соответствия используйте следующий код:

```csharp
document = new Document(outFile);
string logFile = dataDir + "46144_log.xml";
bool isPdfUaCompliance = document.Validate(logFile, PdfFormat.PDF_UA_1);
Console.WriteLine(String.Format("PDF/UA compliance: {0}", isPdfUaCompliance));
```

Это позволит узнать, соответствует ли ваш документ стандартам PDF/UA, что важно для обеспечения доступности.

## Заключение

И вот оно! Вы только что узнали, как добавлять элементы структуры в документ PDF с помощью Aspose.PDF для .NET. Выполнив эти шаги, вы сможете преобразовать любой PDF в доступный формат, который соответствует стандартам, гарантируя всем равный доступ к информации. 

## Часто задаваемые вопросы

### Что такое Aspose.PDF для .NET?
Aspose.PDF для .NET — это библиотека, которая позволяет разработчикам создавать, изменять и конвертировать PDF-документы программным способом.

### Как проверить, доступен ли мой PDF-файл?
Вы можете проверить свой PDF-файл на соответствие стандартам PDF/UA с помощью библиотеки Aspose.PDF, чтобы убедиться в его соответствии рекомендациям по обеспечению доступности.

### Могу ли я использовать Aspose.PDF бесплатно?
 Да, Aspose предлагает бесплатную пробную версию, позволяющую вам изучить ее возможности без каких-либо затрат. Вы можете загрузить ее[здесь](https://releases.aspose.com/).

### Где я могу найти документацию по Aspose.PDF?
Вы можете найти полную документацию по Aspose.PDF[здесь](https://reference.aspose.com/pdf/net/).

### Как приобрести лицензию на Aspose.PDF?
 Вы можете купить лицензию непосредственно на сайте Aspose.[здесь](https://purchase.aspose.com/buy).