---
title: Штампы с номерами страниц в PDF-файле
linktitle: Штампы с номерами страниц в PDF-файле
second_title: Справочник по Aspose.PDF для .NET API
description: Узнайте, как добавлять штампы с номерами страниц в PDF-файл с помощью Aspose.PDF для .NET.
type: docs
weight: 160
url: /ru/net/programming-with-stamps-and-watermarks/page-number-stamps/
---
В этом уроке мы шаг за шагом покажем вам, как добавить штампы с номерами страниц в PDF-файл с помощью Aspose.PDF для .NET. Мы будем использовать предоставленный исходный код C#, чтобы открыть существующий PDF-документ, создать отметку номера страницы, установить ее свойства и добавить ее на определенную страницу в PDF-файле.

## Шаг 1. Настройка среды

Прежде чем начать, убедитесь, что у вас есть следующее:

- Установленная среда разработки .NET.
- Библиотека Aspose.PDF для .NET загружена и используется в вашем проекте.

## Шаг 2. Загрузка существующего PDF-документа.

Первым шагом является загрузка существующего PDF-документа в ваш проект. Вот как:

```csharp
// Путь к каталогу документов.
string dataDir = "YOUR DOCUMENTS DIRECTORY";

// Откройте существующий PDF-документ
Document pdfDocument = new Document(dataDir + "PageNumberStamp.pdf");
```

Обязательно замените «КАТАЛОГ ВАШИХ ДОКУМЕНТОВ» фактическим путем к каталогу, в котором находится ваш PDF-документ.

## Шаг 3. Создание и настройка штампа нумерации страниц

Теперь, когда документ PDF загружен, мы можем создать буфер нумерации страниц и настроить его в соответствии с нашими потребностями. Вот как:

```csharp
// Создать буфер номеров страниц
PageNumberStamp pageNumberStamp = new PageNumberStamp();

// Определите, находится ли буфер в фоновом режиме или нет.
pageNumberStamp.Background = false;

// Формат буфера нумерации страниц
pageNumberStamp.Format = "Page # of " + pdfDocument.Pages.Count;

// Нижнее поле буфера нумерации страниц
pageNumberStamp.BottomMargin = 10;

// Горизонтальное выравнивание буфера нумерации страниц
pageNumberStamp.HorizontalAlignment = HorizontalAlignment.Center;

// Начальный номер нумерации страниц
pageNumberStamp.StartingNumber = 1;

// Установить свойства текста буфера номеров страниц
pageNumberStamp.TextState.Font = FontRepository.FindFont("Arial");
pageNumberStamp.TextState.FontSize = 14.0F;
pageNumberStamp.TextState.FontStyle = FontStyles.Bold;
pageNumberStamp.TextState.FontStyle = FontStyles.Italic;
pageNumberStamp.TextState.ForegroundColor = Color.Aqua;
```

Приведенный выше код создает штамп номера страницы с такими свойствами, как формат номера страницы, нижнее поле, горизонтальное выравнивание, начальный номер и свойства текста.

## Шаг 4. Добавление штампа номера страницы на определенную страницу

После настройки отметки номера страницы мы можем добавить ее на определенную страницу PDF-документа. Вот как:

```csharp
// Добавить буфер номеров страниц на определенную страницу
pdfDocument.Pages[1].AddStamp(pageNumberStamp);
```

Приведенный выше код добавляет отметку с номером страницы на первую страницу PDF-документа. При необходимости вы можете изменить номер страницы.

## Шаг 5. Сохранение измененного PDF-документа.

После добавления отметки номера страницы в PDF-документ мы можем сохранить измененный PDF-документ. Вот как:

```csharp
// Сохраните измененный PDF-документ.
pdfDocument.Save(dataDir + "PageNumberStamp_out.pdf");
```

Обязательно замените «КАТАЛОГ ВАШИХ ДОКУМЕНТОВ» фактическим путем к каталогу, в котором вы хотите сохранить отредактированный PDF-документ.

### Пример исходного кода для штампов с номерами страниц с использованием Aspose.PDF для .NET 
```csharp

// Путь к каталогу документов.
string dataDir = "YOUR DOCUMENT DIRECTORY";

// Открыть документ
Document pdfDocument = new Document(dataDir+ "PageNumberStamp.pdf");

// Создать штамп с номером страницы
PageNumberStamp pageNumberStamp = new PageNumberStamp();

// Является ли штамп фоном
pageNumberStamp.Background = false;
pageNumberStamp.Format = "Page # of " + pdfDocument.Pages.Count;
pageNumberStamp.BottomMargin = 10;
pageNumberStamp.HorizontalAlignment = HorizontalAlignment.Center;
pageNumberStamp.StartingNumber = 1;

// Установить свойства текста
pageNumberStamp.TextState.Font = FontRepository.FindFont("Arial");
pageNumberStamp.TextState.FontSize = 14.0F;
pageNumberStamp.TextState.FontStyle = FontStyles.Bold;
pageNumberStamp.TextState.FontStyle = FontStyles.Italic;
pageNumberStamp.TextState.ForegroundColor = Color.Aqua;

// Добавить штамп на определенную страницу
pdfDocument.Pages[1].AddStamp(pageNumberStamp);
dataDir = dataDir + "PageNumberStamp_out.pdf";

// Сохранить выходной документ
pdfDocument.Save(dataDir);
Console.WriteLine("\nPage number stamp added successfully.\nFile saved at " + dataDir);

```

## Заключение

Поздравляем! Вы узнали, как добавлять штампы с номерами страниц в PDF-документ с помощью Aspose.PDF для .NET. Теперь вы можете персонализировать свои PDF-документы, добавив четкие и информативные номера страниц.

### Часто задаваемые вопросы о штампах с номерами страниц в PDF-файле

#### Вопрос: Что такое штамп номера страницы и как он используется для добавления номеров страниц в файл PDF?

О: Штамп номера страницы — это функция Aspose.PDF, которая позволяет добавлять динамические номера страниц к определенным страницам PDF-документа. В этом руководстве это достигается путем создания объекта PageNumberStamp, настройки его свойств и добавления его на назначенную страницу.

#### Вопрос: Как предоставленный исходный код C# позволяет добавлять отметки номеров страниц в PDF-файл?

О: Код демонстрирует, как загрузить существующий PDF-документ, создать PageNumberStamp, установить различные свойства (например, формат, шрифт, выравнивание и т. д.), а затем добавить штамп на определенную страницу. Штамп автоматически подсчитывает общее количество страниц и вставляет правильные номера страниц.

#### Вопрос: Могу ли я настроить внешний вид номера страницы, например стиль, цвет и размер шрифта?

О: Конечно, вы можете настроить внешний вид отметки номера страницы, настроив такие свойства, как шрифт, размер шрифта, стиль шрифта (жирный, курсив и т. д.) и цвет текста.

#### Вопрос: Можно ли добавлять штампы с номерами страниц на несколько страниц PDF-документа?

О: Да, вы можете добавлять штампы номеров страниц на несколько страниц, создав несколько объектов PageNumberStamp и добавив каждый из них на нужные страницы.

#### Вопрос: Могу ли я выбрать, будет ли отметка с номером страницы отображаться как часть содержимого страницы или как фоновый элемент?

 О: Да, вы можете контролировать, будет ли штамп номера страницы отображаться как часть содержимого страницы или как фоновый элемент, установив параметр`Background` свойство PageNumberStamp.

#### Вопрос: Как указать формат номера страницы, включая общее количество страниц?

 О: В коде используется`Format`Свойство PageNumberStamp, чтобы указать формат номера страницы. Макрос «# of» используется для представления общего количества страниц.

#### Вопрос: Что произойдет, если я добавлю один и тот же штамп с номером страницы на несколько страниц?

О: При добавлении одного и того же экземпляра PageNumberStamp на несколько страниц будут отображаться правильные номера страниц для каждой страницы. Штамп автоматически корректирует номер страницы и общее количество страниц.

#### Вопрос: Могу ли я добавить отметки с номерами страниц в верхний или нижний колонтитул PDF-документа?

О: Хотя PageNumberStamps обычно добавляются непосредственно к содержимому страницы, вы можете использовать FloatingBox или другие методы, чтобы разместить их в разделах верхнего или нижнего колонтитула.

#### Вопрос: Как указать положение отметки номера страницы на странице?

 А:`BottomMargin` и`HorizontalAlignment` Свойства PageNumberStamp позволяют вам управлять положением штампа на странице.

#### Вопрос: Что делать, если я хочу начать нумерацию страниц с другого номера, а не с 1?

 О: Вы можете установить`StartingNumber`Свойство PageNumberStamp для указания номера начальной страницы.