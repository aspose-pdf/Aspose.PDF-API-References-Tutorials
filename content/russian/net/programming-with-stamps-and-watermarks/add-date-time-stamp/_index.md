---
title: Добавить отметку даты и времени в файл PDF
linktitle: Добавить отметку даты и времени в файл PDF
second_title: Справочник по API Aspose.PDF для .NET
description: Узнайте, как легко добавить отметку даты и времени в PDF-файл с помощью Aspose.PDF для .NET.
type: docs
weight: 10
url: /ru/net/programming-with-stamps-and-watermarks/add-date-time-stamp/
---
В этой статье мы шаг за шагом расскажем вам, как добавить отметку даты и времени в файл PDF с помощью Aspose.PDF для .NET. Мы покажем вам, как использовать предоставленный исходный код C# для добавления отметки даты и времени в существующий файл PDF.

## Требования

Прежде чем начать, убедитесь, что у вас есть следующее:

- Установленная среда разработки .NET.
- Библиотека Aspose.PDF для .NET, загруженная и указанная в вашем проекте.

## Шаг 1: Настройка среды

Прежде чем вы сможете добавить отметку даты и времени в документ PDF, вам необходимо настроить среду разработки. Вот шаги, которые нужно выполнить:

1. Откройте вашу любимую IDE (интегрированную среду разработки).
2. Создайте новый проект C#.
3. Убедитесь, что вы добавили ссылку на библиотеку Aspose.PDF для .NET.

## Шаг 2: Добавление библиотеки Aspose.PDF

Для работы с PDF-документами в вашем проекте необходима библиотека Aspose.PDF для .NET.

## Шаг 3: Загрузка PDF-документа

Первый шаг к добавлению отметки даты и времени — загрузить существующий PDF-документ в ваш проект. Вот как это сделать:

```csharp
// Путь к каталогу документов.
string dataDir = "YOUR DOCUMENTS DIRECTORY";

// Открыть документ
Document pdfDocument = new Document(dataDir + "AddTextStamp.pdf");
```

Обязательно замените «КАТАЛОГ ВАШИХ ДОКУМЕНТОВ» фактическим путем к каталогу, в котором находится ваш PDF-документ.

## Шаг 4: Создание отметки даты и времени

Теперь, когда вы загрузили документ

  PDF, вы можете создать отметку даты и времени для добавления. Вот как это сделать:

```csharp
string annotationText = string.Empty;
annotationText = DateTime.Now.ToString("MM/dd/yy hh:mm:ss tt");

// Создать текстовый буфер
TextStamp textStamp = new TextStamp(annotationText);
```

Приведенный выше код создает новый текстовый буфер, содержащий текущую дату и время.

## Шаг 5: Настройка свойств штампа

Перед добавлением штампа в PDF-документ вы можете настроить различные свойства штампа, такие как поля, горизонтальное и вертикальное выравнивание и т. д. Вот как это сделать:

```csharp
// Установить свойства буфера
textStamp.BottomMargin = 10;
textStamp. RightMargin = 20;
textStamp.HorizontalAlignment = Aspose.Pdf.HorizontalAlignment.Right;
textStamp.VerticalAlignment = VerticalAlignment.Bottom;
```

Вы можете настроить эти свойства в соответствии со своими потребностями.

## Шаг 6: Добавьте штамп в PDF-файл

Теперь, когда отметка даты и времени готова, вы можете добавить ее на определенную страницу документа PDF. Вот как это сделать:

```csharp
// Добавить марку в коллекцию марок страницы
pdfDocument.Pages[1].AddStamp(textStamp);
```

Код выше добавляет штамп на первую страницу документа PDF. При необходимости можно указать другую страницу.

## Шаг 7: Сохраните выходной документ.

После добавления даты и времени вы можете сохранить измененный PDF-документ. Вот как это сделать:

```csharp
// Сохраните выходной документ
pdfDocument.Save(dataDir);
```

Приведенный выше код сохраняет отредактированный PDF-документ в указанном каталоге.

### Пример исходного кода для добавления метки даты и времени с использованием Aspose.PDF для .NET 
```csharp

// Путь к каталогу документов.
string dataDir = "YOUR DOCUMENT DIRECTORY";

// Открыть документ
Document pdfDocument = new Document(dataDir+ "AddTextStamp.pdf");
string annotationText = string.Empty;
annotationText = DateTime.Now.ToString("MM/dd/yy hh:mm:ss tt ");

// Создать текстовый штамп
TextStamp textStamp = new TextStamp(annotationText);

// Установить свойства штампа
textStamp.BottomMargin = 10;
textStamp.RightMargin = 20;
textStamp.HorizontalAlignment = Aspose.Pdf.HorizontalAlignment.Right;
textStamp.VerticalAlignment = VerticalAlignment.Bottom;

// Добавление марки в коллекцию марок
pdfDocument.Pages[1].AddStamp(textStamp);
DefaultAppearance default_appearance = new DefaultAppearance("Arial", 6, System.Drawing.Color.Black);
FreeTextAnnotation textAnnotation = new FreeTextAnnotation(pdfDocument.Pages[1], new Aspose.Pdf.Rectangle(0, 0, 0, 0), default_appearance);
textAnnotation.Name = "Stamp";
textAnnotation.Accept(new AnnotationSelector(textAnnotation));
textAnnotation.Contents = textStamp.Value;

Border border = new Border(textAnnotation);
border.Width = 0;
border.Dash = new Dash(1, 1);
textAnnotation.Border = border;
textAnnotation.Rect = new Aspose.Pdf.Rectangle(0, 0, 0, 0);
pdfDocument.Pages[1].Annotations.Add(textAnnotation);
dataDir = dataDir + "AddDateTimeStamp_out.pdf";

// Сохранить выходной документ
pdfDocument.Save(dataDir);
Console.WriteLine("\nDate time stamp added successfully.\nFile saved at " + dataDir);  
          
```

## Заключение

Поздравляем! Вы узнали, как добавлять отметку даты и времени с помощью Aspose.PDF для .NET. Теперь вы можете применить эти знания в своих собственных проектах для добавления отметок даты и времени в документы PDF.

### Часто задаваемые вопросы по добавлению отметки даты и времени в файл PDF

#### В: Какова цель добавления отметки даты и времени в PDF-документ с помощью Aspose.PDF для .NET?

A: Добавление отметки даты и времени в PDF-документ повышает его информационную ценность, указывая, когда документ был изменен или создан. Эта функция полезна для отслеживания изменений документа и предоставления точки отсчета для истории документа.

#### В: Могу ли я настроить формат отметки даты и времени в соответствии с конкретными требованиями?

 A: Да, вы можете настроить формат даты и времени в соответствии с вашими предпочтениями. Предоставленный исходный код C# использует`DateTime.Now.ToString()` метод для генерации временной метки в определенном формате. Вы можете изменить этот код, чтобы отформатировать временную метку по мере необходимости.

#### В: Можно ли добавить отметку даты и времени в определенное место на странице PDF-файла?

 A: Конечно, вы можете настроить размещение отметки даты и времени на странице PDF-файла, изменив свойства`TextStamp` объект. Код, представленный в руководстве, демонстрирует, как задать такие свойства, как поля, выравнивание и вертикальное позиционирование.

#### В: Можно ли добавить несколько отметок даты и времени на разные страницы одного и того же PDF-документа?

 A: Да, вы можете добавить несколько отметок даты и времени на разные страницы одного и того же документа PDF. Просто повторите процесс создания`TextStamp` объект и настройка его свойств для каждой желаемой страницы.

#### В: Как изменить шрифт, размер или цвет текста отметки даты и времени?

 A: Чтобы изменить шрифт, размер или цвет текста отметки даты и времени, вы можете настроить свойства`DefaultAppearance` объект, используемый для создания`TextStamp`. Отрегулируйте название шрифта, его размер и цветовые значения, чтобы добиться желаемого внешнего вида.

#### В: Можно ли добавлять другие типы аннотаций или штампов в PDF-документ с помощью Aspose.PDF для .NET?

A: Да, Aspose.PDF для .NET предоставляет широкий спектр типов аннотаций, которые можно добавлять в документы PDF, включая текстовые аннотации, штампы, линии, фигуры и многое другое. Вы можете изучить документацию Aspose.PDF для получения дополнительных сведений о работе с аннотациями.

#### В: Существуют ли какие-либо ограничения или особенности при добавлении отметки даты и времени в PDF-документ?

A: Хотя добавление штампа даты и времени является простым, примите во внимание такие факторы, как макет документа и существующее содержимое. Убедитесь, что размещение штампа не закрывает важную информацию и не влияет на читаемость документа.

#### В: Как я могу интегрировать этот метод в свои собственные проекты, чтобы добавлять отметки даты и времени в PDF-документы?

A: Чтобы интегрировать этот метод, следуйте предоставленным шагам и настройте код в соответствии со структурой вашего проекта. Вы можете добавлять отметки даты и времени к существующим документам PDF, чтобы повысить их полезность и предоставить четкую временную шкалу изменений.

#### В: Можно ли автоматизировать процесс добавления отметок даты и времени в несколько PDF-документов?

A: Да, вы можете автоматизировать процесс добавления отметок даты и времени в несколько PDF-документов, создав скрипт или программу, которая будет перебирать список документов и применять один и тот же процесс проставления отметок к каждому из них.