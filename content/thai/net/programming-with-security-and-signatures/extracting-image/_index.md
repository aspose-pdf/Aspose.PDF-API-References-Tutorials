---
title: การดึงภาพออกมา
linktitle: การดึงภาพออกมา
second_title: เอกสารอ้างอิง Aspose.PDF สำหรับ API ของ .NET
description: เรียนรู้วิธีการแยกภาพจาก PDF ได้อย่างง่ายดายโดยใช้ Aspose.PDF สำหรับ .NET ปฏิบัติตามคำแนะนำทีละขั้นตอนของเราเพื่อการแยกภาพอย่างราบรื่น
type: docs
weight: 70
url: /th/net/programming-with-security-and-signatures/extracting-image/
---
## การแนะนำ

ในโลกดิจิทัล PDF ได้กลายเป็นรูปแบบไฟล์ที่ใช้กันอย่างแพร่หลายที่สุดรูปแบบหนึ่ง ไม่ว่าจะเป็นรายงาน อีบุ๊ก หรือเอกสารสัญญา PDF ก็ได้กลายมาเป็นรูปแบบเฉพาะของตัวเอง คุณเคยพบว่าตัวเองจำเป็นต้องดึงรูปภาพออกจาก PDF หรือไม่ บางทีอาจเป็นสำหรับโครงการหรือเพียงเพราะรูปภาพนั้นสวยงามเป็นพิเศษ คุณโชคดีแล้ว! ในบทช่วยสอนนี้ เราจะแนะนำการใช้ Aspose.PDF สำหรับ .NET เพื่อดึงรูปภาพจากไฟล์ PDF ได้อย่างราบรื่น

## ข้อกำหนดเบื้องต้น

ก่อนที่เราจะเจาะลึกรายละเอียดในการแยกภาพ มีบางสิ่งที่คุณจำเป็นต้องตั้งค่าก่อน มาตรวจสอบกันก่อนว่าคุณพร้อมแล้ว!

### สภาพแวดล้อมการพัฒนา .NET

สิ่งแรกที่ต้องทำคือคุณต้องมีการตั้งค่าสภาพแวดล้อมการพัฒนาด้วย .NET โดยทั่วไปจะมีสิ่งต่อไปนี้:

-  Visual Studio: เป็น IDE ที่ทรงพลังสำหรับแอปพลิเคชัน .NET หากคุณยังไม่ได้ดาวน์โหลด คุณสามารถดาวน์โหลดได้จาก[เว็บไซต์ Visual Studio](https://visualstudio.microsoft.com/).
- .NET Framework: ตรวจสอบให้แน่ใจว่าคุณได้ติดตั้ง .NET Framework 4.5 ขึ้นไปบนเครื่องของคุณ

### Aspose.PDF สำหรับไลบรารี .NET

หากต้องการทำงานกับ PDF คุณจะต้องมีไลบรารี Aspose.PDF ไลบรารีนี้ช่วยให้คุณจัดการไฟล์ PDF ได้อย่างอิสระ รวมถึงการแยกรูปภาพด้วย วิธีรับไลบรารีนี้มีดังนี้

-  คุณสามารถทำได้[ดาวน์โหลดเวอร์ชั่นล่าสุด](https://releases.aspose.com/pdf/net/) ของ Aspose.PDF สำหรับ .NET
-  หากคุณต้องการทดลองใช้ก่อนซื้อ[ทดลองใช้งานฟรี](https://releases.aspose.com/) มีจำหน่ายแล้ว.
-  หากคุณตัดสินใจที่จะใช้งานต่อในระยะยาว คุณสามารถทำได้[ซื้อใบอนุญาต](https://purchase.aspose.com/buy) หรือแม้กระทั่ง[ขอใบอนุญาตชั่วคราว](https://purchase.aspose.com/temporary-license/) เพื่อวัตถุประสงค์ในการทดสอบ

### ความรู้พื้นฐานเกี่ยวกับ C#

ความเข้าใจพื้นฐานเกี่ยวกับ C# จะเป็นประโยชน์ หากคุณสามารถเขียนสคริปต์ C# ง่ายๆ ได้ คุณก็จะผ่านขั้นตอนนี้ไปได้อย่างง่ายดาย

## แพ็คเกจนำเข้า

ตอนนี้เราได้ตั้งค่าทุกอย่างเรียบร้อยแล้ว เริ่มต้นด้วยการนำเข้าแพ็คเกจที่จำเป็น คุณจะเริ่มต้นด้วยการรวมเนมสเปซ Aspose.PDF ไว้ที่ด้านบนของไฟล์ C# ของคุณ วิธีดำเนินการมีดังนี้:

```csharp
using System;
using System.IO;
using Aspose.Pdf;
using Aspose.Pdf.Forms;
using System.Drawing;
```

- Aspose.Pdf: นี่คือเนมสเปซหลักสำหรับการทำงานกับไฟล์ PDF
- Aspose.Pdf.Form: เนมสเปซนี้จัดการเฉพาะกับการจัดการแบบฟอร์มในเอกสาร PDF รวมถึงฟิลด์ต่างๆ เช่น กล่องข้อความและฟิลด์ลายเซ็น
- System.Drawing: เนมสเปซนี้ใช้สำหรับจัดการการเขียนโปรแกรมกราฟิกใน .NET
- System.IO: เนมสเปซนี้ประกอบด้วยฟังก์ชันการประมวลผลไฟล์และสตรีมข้อมูล

เอาล่ะ มาเข้าเรื่องกันเลยดีกว่า: การแยกภาพออกมา! เราจะใช้โค้ดต่อไปนี้เป็นพื้นฐาน

## ขั้นตอนที่ 1: กำหนดเส้นทางเอกสาร PDF

ในการเริ่มต้น เราต้องกำหนดว่าเอกสาร PDF ของคุณอยู่ที่ใด โดยใช้ตัวแปรสตริง คุณจะระบุเส้นทางไฟล์อินพุตได้ วิธีดำเนินการมีดังนี้:

```csharp
string dataDir = "YOUR DOCUMENTS DIRECTORY"; // แทนที่ด้วยไดเร็กทอรีเอกสารของคุณ
string input = dataDir + @"ExtractingImage.pdf"; // อินพุตไฟล์ PDF
```
 แทนที่`"YOUR DOCUMENTS DIRECTORY"` ด้วยเส้นทางไปยังโฟลเดอร์ที่เก็บไฟล์ PDF ของคุณ ซึ่งเป็นสิ่งสำคัญ เพราะเราต้องการให้โปรแกรมทราบว่าจะค้นหาไฟล์ PDF ของคุณได้ที่ใด

## ขั้นตอนที่ 2: โหลดเอกสาร PDF

ขั้นตอนต่อไปคือเราต้องโหลดเอกสาร PDF ของคุณเข้าในโปรแกรม โดยเราจะใช้คลาส Document จาก Aspose.Pdf

```csharp
using (Document pdfDocument = new Document(input))
{
    // วิธีนี้จะช่วยให้แน่ใจว่า PDF จะปิดอย่างถูกต้องเมื่อเราทำงานเสร็จ
}
```
 การ`using` คำสั่งนี้จะช่วยให้แน่ใจว่าเอกสาร PDF จะถูกกำจัดอย่างถูกต้องเมื่อเราทำงานกับเอกสารนั้นเสร็จสิ้น โดยป้องกันการรั่วไหลของหน่วยความจำ

## ขั้นตอนที่ 3: ทำซ้ำผ่านฟิลด์ลายเซ็น

ขณะนี้ เราจะวนซ้ำผ่านฟิลด์ทั้งหมดในเอกสาร PDF โดยมองหาฟิลด์ลายเซ็นโดยเฉพาะ (เนื่องจากโดยทั่วไปรูปภาพจะถูกฝังไว้ที่นี่)

```csharp
foreach (Field field in pdfDocument.Form)
{
    SignatureField sf = field as SignatureField;
    if (sf != null)
    {
        // หากฟิลด์เป็นลายเซ็น เราสามารถดึงภาพออกมาได้
    }
}
```
 ที่นี่เราใช้`foreach` ลูปเพื่อตรวจสอบแต่ละฟิลด์ในฟอร์ม PDF หากเราพบฟิลด์ลายเซ็น เราจะดำเนินการแยกรูปภาพได้

## ขั้นตอนที่ 4: ดึงภาพออกมา

นี่คือส่วนที่น่าตื่นเต้น—การแยกภาพออกมา! หากฟิลด์ลายเซ็นไม่ใช่ค่าว่าง เราสามารถแยกภาพออกมาได้โดยใช้โค้ดต่อไปนี้:

```csharp
string outFile = dataDir + @"output_out.jpg"; // เส้นทางสำหรับการแยกภาพ
using (Stream imageStream = sf.ExtractImage())
{
    if (imageStream != null)
    {
        using (System.Drawing.Image image = Bitmap.FromStream(imageStream))
        {
            image.Save(outFile, System.Drawing.Imaging.ImageFormat.Jpeg);
        }
    }
}
```

- เราจะกำหนดเส้นทางไฟล์เอาท์พุตที่จะบันทึกรูปภาพที่แยกออกมา
-  เราใช้`sf.ExtractImage()` เพื่อดึงสตรีมภาพจากฟิลด์ลายเซ็น
-  เราตรวจสอบว่า`imageStream` ไม่ใช่ค่าว่างเพื่อให้แน่ใจว่ามีรูปภาพที่จะดึงออกมาจริงๆ
- ในที่สุด เราจะแปลงสตรีมเป็นบิตแมปและบันทึกเป็นไฟล์ JPEG

## บทสรุป

การแยกภาพจากไฟล์ PDF โดยใช้ Aspose.PDF สำหรับ .NET เป็นกระบวนการที่ตรงไปตรงมาเมื่อคุณทราบขั้นตอนต่างๆ ด้วยโค้ดเพียงไม่กี่บรรทัด คุณสามารถเข้าถึงข้อมูลสำคัญที่ซ่อนอยู่ในเอกสารของคุณได้ ไม่ว่าคุณจะต้องการภาพถ่ายที่น่าประทับใจหรือภาพกราฟิกที่สำคัญจากรายงาน เครื่องมือนี้มีประโยชน์อย่างยิ่ง สนุกกับการเขียนโค้ด และขอให้ไฟล์ PDF ของคุณเต็มไปด้วยรูปภาพตลอดไป!

## คำถามที่พบบ่อย

### ฉันสามารถดึงรูปภาพจากไฟล์ PDF ใดๆ โดยใช้ Aspose.PDF ได้หรือไม่?  
ใช่ คุณสามารถแยกภาพจากไฟล์ PDF ใดๆ ได้ โดยที่ไฟล์ PDF จะต้องมีรูปภาพฝังอยู่หรือช่องลายเซ็นด้วย

### ฉันต้องมีใบอนุญาตแบบชำระเงินเพื่อใช้ Aspose.PDF หรือไม่  
คุณสามารถใช้รุ่นทดลองใช้งานฟรีเพื่อทดสอบได้ แต่หากใช้ในระยะยาวหรือในเชิงพาณิชย์ จะต้องมีใบอนุญาตแบบชำระเงิน

### สามารถดึงรูปภาพหลายภาพออกมาในครั้งเดียวได้หรือไม่?  
ใช่ คุณสามารถปรับเปลี่ยนโค้ดเพื่อวนซ้ำผ่านฟิลด์ต่างๆ และดึงภาพทั้งหมดออกมาได้

### ฉันสามารถบันทึกรูปภาพที่แยกออกมาเป็นรูปแบบภาพใดได้บ้าง  
คุณสามารถบันทึกรูปภาพที่แยกออกมาได้ในรูปแบบต่างๆ รวมถึง JPEG, PNG, BMP และอื่นๆ ขึ้นอยู่กับข้อกำหนดของคุณ

### ฉันสามารถหาแหล่งข้อมูลเพิ่มเติมสำหรับ Aspose.PDF ได้จากที่ใด  
 คุณสามารถตรวจสอบได้[เอกสาร Aspose.PDF](https://reference.aspose.com/pdf/net/) สำหรับทรัพยากรและตัวอย่างเพิ่มเติม