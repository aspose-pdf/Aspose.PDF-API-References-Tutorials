---
title: Добавить оглавление в PDF-файл
linktitle: Добавить оглавление в PDF-файл
second_title: Справочник по API Aspose.PDF для .NET
description: Узнайте, как добавить оглавление в PDF с помощью Aspose.PDF для .NET. Это пошаговое руководство упрощает процесс и обеспечивает легкую навигацию по вашим документам.
type: docs
weight: 40
url: /ru/net/programming-with-document/addtoc/
---
## Введение

Вы когда-нибудь бесконечно прокручивали длинный PDF-файл, желая, чтобы в нем было хорошо организованное оглавление? Что ж, сегодня ваш счастливый день! В этом уроке вы узнаете, как добавить оглавление в ваш PDF-файл с помощью Aspose.PDF для .NET. Работаете ли вы над сложным отчетом, электронной книгой или деловым предложением, оглавление может превратить ваш документ в профессиональный, удобный для навигации шедевр.

## Предпосылки

Прежде чем перейти к коду, давайте убедимся, что у вас есть все необходимое:

1. Aspose.PDF для .NET: Убедитесь, что вы загрузили и установили библиотеку Aspose.PDF. Вы можете загрузить ее с[здесь](https://releases.aspose.com/pdf/net/).
   
2. Среда разработки: убедитесь, что на вашем компьютере установлена среда разработки .NET, например Visual Studio.

3.  Лицензия: Если у вас нет лицензии, вы можете получить бесплатную пробную версию или запросить временную лицензию.[здесь](https://purchase.aspose.com/temporary-license/).

## Импортные пакеты

Для начала убедитесь, что вы импортировали необходимые пространства имен в начале вашего файла кода. Вот как это сделать:

```csharp
using System.IO;
using System;
using Aspose.Pdf;
using Aspose.Pdf.Text;
```

Эти пространства имен позволяют вам получать доступ к функциям, специфичным для PDF, и управлять текстовыми элементами в вашем документе.

Давайте разобьем эту задачу на небольшие шаги. Каждый шаг проведет вас через процесс создания и вставки TOC в ваш PDF-документ.

## Шаг 1: Загрузите PDF-документ

Первое, что нам нужно сделать, это загрузить существующий PDF-файл, в который мы хотим добавить оглавление.

```csharp
string dataDir = "YOUR DOCUMENT DIRECTORY";
Document doc = new Document(dataDir + "AddTOC.pdf");
```

 На этом этапе мы указываем путь к каталогу документов и загружаем PDF-файл с помощью`Document` объект. Обязательно замените`"YOUR DOCUMENT DIRECTORY"` с фактическим путем к вашему файлу.

## Шаг 2: Вставьте новую страницу для оглавления

Далее мы вставляем новую страницу в начало документа PDF. На этой странице будет размещено оглавление.

```csharp
Page tocPage = doc.Pages.Insert(1);
```

Вставляя страницу оглавления в начало, мы гарантируем, что читатели увидят ее в первую очередь в PDF-файле.

## Шаг 3: Создайте информационный объект TOC

Теперь давайте создадим объект, который будет представлять информацию TOC. Мы также добавим заголовок к TOC, чтобы выделить его.

```csharp
TocInfo tocInfo = new TocInfo();
TextFragment title = new TextFragment("Table Of Contents");
title.TextState.FontSize = 20;
title.TextState.FontStyle = FontStyles.Bold;
tocInfo.Title = title;
tocPage.TocInfo = tocInfo;
```

Здесь мы задали заголовок оглавления как «Оглавление», увеличили размер шрифта и сделали его жирным для акцента.

## Шаг 4: Определите элементы TOC

На этом этапе мы определяем элементы (или заголовки), которые будут отображаться в TOC. Эти элементы помогут читателям перейти к определенным разделам документа.

```csharp
string[] titles = new string[4];
titles[0] = "First page";
titles[1] = "Second page";
titles[2] = "Third page";
titles[3] = "Fourth page";
```

Мы создали массив строк, которые будут служить элементами оглавления, соответствующими различным страницам в PDF-файле.

## Шаг 5: Создание заголовков оглавления

Теперь наступает самая важная часть — добавление заголовков в оглавление и привязка их к соответствующим страницам.

```csharp
for (int i = 0; i < 2; i++)
{
    Aspose.Pdf.Heading heading2 = new Aspose.Pdf.Heading(1);
    TextSegment segment2 = new TextSegment();
    heading2.TocPage = tocPage;
    heading2.Segments.Add(segment2);

    heading2.DestinationPage = doc.Pages[i + 2];
    heading2.Top = doc.Pages[i + 2].Rect.Height;
    segment2.Text = titles[i];

    tocPage.Paragraphs.Add(heading2);
}
```

Вот что происходит:
- Заголовок: Мы создаем`Heading` объект и добавьте`TextSegment` к этому.
- Страница назначения: мы задаем страницу, на которую будет ссылаться каждый заголовок.
- Верхняя позиция: мы указываем позицию на странице, на которую будет указывать заголовок.
- Текст: Каждый заголовок получает соответствующее название из массива, который мы создали ранее.

Этот цикл создает заголовки для первых двух элементов в оглавлении и связывает их с соответствующими страницами.

## Шаг 6: Сохраните PDF-файл с оглавлением

Наконец, после добавления всех элементов оглавления пришло время сохранить обновленный PDF-файл.

```csharp
dataDir = dataDir + "TOC_out.pdf";
doc.Save(dataDir);
```

Файл теперь сохранен с оглавлением, добавленным в PDF. Поздравляем — вы успешно добавили оглавление!

## Шаг 7: Подтверждающее сообщение

Чтобы сообщить пользователю о завершении процесса, мы выведем на консоль простое сообщение.

```csharp
Console.WriteLine("\nTOC added successfully to an existing PDF.\nFile saved at " + dataDir);
```

## Заключение

И вот оно! С Aspose.PDF для .NET добавление оглавления в PDF не только простое, но и настраиваемое. Если вам нужно создать простые навигационные ссылки или сложные структуры, этот инструмент вам поможет. Так что в следующий раз, когда вы будете работать с длинным PDF, не забудьте добавить TOC для профессионального штриха!

## Часто задаваемые вопросы

### Могу ли я настроить внешний вид оглавления в Aspose.PDF?  
Да, вы можете полностью настроить внешний вид оглавления, включая стиль шрифта, размер и выравнивание.

### Как добавить подзаголовки в оглавление?  
 Вы можете добавлять подзаголовки, настраивая`Heading` уровень (например,`Heading(2)`) для создания иерархического оглавления.

### Возможно ли автоматически обновлять оглавление при изменении документа?  
Нет, TOC не обновится автоматически. Вам придется создать его заново, если структура документа изменится.

### Могу ли я связать записи TOC с внешними документами?  
Да, вы можете использовать гиперссылки для привязки записей оглавления к внешним PDF-файлам или URL-адресам.

### Поддерживает ли Aspose.PDF многоуровневые оглавления?  
Да, Aspose.PDF поддерживает многоуровневые оглавления для сложных документов с подразделами.