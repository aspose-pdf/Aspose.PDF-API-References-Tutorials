---
title: Установить дату истечения срока действия в PDF-файле
linktitle: Установить дату истечения срока действия в PDF-файле
second_title: Справочник по API Aspose.PDF для .NET
description: Узнайте, как установить дату истечения срока действия в PDF-файле с помощью Aspose.PDF для .NET, следуя этому пошаговому руководству.
type: docs
weight: 300
url: /ru/net/programming-with-document/setexpirydate/
---
Aspose.PDF для .NET — это мощная библиотека, которая предоставляет различные функции для работы с PDF-файлами. Одной из таких функций является возможность установки даты истечения срока действия для PDF-документа. В этом руководстве мы проведем вас через процесс установки даты истечения срока действия для PDF-документа с помощью Aspose.PDF для .NET. 

## Шаг 1: Укажите путь к каталогу документов.

Прежде чем начать, нам нужно задать путь к каталогу, где находится наш PDF-документ. Мы сохраним этот путь в переменной с именем "dataDir".

```csharp
string dataDir = "YOUR DOCUMENT DIRECTORY";
```

## Шаг 2: Создание нового PDF-документа

 Чтобы создать новый PDF-документ, нам нужно создать новый экземпляр`Aspose.Pdf.Document` объект. Мы можем сделать это с помощью следующего кода:

```csharp
Aspose.Pdf.Document doc = new Aspose.Pdf.Document();
```

## Шаг 3: Добавление новой страницы в PDF-документ

После того, как мы создали PDF-документ, мы можем добавить в него новую страницу. Мы можем сделать это с помощью следующего кода:

```csharp
doc.Pages.Add();
```

## Шаг 4: Добавление текста в PDF-документ

 После добавления страницы в PDF-документ мы можем добавить к ней текст с помощью`Paragraphs` коллекция. Мы можем сделать это с помощью следующего кода:

```csharp
doc.Pages[1].Paragraphs.Add(new TextFragment("Hello World..."));
```

## Шаг 5: Установка даты истечения срока действия PDF-файла с помощью JavaScript

Чтобы установить дату истечения срока действия PDF, нам нужно создать объект JavaScript. Мы можем сделать это с помощью следующего кода:

```csharp
JavascriptAction javaScript = new JavascriptAction(
"var year=2017;"
+ "var month=5;"
+ "today = new Date(); today = new Date(today.getFullYear(), today.getMonth());"
+ "expiry = new Date(year, month);"
+ "if (today.getTime() > expiry.getTime())"
+ "app.alert('The file is expired. You need a new one.');");

// Установить JavaScript как действие открытия PDF
doc.OpenAction = javaScript;
```

В этом коде мы устанавливаем дату истечения срока действия на май 2017 года.

## Шаг 6: Сохраните PDF-файл.

 После того, как вы установили дату истечения срока действия, вам необходимо сохранить файл PDF. Для этого вы можете использовать`Save` Метод`Document` объект и укажите путь к месту, где вы хотите сохранить обновленный PDF-файл.

```csharp
dataDir = dataDir + "SetExpiryDate_out.pdf";
// Сохранить PDF-документ
doc.Save(dataDir);
```

### Пример исходного кода для установки даты истечения срока действия с помощью Aspose.PDF для .NET

Вот полный пример исходного кода для установки даты истечения срока с помощью Aspose.PDF для .NET:

```csharp
// Путь к каталогу документов.
string dataDir = "YOUR DOCUMENT DIRECTORY";

// Создать экземпляр объекта Document
Aspose.Pdf.Document doc = new Aspose.Pdf.Document();
// Добавить страницу в коллекцию страниц PDF-файла
doc.Pages.Add();
// Добавить фрагмент текста в коллекцию абзацев объекта страницы
doc.Pages[1].Paragraphs.Add(new TextFragment("Hello World..."));
// Создать объект JavaScript для установки даты истечения срока действия PDF-файла
JavascriptAction javaScript = new JavascriptAction(
"var year=2017;"
+ "var month=5;"
+ "today = new Date(); today = new Date(today.getFullYear(), today.getMonth());"
+ "expiry = new Date(year, month);"
+ "if (today.getTime() > expiry.getTime())"
+ "app.alert('The file is expired. You need a new one.');");
// Установить JavaScript как действие открытия PDF
doc.OpenAction = javaScript;

dataDir = dataDir + "SetExpiryDate_out.pdf";
// Сохранить PDF-документ
doc.Save(dataDir);
```

## Заключение

Установка даты истечения срока действия для документа PDF с помощью Aspose.PDF для .NET — полезная функция, гарантирующая, что документ будет действителен только в течение определенного периода. Следуя пошаговому руководству и используя предоставленный исходный код C#, разработчики могут легко устанавливать дату истечения срока действия и создавать PDF-файлы с ограниченным сроком действия. Эта функция может быть особенно полезна для документов, к которым необходимо получить доступ или которые необходимо распространять в течение ограниченного периода времени.

### Часто задаваемые вопросы по установке даты истечения срока действия в файле PDF

#### В: Могу ли я установить другую дату окончания срока действия PDF-документа?

 A: Да, вы можете установить другую дату окончания срока действия для документа PDF, изменив код JavaScript на шаге 5. В приведенном примере дата окончания срока действия установлена на май 2017 года. Чтобы установить другую дату окончания срока действия, вам необходимо изменить`year` и`month` переменные в коде JavaScript на желаемый год и месяц.

#### В: Что произойдет, если срок действия PDF-документа истечет?

A: Когда срок действия документа PDF истек, как указано в коде JavaScript, средство просмотра отобразит предупреждающее сообщение, указывающее, что срок действия файла истек и пользователю нужен новый. Это предупреждающее сообщение будет показано при открытии PDF.

#### В: Могу ли я указать конкретное время в качестве даты истечения срока действия, а не только дату?

 A: Да, вы можете установить определенное время для даты истечения срока в коде JavaScript. Изменяя`expiry` Используя переменную в коде JavaScript для включения желаемого времени, вы можете задать конкретное время для даты истечения срока действия.