---
title: Извлечение шрифтов и оптимизация PDF-файлов
linktitle: Извлечение шрифтов и оптимизация PDF-файлов
second_title: Справочник по API Aspose.PDF для .NET
description: Узнайте, как извлекать шрифты и оптимизировать PDF-файлы с помощью Aspose.PDF для .NET в этом пошаговом руководстве.
type: docs
weight: 370
url: /ru/net/programming-with-document/unembedfonts/
---
## Введение

В цифровую эпоху PDF-файлы распространены повсеместно. Независимо от того, делитесь ли вы отчетами, презентациями или электронными книгами, формат Portable Document Format (PDF) является оптимальным выбором для сохранения целостности ваших документов. Однако по мере того, как мы создаем и делимся большим количеством PDF-файлов, размеры файлов могут увеличиваться, что делает их громоздкими для отправки или хранения. Вот где в игру вступает Aspose.PDF для .NET, предлагающий мощные инструменты для оптимизации ваших PDF-файлов. В этом руководстве мы рассмотрим, как извлекать шрифты и оптимизировать PDF-файлы с помощью Aspose.PDF для .NET.

## Предпосылки

Прежде чем перейти к деталям, давайте убедимся, что у вас есть все необходимое для начала работы:

1. Visual Studio: Убедитесь, что на вашем компьютере установлена Visual Studio. Это IDE, которую мы будем использовать для написания и запуска нашего кода .NET.
2.  Aspose.PDF для .NET: Вам нужно будет скачать и установить библиотеку Aspose.PDF. Вы можете взять ее с[ссылка для скачивания](https://releases.aspose.com/pdf/net/).
3. Базовые знания C#: знакомство с программированием на C# поможет вам понять фрагменты кода, которые мы будем использовать.
4.  Файл PDF: Имейте готовый файл PDF, который вы хотите оптимизировать. Вы можете использовать любой PDF, но для демонстрации мы будем называть его`OptimizeDocument.pdf`.

## Импортные пакеты

Для начала вам нужно импортировать необходимые пакеты в ваш проект C#. Вот как это можно сделать:

1. Откройте свой проект в Visual Studio.
2. Добавьте ссылку на Aspose.PDF: щелкните правой кнопкой мыши свой проект в обозревателе решений, выберите «Управление пакетами NuGet» и найдите`Aspose.PDF`. Установите пакет.

```csharp
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
```

Теперь, когда у нас все готово, давайте разобьем процесс оптимизации на управляемые этапы.

## Шаг 1: Настройте каталог документов

Прежде всего, вам нужно определить путь к каталогу ваших документов. Это то место, где будут храниться ваши файлы PDF. Вот как это сделать:

```csharp
// Путь к каталогу документов.
string dataDir = "YOUR DOCUMENT DIRECTORY";
```

 Заменять`"YOUR DOCUMENT DIRECTORY"` с фактическим путем, где находится ваш PDF-файл. Это важно, поскольку программе необходимо знать, где найти PDF-файл, который вы хотите оптимизировать.

## Шаг 2: Откройте PDF-документ.

Теперь, когда у нас настроен каталог, пришло время открыть PDF-документ, который мы хотим оптимизировать. Вот код для этого:

```csharp
// Открыть документ
Document pdfDocument = new Document(dataDir + "OptimizeDocument.pdf");
```

 Эта строка кода создает новый`Document` объект, который представляет ваш PDF-файл. Убедитесь, что имя файла совпадает с тем, что у вас в каталоге.

## Шаг 3: Установите параметры оптимизации

Далее нам нужно указать параметры оптимизации. В этом случае мы хотим отключить встроенные шрифты. Вот как это настроить:

```csharp
// Установить опцию UnembedFonts
var optimizeOptions = new Pdf.Optimization.OptimizationOptions
{
    UnembedFonts = true
};
```

 Установив`UnembedFonts` к`true`, мы инструктируем Aspose.PDF оптимизировать PDF, отключив встроенные шрифты. Это может значительно уменьшить размер файла, особенно если PDF содержит много встроенных шрифтов.

## Шаг 4: Оптимизируйте PDF-документ

После того, как наши параметры установлены, пришло время оптимизировать PDF-документ. Вот код для этого:

```csharp
Console.WriteLine("Start");
// Оптимизируйте PDF-документ с помощью OptimizationOptions
pdfDocument.OptimizeResources(optimizeOptions);
```

Этот фрагмент кода вызывает`OptimizeResources` метод на`pdfDocument` объект, применяя параметры оптимизации, которые мы определили ранее. Вы увидите сообщение в консоли, указывающее на то, что процесс оптимизации начался.

## Шаг 5: Сохраните обновленный документ.

После оптимизации PDF нам нужно сохранить обновленный документ. Вот как это сделать:

```csharp
// Сохранить обновленный документ
pdfDocument.Save(dataDir + "OptimizeDocument_out.pdf");
Console.WriteLine("Finished");
```

 Этот код сохраняет оптимизированный PDF-файл как`OptimizeDocument_out.pdf` в том же каталоге. Вы можете выбрать другое имя, если предпочитаете, но сохранение схожести помогает идентифицировать исходную и оптимизированную версии.

## Шаг 6: Сравните размеры файлов

Наконец, всегда полезно проверить, сколько места вы сэкономили. Вот как сравнить исходный и оптимизированный размеры файлов:

```csharp
var fi1 = new System.IO.FileInfo(dataDir + "OptimizeDocument.pdf");
var fi2 = new System.IO.FileInfo(dataDir + "OptimizeDocument_out.pdf");
Console.WriteLine("Original file size: {0}. Reduced file size: {1}", fi1.Length, fi2.Length);
```

Этот код извлекает размеры файлов как исходного, так и оптимизированного PDF-файлов и выводит их на консоль. Это приятный момент, чтобы увидеть, насколько вы уменьшили размер файла!

## Заключение

И вот оно! Вы успешно удалили шрифты и оптимизировали файл PDF с помощью Aspose.PDF для .NET. Этот процесс не только помогает уменьшить размер файла, но и повышает производительность ваших документов PDF. Независимо от того, делитесь ли вы файлами по электронной почте или храните их в облаке, меньший размер файла может иметь огромное значение.

## Часто задаваемые вопросы

### Что такое Aspose.PDF для .NET?
Aspose.PDF для .NET — это мощная библиотека, которая позволяет разработчикам создавать, изменять и оптимизировать PDF-документы программными средствами.

### Могу ли я использовать Aspose.PDF бесплатно?
 Да, Aspose предлагает бесплатную пробную версию. Вы можете загрузить ее с[здесь](https://releases.aspose.com/).

### Как получить поддержку по Aspose.PDF?
 Вы можете получить поддержку через[Форум Aspose](https://forum.aspose.com/c/pdf/10).

### Какие типы оптимизации я могу применять к PDF-файлам?
Вы можете извлекать шрифты, сжимать изображения, удалять неиспользуемые объекты и выполнять другие действия для оптимизации ваших PDF-файлов.

### Где можно купить Aspose.PDF для .NET?
 Вы можете приобрести лицензию у[Страница покупки Aspose](https://purchase.aspose.com/buy).