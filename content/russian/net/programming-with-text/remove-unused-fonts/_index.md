---
title: Удалить неиспользуемые шрифты в PDF-файле
linktitle: Удалить неиспользуемые шрифты в PDF-файле
second_title: Справочник по API Aspose.PDF для .NET
description: Узнайте, как легко удалить неиспользуемые шрифты из файлов PDF с помощью Aspose.PDF для .NET. Улучшите производительность и уменьшите размер файла.
type: docs
weight: 300
url: /ru/net/programming-with-text/remove-unused-fonts/
---
## Введение

Привет! Вам надоели раздутые файлы PDF, заполненные шрифтами, которые просто занимают лишнее место? Вы не одиноки! Управление использованием шрифтов в файлах PDF может быть хлопотным, особенно если вы хотите, чтобы ваши документы были чистыми и эффективными. Хорошая новость заключается в том, что с помощью Aspose.PDF для .NET вы можете легко удалить неиспользуемые шрифты из файлов PDF, повысив производительность и уменьшив размер файла. В этом руководстве мы шаг за шагом рассмотрим этот процесс, чтобы вы могли оптимизировать управление файлами PDF.

## Предпосылки

Прежде чем начать, убедитесь, что у вас есть следующее, чтобы извлечь максимальную пользу из этого урока:

1. Установленная Visual Studio: Вам понадобится среда разработки для запуска вашего кода .NET. Visual Studio (любая версия) — отличный выбор.
2.  Aspose.PDF для .NET: Убедитесь, что у вас установлена эта библиотека. Вы можете скачать ее[здесь](https://releases.aspose.com/pdf/net/).
3. Базовое понимание C#: поскольку в этом примере мы будем использовать C#, знакомство с этим языком будет полезным.
4. Файл PDF: Имейте готовый образец файла PDF. Вы можете создать свой собственный или использовать любой существующий PDF. Просто убедитесь, что он назван`ReplaceTextPage.pdf` и сохраняется в каталоге ваших документов.
5.  Действительная лицензия: Хотя вы можете использовать бесплатную пробную версию, для полной функциональности рекомендуется действующая лицензия. Если вам нужна временная лицензия, вы можете получить ее[здесь](https://purchase.aspose.com/temporary-license/).

## Импортные пакеты

Теперь, когда у нас есть все необходимые условия, давайте импортируем необходимые пакеты в наш проект C#. Вот что вам понадобится:

Пространство имен Aspose.PDF: предоставляет все основные функции для обработки PDF-файлов.

```csharp
using System.IO;
using Aspose.Pdf;
using Aspose.Pdf.Text;
using System;
```

Чтобы импортировать их, добавьте приведенные выше строки в начало вашего файла C#. Это предоставит вам доступ к классам и методам, которые мы будем использовать для управления вашими документами PDF.

## Шаг 1: Настройте среду вашего проекта

Сначала самое главное! Вам нужно создать новое консольное приложение в Visual Studio. Выполните следующие шаги:

- Откройте Visual Studio.
- Нажмите Файл > Новый > Проект.
-  Выберите Консольное приложение (.NET Framework) и дайте ему имя (например,`PdfFontCleaner`).
- Нажмите «Создать».

Теперь у вас есть новый проект для работы!

## Шаг 2: Добавьте библиотеку Aspose.PDF

Далее вы добавите библиотеку Aspose.PDF в свой проект. Вы можете сделать это через NuGet:

1. В обозревателе решений щелкните правой кнопкой мыши свой проект.
2. Выберите «Управление пакетами NuGet».
3.  Искать`Aspose.PDF` и установите его.

## Шаг 3: Загрузите PDF-документ

Давайте загрузим документ, который вы хотите обработать. Вот как это сделать:

```csharp
// Путь к каталогу документов.
string dataDir = "YOUR DOCUMENT DIRECTORY/"; // Обновите это до вашего пути
// Загрузить исходный PDF-файл
Document doc = new Document(dataDir + "ReplaceTextPage.pdf");
```

 Заменять`"YOUR DOCUMENT DIRECTORY/"` с фактическим путем, где хранится ваш PDF-файл. Этот шаг имеет решающее значение, поскольку он позволяет Aspose получить доступ к вашему PDF-документу. 

## Шаг 4: Настройка поглотителя фрагментов текста

Далее мы настроим процессор, который поможет нам определить и удалить неиспользуемые шрифты из PDF. Вот код для этого:

```csharp
TextFragmentAbsorber absorber = new TextFragmentAbsorber(new TextEditOptions(TextEditOptions.FontReplace.RemoveUnusedFonts));
doc.Pages.Accept(absorber);
```

 Эта строка кода создает`TextFragmentAbsorber` объект настроен на удаление неиспользуемых шрифтов. Вызывая`doc.Pages.Accept(absorber)`, мы говорим Aspose просмотреть все страницы документа и идентифицировать фрагменты текста.

## Шаг 5: Перебор фрагментов текста и замена шрифтов

После определения фрагментов текста, пришло время пройтись по ним и заменить неиспользуемые шрифты. Добавьте этот код:

```csharp
//Перебрать все фрагменты текста
foreach (TextFragment textFragment in absorber.TextFragments)
{
    textFragment.TextState.Font = FontRepository.FindFont("Arial, Bold");
}
```

 В этом цикле вы измените шрифт каждого`TextFragment` на "Arial, Bold". Вы можете выбрать любой шрифт, который соответствует вашим потребностям. Вот где происходит настоящее волшебство, поскольку это гарантирует, что PDF останется с чистым, четко определенным шрифтом.

## Шаг 6: Сохраните обновленный документ.

Теперь, когда мы внесли необходимые изменения, давайте сохраним обновленный PDF! Добавьте следующий код:

```csharp
dataDir = dataDir + "RemoveUnusedFonts_out.pdf";
// Сохранить обновленный документ
doc.Save(dataDir);
Console.WriteLine("\nUnused fonts removed successfully from pdf document.\nFile saved at " + dataDir);
```

 Здесь мы создаем новый файл с именем`RemoveUnusedFonts_out.pdf` в том же каталоге. Это дает вам резервную копию вашего оригинального PDF, при этом предоставляя вам оптимизированную версию.

## Шаг 7: Обработка исключений

Наконец, всегда полезно встраивать обработку ошибок. Вот простой блок try-catch для обертывания вашего кода:

```csharp
try
{
    // ... (предыдущий код)
}
catch (Exception ex)
{
    Console.WriteLine(ex.Message + "\nThis example will only work if you apply a valid Aspose License. You can purchase full license or get 30-day temporary license from https://purchase.aspose.com.");
}
```

Это позволит перехватывать любые исключения, возникающие во время процесса, и предоставлять понятные пользователю сообщения об ошибках. Важно информировать пользователей о требованиях, например, о необходимости действительной лицензии Aspose.

## Заключение

Поздравляем! Вы успешно научились удалять неиспользуемые шрифты из PDF-файла с помощью Aspose.PDF для .NET. Выполнив шаги, описанные выше, вы можете сделать свои PDF-файлы более компактными и аккуратными, гарантируя, что они будут более эффективными и удобными для пользователя. Не забудьте изучить другие функции Aspose.PDF, чтобы еще больше улучшить свои возможности по обработке документов!

## Часто задаваемые вопросы

### Могу ли я использовать бесплатную версию Aspose.PDF для этой задачи?
Да, вы можете использовать бесплатную пробную версию, но для оптимальной производительности рекомендуется приобрести полную лицензию.

### Что произойдет со шрифтами, если не будет доступных замен?
Если заменяющий шрифт не найден, текст может отображаться некорректно, поэтому обязательно выберите общедоступный шрифт.

### Как получить временную лицензию?
 Вы можете запросить временную лицензию у[здесь](https://purchase.aspose.com/temporary-license/).

### Повлияет ли удаление неиспользуемых шрифтов на внешний вид документа?
Это может произойти, в зависимости от того, какие шрифты будут удалены и как будут заменены фрагменты текста; тестирование приветствуется.

### Есть ли альтернативный метод удаления неиспользуемых шрифтов?
Aspose.PDF для .NET весьма эффективен для этой цели, хотя другие библиотеки или инструменты могут предлагать схожие функции.