---
title: Установить свойство выноски в файле PDF
linktitle: Установить свойство выноски в файле PDF
second_title: Справочник по API Aspose.PDF для .NET
description: Узнайте, как задать свойство выноски в PDF-файле с помощью Aspose.PDF для .NET в этом подробном пошаговом руководстве.
type: docs
weight: 130
url: /ru/net/annotations/setcalloutproperty/
---
## Введение

Создание профессиональных и визуально привлекательных документов PDF часто требует добавления аннотаций, которые привлекают внимание к определенному контенту. Одной из таких аннотаций является выноска, которая похожа на те речевые пузыри, которые вы видите в комиксах. Они помогают прояснить или подчеркнуть текст в вашем PDF. Aspose.PDF для .NET невероятно упрощает добавление таких аннотаций в ваши документы, и в этом руководстве мы рассмотрим, как задать свойство выноски в файле PDF с помощью этой мощной библиотеки. Независимо от того, являетесь ли вы опытным разработчиком или только начинаете, к концу этого руководства вы будете иметь четкое представление о том, как работать с выносками в файлах PDF.

## Предпосылки

Прежде чем углубиться в код, давайте рассмотрим основные моменты, необходимые для начала работы.

1.  Aspose.PDF for .NET: Убедитесь, что у вас установлена библиотека Aspose.PDF for .NET. Вы можете загрузить ее с[здесь](https://releases.aspose.com/pdf/net/).
2. IDE: среда разработки, такая как Visual Studio.
3. .NET Framework: Убедитесь, что на вашем компьютере установлен .NET.
4. Временная лицензия: если вы хотите опробовать все функции Aspose.PDF без ограничений, приобретите[временная лицензия](https://purchase.aspose.com/temporary-license/).

## Импортные пакеты

Прежде чем приступить к написанию кода, вам необходимо импортировать необходимые пакеты, которые позволят вам работать с PDF-файлами и аннотациями.

```csharp
using Aspose.Pdf.Annotations;
using System;
using System.Collections.Generic;
using System.IO;
using System.Linq;
using System.Text;
```

Эти импорты предоставят вам все необходимые классы и методы для работы с PDF-документами и создания аннотаций, таких как выноски.

## Шаг 1: Инициализация PDF-документа

Первый шаг в нашем путешествии — инициализация нового документа PDF, в который мы добавим нашу аннотацию выноски. Думайте об этом как о настройке чистого холста, на который вы можете начать добавлять элементы.

```csharp
// Путь к каталогу документов.
string dataDir = "YOUR DOCUMENT DIRECTORY";

// Инициализировать новый PDF-документ
Document doc = new Document();
```
 Здесь мы создаем новый`Document` объект, который будет служить нашим PDF-файлом.`dataDir` переменная указывает на каталог, в котором вы хотите сохранить файл PDF после того, как мы закончим.

## Шаг 2: Добавьте новую страницу в документ

Документ PDF может иметь несколько страниц, и на этом этапе мы добавим новую страницу в наш документ. На этой странице будет размещена наша выноска-аннотация.

```csharp
//Добавить новую страницу в документ
Page page = doc.Pages.Add();
```
 The`Pages.Add()`метод используется для добавления новой страницы в`doc` объект. Новая страница сохраняется в`page` переменная, которую мы будем использовать позже при добавлении аннотации.

## Шаг 3: Определите внешний вид по умолчанию

Аннотации, как и выноска, имеют визуальный вид, который вы можете настроить. На этом этапе мы определим, как должен выглядеть текст в выноске.

```csharp
// Определите внешний вид аннотации по умолчанию.
DefaultAppearance da = new DefaultAppearance();
da.TextColor = System.Drawing.Color.Red;
da.FontSize = 10;
```
 Мы создаем`DefaultAppearance` объект, который определяет цвет текста и размер шрифта. Здесь текст будет красным, а размер шрифта установлен на 10. Этот вид будет применен к аннотации выноски.

## Шаг 4: Создайте свободную текстовую аннотацию

Теперь пришло время создать фактическую аннотацию. Свободная текстовая аннотация — это то, что позволяет нам добавлять выноску с определенным текстом и стилем.

```csharp
// Создайте FreeTextAnnotation с выноской
FreeTextAnnotation fta = new FreeTextAnnotation(page, new Rectangle(422.25, 645.75, 583.5, 702.75), da);
fta.Intent = FreeTextIntent.FreeTextCallout;
fta.EndingStyle = LineEnding.OpenArrow;
```
 Мы создаем`FreeTextAnnotation` объект с определенными координатами, определяющими его положение на странице.`Intent` установлен на`FreeTextCallout` , что указывает на то, что это выноска.`EndingStyle` установлен на`OpenArrow`то есть линия выноски будет заканчиваться открытой стрелкой.

## Шаг 5: Определите точки линии выноски

Аннотация выноски имеет линию, которая указывает на область интереса. Здесь мы определим точки, которые составляют эту линию.

```csharp
// Определите точки для линии выноски
fta.Callout = new Point[]
{
    new Point(428.25, 651.75), 
    new Point(462.75, 681.375), 
    new Point(474, 681.375)
};
```
 The`Callout` свойство представляет собой массив`Point` объекты, каждый из которых представляет координату на странице. Эти точки определяют путь линии выноски, придавая ей классический вид речевого пузыря.

## Шаг 6: Добавьте аннотацию на страницу

После создания и настройки нашей аннотации следующим шагом будет ее добавление на страницу.

```csharp
// Добавить аннотацию на страницу
page.Annotations.Add(fta);
```
 The`Annotations.Add()` Метод используется для размещения аннотации на странице, которую мы создали ранее. Этот шаг эффективно «рисует» выноску на странице PDF.

## Шаг 7: Установите форматированный текстовый контент

Аннотации выноски могут включать в себя расширенный текст, что позволяет форматировать содержимое внутри пузыря. Давайте добавим пример текста.

```csharp
// Установите форматированный текст для аннотации
fta.RichText = "<body xmlns=\"http://www.w3.org/1999/xhtml\" xmlns:xfa=\"http://www.xfa.org/schema/xfa-data/1.0/\" xfa:APIVersion=\"Acrobat:11.0.23\" xfa:spec=\"2.0.2\" style=\"color:#FF0000;font-weight:normal;font-style:normal;font-stretch:normal\"><p dir=\"ltr\"><span style=\"font-size:9.0pt;font-family:Helvetica\">Это пример</span></p></body>";
```
 The`RichText` свойство задается с HTML-контентом. Это позволяет выполнять детальное форматирование в выноске, например, указывать размер шрифта, цвет и стиль.

## Шаг 8: Сохраните PDF-документ.

Наконец, после настройки всего, нам нужно сохранить документ. Этот шаг завершает создание PDF с аннотацией выноски.

```csharp
// Сохранить документ
doc.Save(dataDir + "SetCalloutProperty.pdf");
```
 The`Save()` Метод сохраняет документ в указанном каталоге с именем файла "SetCalloutProperty.pdf". Этот шаг завершает наш процесс создания PDF.

## Заключение

И вот оно! Вы только что создали PDF-документ с выносной аннотацией с помощью Aspose.PDF для .NET. Эта аннотация может быть невероятно полезна для выделения или объяснения определенных частей вашего документа. Aspose.PDF предлагает мощный API, который делает манипуляции с PDF простыми и гибкими. Добавляете ли вы аннотации, конвертируете документы или обрабатываете сложные задачи PDF, Aspose.PDF поможет вам.

## Часто задаваемые вопросы

### Могу ли я дополнительно настроить внешний вид выноски?

Конечно! Вы можете настроить различные аспекты, такие как цвет линии, толщину, а также шрифт и стиль текста.

### Можно ли добавить несколько выносок на одну страницу?

Да, вы можете добавить столько выносок, сколько необходимо, повторив шаги для каждой аннотации.

### Как изменить положение выноски?

 Просто измените координаты в`Rectangle` и`Callout` свойства для изменения положения аннотации.

### Могу ли я добавлять другие типы аннотаций с помощью Aspose.PDF?

Да, Aspose.PDF поддерживает различные типы аннотаций, включая выделение текста, штампы и вложения файлов.

### Ограничивается ли форматированный текстовый контент HTML?

 The`RichText` Свойство поддерживает подмножество HTML, позволяя включать стилизованный текст и базовое форматирование.