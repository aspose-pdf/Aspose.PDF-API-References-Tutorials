---
title: แปลงสตรีมรูปภาพเป็นไฟล์ PDF
linktitle: แปลงสตรีมรูปภาพเป็นไฟล์ PDF
second_title: Aspose.PDF สำหรับการอ้างอิง .NET API
description: แปลงสตรีมรูปภาพเป็นไฟล์ PDF ได้อย่างง่ายดายด้วย Aspose.PDF สำหรับ .NET
type: docs
weight: 70
url: /th/net/programming-with-images/convert-image-stream-to-pdf/
---
คู่มือนี้จะแนะนำคุณทีละขั้นตอนในการแปลงสตรีมรูปภาพเป็นไฟล์ PDF โดยใช้ Aspose.PDF สำหรับ .NET ตรวจสอบให้แน่ใจว่าคุณได้ตั้งค่าสภาพแวดล้อมของคุณแล้ว และทำตามขั้นตอนด้านล่าง:

## ขั้นตอนที่ 1: กำหนดไดเร็กทอรีเอกสาร

 ก่อนที่คุณจะเริ่มต้น ตรวจสอบให้แน่ใจว่าคุณได้ตั้งค่าไดเร็กทอรีที่ถูกต้องสำหรับเอกสาร แทนที่`"YOUR DOCUMENT DIRECTORY"` ในโค้ดพร้อมเส้นทางไปยังไดเร็กทอรีที่มีรูปภาพของคุณอยู่

```csharp
string dataDir = "YOUR DOCUMENT DIRECTORY";
```

## ขั้นตอนที่ 2: สร้างอินสแตนซ์วัตถุเอกสาร

 ในขั้นตอนนี้ เราจะยกตัวอย่าง a`Document` วัตถุโดยใช้ตัวสร้างที่ว่างเปล่าของ`Aspose.Pdf.Document` ระดับ.

```csharp
Aspose.Pdf.Document pdf1 = new Aspose.Pdf.Document();
```

## ขั้นตอนที่ 3: เพิ่มหน้าลงในเอกสาร PDF

 เพิ่มหน้าลงในเอกสาร PDF โดยใช้ไฟล์`Add` วิธีการของ`Pages` วัตถุของ`pdf1`.

```csharp
Aspose.Pdf.Page sec = pdf1.Pages.Add();
```

## ขั้นตอนที่ 4: อ่านสตรีมรูปภาพ

 ในขั้นตอนนี้เราจะสร้าง`FileStream` วัตถุเพื่ออ่านไฟล์รูปภาพจากสตรีม

```csharp
FileStream fs = File.OpenRead(dataDir + "aspose.jpg");
```

## ขั้นตอนที่ 5: อ่านรูปภาพลงในอาร์เรย์ไบต์

 อ่านรูปภาพจากสตรีมและจัดเก็บไว้ในอาร์เรย์ไบต์โดยใช้`Read` วิธีการของ`fs` วัตถุ.

```csharp
byte[] data = new byte[fs.Length];
fs.Read(data, 0, data.Length);
```

## ขั้นตอนที่ 6: สร้างออบเจ็กต์ MemoryStream จากอาร์เรย์ไบต์

 สร้างก`MemoryStream` วัตถุจากอาร์เรย์ไบต์ที่มีรูปภาพ

```csharp
MemoryStream ms = new MemoryStream(data);
```

## ขั้นตอนที่ 7: สร้างวัตถุรูปภาพ

 ในขั้นตอนนี้ เราจะสร้าง`Image` วัตถุโดยใช้`Aspose.Pdf.Image` ระดับ. ระบุกระแสของภาพโดยใช้`ImageStream` ทรัพย์สินและผ่าน`ms` วัตถุที่เราสร้างไว้ก่อนหน้านี้

```csharp
Aspose.Pdf.Image imageht = new Aspose.Pdf.Image();
imageht. ImageStream = ms;
```

## ขั้นตอนที่ 8: เพิ่มวัตถุรูปภาพไปยังคอลเลกชันย่อหน้า

 เพิ่ม`imageht` คัดค้านการ`Paragraphs` คอลเลกชันของ`sec` ส่วน.

```csharp
sec.Paragraphs.Add(imageht);
```

## ขั้นตอนที่ 9: บันทึกเอกสาร PDF

 บันทึกเอกสาร PDF โดยใช้ไฟล์`Save` วิธีการของ`pdf1` วัตถุ. ระบุเส้นทางเอาต์พุตของไฟล์ PDF

```csharp
pdf1.Save(dataDir + "ConvertMemoryStreamImageToPdf_out.pdf");
```

## ขั้นตอนที่ 10: ปิดวัตถุ MemoryStream

 ปิด`ms` วัตถุโดยใช้`Close` วิธีการปลดปล่อยทรัพยากร

```csharp
ms. Close();
```

### ตัวอย่างซอร์สโค้ดสำหรับการแปลง Image Stream เป็น PDF โดยใช้ Aspose.PDF สำหรับ .NET 
```csharp
// เส้นทางไปยังไดเร็กทอรีเอกสาร
string dataDir = "YOUR DOCUMENT DIRECTORY";
//สร้างอินสแตนซ์ของเอกสารโดยการเรียกตัวสร้างที่ว่างเปล่า
Aspose.Pdf.Document pdf1 = new Aspose.Pdf.Document();
// เพิ่มหน้าลงในเอกสาร pdf
Aspose.Pdf.Page sec = pdf1.Pages.Add();
// สร้างวัตถุ FileStream เพื่ออ่านไฟล์ Imag
FileStream fs = File.OpenRead(dataDir + "aspose.jpg");
// อ่านภาพลงในอาร์เรย์ไบต์
byte[] data = new byte[fs.Length];
fs.Read(data, 0, data.Length);
// สร้างวัตถุ MemoryStream จากอาร์เรย์ไบต์ของรูปภาพ
MemoryStream ms = new MemoryStream(data);
// สร้างวัตถุรูปภาพ
Aspose.Pdf.Image imageht = new Aspose.Pdf.Image();
// ระบุแหล่งที่มาของรูปภาพเป็น MemoryStream
imageht.ImageStream = ms;
// เพิ่มวัตถุรูปภาพลงในคอลเลกชันย่อหน้าของส่วน
sec.Paragraphs.Add(imageht);
// บันทึก PDF
pdf1.Save(dataDir + "ConvertMemoryStreamImageToPdf_out.pdf");
// ปิดวัตถุ MemoryStream
ms.Close();
```

## บทสรุป

ขอแสดงความยินดี! คุณได้แปลงสตรีมรูปภาพเป็นไฟล์ PDF โดยใช้ Aspose.PDF สำหรับ .NET สำเร็จแล้ว ไฟล์ PDF ที่สร้างขึ้นจะถูกบันทึกในไดเร็กทอรีที่ระบุ ตอนนี้คุณสามารถใช้ไฟล์ PDF นี้ในโครงการหรือแอปพลิเคชันของคุณได้แล้ว

### คำถามที่พบบ่อย

#### ถาม: วัตถุประสงค์ของการแปลงสตรีมรูปภาพเป็นไฟล์ PDF โดยใช้ Aspose.PDF สำหรับ .NET คืออะไร

ตอบ: การแปลงสตรีมรูปภาพเป็นไฟล์ PDF จะมีประโยชน์สำหรับการรวมรูปภาพลงในเอกสาร PDF การสร้าง PDF ที่ใช้รูปภาพ หรือการฝังรูปภาพภายในเนื้อหาที่เป็นข้อความ

#### ถาม: Aspose.PDF สำหรับ .NET ช่วยแปลงสตรีมรูปภาพเป็นไฟล์ PDF ได้อย่างไร

ตอบ: Aspose.PDF สำหรับ .NET ให้กระบวนการที่สะดวกและทีละขั้นตอนในการสร้างเอกสาร PDF อ่านสตรีมรูปภาพ และฝังรูปภาพลงในไฟล์ PDF

#### ถาม: เหตุใดการกำหนดไดเร็กทอรีเอกสารจึงมีความสำคัญในกระบวนการแปลงสตรีมรูปภาพเป็น PDF

ตอบ: การระบุไดเร็กทอรีเอกสารช่วยให้แน่ใจว่าสตรีมรูปภาพและไฟล์ PDF ที่ได้นั้นอยู่ในตำแหน่งที่ถูกต้องในเส้นทางเอาต์พุตที่ต้องการ

#### ถาม: ฉันจะสร้างเอกสาร PDF โดยใช้ Aspose.PDF สำหรับ .NET ในกระบวนการแปลงสตรีมรูปภาพเป็น PDF ได้อย่างไร

 A: ยกตัวอย่าง`Document` วัตถุโดยใช้`Aspose.Pdf.Document` ตัวสร้างว่างของคลาสเพื่อสร้างเอกสาร PDF

####  ถาม: บทบาทของ ก. คืออะไร?`Pages` object in the image stream to PDF conversion process?

 ตอบ:`Pages` object ช่วยให้คุณสามารถเพิ่มหน้าลงในเอกสาร PDF และจัดการเนื้อหาได้

#### ถาม: สตรีมรูปภาพอ่านและประมวลผลในกระบวนการแปลงสตรีมรูปภาพเป็น PDF อย่างไร

 ตอบ: สตรีมรูปภาพถูกอ่านโดยใช้`FileStream` วัตถุและเนื้อหาจะถูกเก็บไว้ในอาร์เรย์ไบต์ จากนั้นจึงใช้อาร์เรย์ไบต์เพื่อสร้าง`MemoryStream` วัตถุซึ่งต่อมาใช้เพื่อสร้าง`Image` วัตถุ.

#### ถาม: รูปภาพถูกฝังอยู่ในเอกสาร PDF ในระหว่างกระบวนการแปลงอย่างไร

 ตอบ: อัน`Image` วัตถุถูกสร้างขึ้นโดยใช้`Aspose.Pdf.Image` คลาสและสตรีมรูปภาพถูกกำหนดให้กับ`ImageStream` คุณสมบัติ. ที่`Image` จากนั้นวัตถุก็จะถูกเพิ่มเข้าไปใน`Paragraphs` การรวบรวมเอกสาร PDF

#### ถาม: ฉันสามารถปรับแต่งตำแหน่ง ขนาด หรือคุณลักษณะอื่นๆ ของรูปภาพในไฟล์ PDF ที่ได้ได้หรือไม่

 ตอบ: ได้ คุณสามารถแก้ไขตำแหน่ง ขนาด และคุณลักษณะอื่นๆ ของรูปภาพได้โดยการปรับคุณสมบัติของ`Image` วัตถุก่อนที่จะเพิ่มเข้าไปใน`Paragraphs` ของสะสม.

#### ถาม: ขั้นตอนสุดท้ายในกระบวนการแปลงสตรีมรูปภาพเป็น PDF คืออะไร

 ตอบ: เอกสาร PDF จะถูกบันทึกโดยใช้ไฟล์`Save` วิธีการของ`Document` วัตถุและ`MemoryStream` วัตถุถูกปิดโดยใช้`Close` วิธีการปลดปล่อยทรัพยากร