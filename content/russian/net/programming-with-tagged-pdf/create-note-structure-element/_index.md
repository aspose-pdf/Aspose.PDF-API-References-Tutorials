---
title: Создать элемент структуры заметки
linktitle: Создать элемент структуры заметки
second_title: Справочник по Aspose.PDF для .NET API
description: Пошаговое руководство по созданию структурированных элементов заметок в документе PDF с использованием Aspose.PDF для .NET.
type: docs
weight: 30
url: /ru/net/programming-with-tagged-pdf/create-note-structure-element/
---
В этом уроке мы предоставим вам пошаговое руководство по созданию элемента структуры заметки в PDF-документе с помощью Aspose.PDF для .NET. Aspose.PDF — это мощная библиотека, которая позволяет программно создавать, манипулировать и конвертировать PDF-документы. Используя отмеченные функции структуры контента Aspose.PDF, вы можете добавлять структурированные примечания к вашему PDF-документу.

## Предварительные условия

Прежде чем начать, убедитесь, что у вас есть следующие предварительные условия:

1. Visual Studio установлена с .NET Framework.
2. Библиотека Aspose.PDF для .NET.

## Шаг 1: Настройка проекта

Для начала создайте новый проект в Visual Studio и добавьте ссылку на библиотеку Aspose.PDF для .NET. Вы можете скачать библиотеку с официального сайта Aspose и установить ее на свой компьютер.

## Шаг 2. Импортируйте необходимые пространства имен.

В файл кода C# импортируйте пространства имен, необходимые для доступа к классам и методам, предоставляемым Aspose.PDF:

```csharp
using System;
using Aspose.Pdf;
using Aspose.Pdf.Tagged;
```

## Шаг 3. Создание PDF-документа и структурированных элементов заметок

Используйте следующий код, чтобы создать документ PDF и добавить структурированные элементы заметок:

```csharp
string dataDir = "YOUR_DIRECTORY_OF_DOCUMENTS";
string outFile = dataDir + "45929_doc.pdf";
string logFile = dataDir + "45929_log.xml";

Document document = new Document();
ITaggedContent taggedContent = document.TaggedContent;
taggedContent.SetTitle("Sample Grade Items");
taggedContent.SetLanguage("fr-FR");

ParagraphElement paragraph = taggedContent.CreateParagraphElement();
taggedContent.RootElement.AppendChild(paragraph);

NoteElement note1 = taggedContent.CreateNoteElement();
paragraph. AppendChild(note1);
note1.SetText("Note with automatically generated ID. ");

NoteElement note2 = taggedContent.CreateNoteElement();
paragraph. AppendChild(note2);
note2.SetText("Note with ID = 'note_002'.");
note2.SetId("note_002");

NoteElement note3 = taggedContent.CreateNoteElement();
paragraph. AppendChild(note3);
note3.SetText("Note with ID = 'note_003'.");
note3.SetId("note_003");
```

Этот код создает пустой PDF-документ и добавляет в абзац элементы структурированной заметки. Каждая заметка создается с использованием методов, предоставляемых Aspose.PDF.

## Шаг 4. Сохранение PDF-документа

Используйте следующий код, чтобы сохранить PDF-документ:

```csharp
document. Save(outFile);
```

Этот код сохраняет PDF-документ со структурированными элементами примечаний в указанный файл.

### Пример исходного кода для создания элемента структуры заметки с использованием Aspose.PDF для .NET 

```csharp
// Путь к каталогу документов.
string dataDir = "YOUR DOCUMENT DIRECTORY";
string outFile = dataDir + "45929_doc.pdf";
string logFile = dataDir + "45929_log.xml";
// Создать PDF-документ
Document document = new Document();
ITaggedContent taggedContent = document.TaggedContent;
taggedContent.SetTitle("Sample of Note Elements");
taggedContent.SetLanguage("en-US");
// Добавить элемент абзаца
ParagraphElement paragraph = taggedContent.CreateParagraphElement();
taggedContent.RootElement.AppendChild(paragraph);
// Добавить элемент примечания
NoteElement note1 = taggedContent.CreateNoteElement();
paragraph.AppendChild(note1);
note1.SetText("Note with auto generate ID. ");
// Добавить элемент примечания
NoteElement note2 = taggedContent.CreateNoteElement();
paragraph.AppendChild(note2);
note2.SetText("Note with ID = 'note_002'. ");
note2.SetId("note_002");
// Добавить элемент примечания
NoteElement note3 = taggedContent.CreateNoteElement();
paragraph.AppendChild(note3);
note3.SetText("Note with ID = 'note_003'. ");
note3.SetId("note_003");
// Должно быть выброшено исключение — Aspose.Pdf.Tagged.TaggedException: элемент структуры с ID = «note_002» уже существует.
//note3.SetId("note_002");
// Результирующий документ не соответствует PDF/UA, если ClearId() используется для элемента структуры примечания.
//note3.ClearId();
// Сохранить PDF-документ с тегами
document.Save(outFile);
// Проверка соответствия PDF/UA
document = new Document(outFile);
bool isPdfUaCompliance = document.Validate(logFile, PdfFormat.PDF_UA_1);
Console.WriteLine(String.Format("PDF/UA compliance: {0}", isPdfUaCompliance));

```

## Заключение

В этом уроке вы узнали, как создавать элементы структуры заметок в PDF-документе с помощью Aspose.PDF для .NET. Элементы структурированных заметок позволяют добавлять дополнительную структурированную информацию в PDF-документ.

### Часто задаваемые вопросы

#### Вопрос: Какова цель создания элементов структуры заметок в PDF-документе с помощью Aspose.PDF для .NET?

О: Создание элементов структуры примечаний в PDF-документе с помощью Aspose.PDF для .NET позволяет добавлять структурированные примечания к содержимому документа. Эти примечания могут содержать дополнительный контекст, пояснения или ссылки на определенные части контента.

#### Вопрос: Как библиотека Aspose.PDF помогает создавать элементы структуры заметок в PDF-документе?

О: Aspose.PDF для .NET — это мощная библиотека, предоставляющая функциональные возможности для программного создания, управления и преобразования PDF-документов. В этом руководстве функции структуры отмеченного содержимого библиотеки используются для создания структурированных элементов примечаний в содержимом PDF-документа.

#### Вопрос: Каковы предварительные условия для создания элементов структуры примечаний в PDF-документе с использованием Aspose.PDF для .NET?

О: Прежде чем начать, убедитесь, что у вас установлена Visual Studio с платформой .NET и в вашем проекте есть ссылка на библиотеку Aspose.PDF для .NET.

#### Вопрос: Как предоставленный код C# создает элементы структуры примечаний в содержимом PDF-документа?

О: Код демонстрирует, как создать PDF-документ, определить структурированные элементы примечаний и добавить их в абзац. Каждая заметка создается с использованием методов Aspose.PDF, что позволяет включать структурированные заметки в контент.

#### Вопрос: Могу ли я настроить содержимое и свойства элементов структуры заметки, которые я создаю?

О: Да, вы можете настроить содержимое и свойства элементов структуры заметок, используя методы и свойства, предоставляемые библиотекой Aspose.PDF. Код демонстрирует, как установить текст и идентификатор элементов заметки, но вы можете дополнительно настроить их по мере необходимости.

#### Вопрос: Как устанавливается иерархическая связь между элементами структуры заметки и содержимым документа?

 О: Иерархические отношения устанавливаются путем добавления элементов структуры примечаний в качестве дочерних элементов других структурированных элементов, таких как абзацы. В коде элементы примечаний добавляются к элементу абзаца с помощью`AppendChild` метод.

#### Вопрос: Могу ли я присвоить уникальные идентификаторы элементам структуры заметок?

О: Да, вы можете присвоить уникальные идентификаторы элементам структуры заметок с помощью`SetId` метод. Код демонстрирует, как присвоить идентификаторам элементов заметки уникальные значения.

#### Вопрос: Что произойдет, если я попытаюсь присвоить повторяющийся идентификатор элементу структуры заметки?

О: Попытка присвоить элементу структуры заметки повторяющийся идентификатор приведет к возникновению исключения. Код, представленный в руководстве, включает комментарий, иллюстрирующий этот сценарий.

#### Вопрос: Как обеспечить соответствие PDF/UA при создании элементов структуры заметок?

 О: Код, представленный в руководстве, демонстрирует, как проверить соответствие PDF/UA с помощью`Validate` метод. Проверив документ на соответствие стандарту PDF/UA, вы можете гарантировать, что добавленные элементы структуры примечаний соответствуют рекомендациям по обеспечению специальных возможностей.

#### Вопрос: Могу ли я использовать этот подход для добавления элементов структуры примечаний в существующий PDF-документ?

О: Да, вы можете изменить предоставленный подход, чтобы добавить элементы структуры примечаний в существующий PDF-документ. Вместо создания нового документа вы должны загрузить существующий документ с помощью Aspose.PDF, а затем выполнить аналогичные шаги для добавления элементов примечания.
