---
title: Встроить шрифт при создании PDF-документа
linktitle: Встроить шрифт при создании PDF-документа
second_title: Справочник по API Aspose.PDF для .NET
description: Узнайте, как встраивать шрифты в документы PDF с помощью Aspose.PDF для .NET с помощью этого пошагового руководства. Улучшите внешний вид вашего PDF.
type: docs
weight: 140
url: /ru/net/programming-with-document/embedfontwhiledoccreation/
---
## Введение

Создание документов PDF, которые выглядят профессионально и отточенно, имеет важное значение в современном цифровом мире. Одним из ключевых аспектов достижения этого отточенного вида является обеспечение правильного внедрения шрифтов, используемых в вашем PDF. Это не только сохраняет внешний вид вашего документа на разных устройствах, но и повышает читабельность. В этом руководстве мы рассмотрим, как внедрять шрифты при создании документов PDF с помощью Aspose.PDF для .NET. 

## Предпосылки

Прежде чем перейти к коду, давайте убедимся, что у вас есть все необходимое для начала работы:

1.  Aspose.PDF для .NET: Вам понадобится установленная библиотека Aspose.PDF. Вы можете загрузить ее с[веб-сайт](https://releases.aspose.com/pdf/net/).
2. Visual Studio: среда разработки, в которой вы можете писать и тестировать свой код.
3. Базовые знания C#: знакомство с программированием на C# поможет вам лучше понимать фрагменты кода.

## Импортные пакеты

Чтобы использовать Aspose.PDF в вашем проекте, вам нужно импортировать необходимые пространства имен. Вот как это можно сделать:

```csharp
using Aspose.Pdf;
using Aspose.Pdf.Text;
```

Эти пространства имен предоставят вам доступ к классам и методам, необходимым для создания и обработки PDF-документов.

Теперь, когда мы определились с предварительными условиями, давайте разберем процесс внедрения шрифтов в PDF-документ на выполнимые шаги.

## Шаг 1: Настройте каталог документов

Прежде всего, вам нужно определить путь, по которому будет сохранен ваш PDF-документ. Это важно, поскольку это сообщает вашему приложению, где хранить выходной файл.

```csharp
// Путь к каталогу документов.
string dataDir = "YOUR DOCUMENT DIRECTORY";
```

 Заменять`"YOUR DOCUMENT DIRECTORY"`фактическим путем в вашей системе, куда вы хотите сохранить PDF-файл.

## Шаг 2: Создание документа PDF

 Далее вы создадите экземпляр`Document` класс. Этот класс представляет ваш PDF-документ.

```csharp
// Создайте экземпляр объекта Pdf, вызвав его пустой конструктор
Aspose.Pdf.Document doc = new Aspose.Pdf.Document();
```

Вызывая пустой конструктор, вы создаете новый пустой PDF-документ, готовый к заполнению содержимым.

## Шаг 3: Создайте страницу в PDF-документе

Теперь давайте добавим страницу в ваш PDF-документ. Каждому PDF-файлу нужна как минимум одна страница, поэтому этот шаг необходим.

```csharp
// Создать раздел в объекте PDF
Aspose.Pdf.Page page = doc.Pages.Add();
```

Эта строка кода добавляет новую страницу в ваш документ, позволяя вам начать добавлять контент.

## Шаг 4: Создайте фрагмент текста

 Чтобы добавить текст в ваш PDF-файл, вам нужно создать`TextFragment`. Этот объект будет содержать текст, который вы хотите отобразить.

```csharp
Aspose.Pdf.Text.TextFragment fragment = new Aspose.Pdf.Text.TextFragment("");
```

 Здесь мы инициализируем новый`TextFragment`. Вы можете думать об этом как о контейнере для вашего текста.

## Шаг 5: Добавьте текстовые сегменты

Теперь давайте создадим текстовый сегмент, содержащий текст, который вы хотите отобразить. Здесь вы можете настроить свой текст.

```csharp
Aspose.Pdf.Text.TextSegment segment = new Aspose.Pdf.Text.TextSegment("This is a sample text using Custom font.");
```

Можете свободно менять текст на любой, какой захотите. Это ваш контент!

## Шаг 6: Определите состояние текста и внедрите шрифт

 Чтобы убедиться, что ваш шрифт встроен в PDF-файл, вам необходимо задать свойства шрифта в`TextState` объект.

```csharp
Aspose.Pdf.Text.TextState ts = new Aspose.Pdf.Text.TextState();
ts.Font = FontRepository.FindFont("Arial");
ts.Font.IsEmbedded = true;
segment.TextState = ts;
```

В этом коде мы указываем, что хотим использовать шрифт Arial и что он должен быть встроен в PDF. Это важный шаг для обеспечения того, чтобы ваш документ выглядел одинаково на всех устройствах.

## Шаг 7: Добавьте сегмент к фрагменту

Теперь, когда ваш текстовый сегмент готов, пришло время добавить его к текстовому фрагменту.

```csharp
fragment.Segments.Add(segment);
```

Эта строка добавляет сегмент к фрагменту, делая его частью текста, который будет отображаться на странице.

## Шаг 8: Добавьте фрагмент на страницу

Далее вам необходимо добавить текстовый фрагмент на созданную ранее страницу.

```csharp
page.Paragraphs.Add(fragment);
```

Этот шаг гарантирует, что ваш текст появится на странице PDF-документа.

## Шаг 9: Сохраните PDF-документ.

Наконец, пришло время сохранить ваш PDF-документ. Вам нужно указать путь, по которому вы хотите его сохранить.

```csharp
dataDir = dataDir + "EmbedFontWhileDocCreation_out.pdf";
// Сохранить PDF-документ
doc.Save(dataDir);
```

Этот код объединяет имя выходного файла с путем к каталогу вашего документа и сохраняет PDF-файл. 

## Заключение

И вот оно! Вы успешно создали PDF-документ со встроенными шрифтами с помощью Aspose.PDF для .NET. Этот процесс не только улучшает визуальную привлекательность ваших документов, но и гарантирует, что они сохранят свое форматирование на разных платформах. 

## Часто задаваемые вопросы

### Что такое Aspose.PDF для .NET?
Aspose.PDF для .NET — это мощная библиотека, которая позволяет разработчикам программно создавать, изменять и конвертировать PDF-документы.

### Зачем мне встраивать шрифты в мой PDF-файл?
Встраивание шрифтов гарантирует, что ваш документ будет выглядеть одинаково на всех устройствах, сохраняя его предполагаемый дизайн и читабельность.

### Могу ли я использовать пользовательские шрифты в Aspose.PDF?
Да, вы можете использовать пользовательские шрифты, если они доступны в вашей системе и правильно указаны в вашем коде.

### Существует ли бесплатная пробная версия Aspose.PDF?
 Да, вы можете загрузить бесплатную пробную версию с сайта[Сайт Aspose](https://releases.aspose.com/).

### Где я могу найти поддержку по Aspose.PDF?
 Вы можете найти поддержку и задать вопросы на[Форум Aspose](https://forum.aspose.com/c/pdf/10).