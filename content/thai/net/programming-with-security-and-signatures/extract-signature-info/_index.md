---
title: ดึงข้อมูลลายเซ็น
linktitle: ดึงข้อมูลลายเซ็น
second_title: เอกสารอ้างอิง Aspose.PDF สำหรับ API ของ .NET
description: เรียนรู้วิธีแยกลายเซ็นดิจิทัลและข้อมูลใบรับรองจากเอกสาร PDF โดยใช้ Aspose.PDF สำหรับ .NET คำแนะนำทีละขั้นตอนแบบครบถ้วนสำหรับนักพัฒนา C#
type: docs
weight: 80
url: /th/net/programming-with-security-and-signatures/extract-signature-info/
---
## การแนะนำ

ในโลกดิจิทัลทุกวันนี้ การรับรองความปลอดภัยและความสมบูรณ์ของเอกสารถือเป็นสิ่งสำคัญ วิธีการทั่วไปวิธีหนึ่งที่ใช้เพื่อรักษาความปลอดภัยไฟล์ PDF คือการเพิ่มลายเซ็นดิจิทัล อย่างไรก็ตาม การดึงข้อมูลและยืนยันรายละเอียดลายเซ็นอาจเป็นเรื่องท้าทายได้ โดยเฉพาะอย่างยิ่งเมื่อคุณต้องจัดการกับใบรับรองต่างๆ ในคู่มือนี้ เราจะแนะนำคุณเกี่ยวกับกระบวนการดึงข้อมูลลายเซ็นจากเอกสาร PDF โดยใช้ Aspose.PDF สำหรับ .NET ซึ่งจะทำให้ภารกิจนี้ง่ายดายขึ้น คุณจะได้เรียนรู้วิธีการเข้าถึงฟิลด์ลายเซ็น ดึงข้อมูลใบรับรอง และบันทึกลงในไฟล์

## ข้อกำหนดเบื้องต้น

ก่อนที่เราจะเริ่ม เรามาตรวจสอบให้แน่ใจว่าคุณมีทุกอย่างพร้อมสำหรับการเริ่มต้นกันก่อน

-  Aspose.PDF สำหรับไลบรารี .NET: หากคุณยังไม่มี คุณสามารถดาวน์โหลดได้จาก[หน้าดาวน์โหลด Aspose.PDF สำหรับ .NET](https://releases.aspose.com/pdf/net/). 
- สภาพแวดล้อมการพัฒนา .NET: คุณจะต้องมี IDE เช่น Visual Studio
- ความรู้พื้นฐานเกี่ยวกับ C#: ความคุ้นเคยกับ C# จะเป็นประโยชน์ในการทำความเข้าใจชิ้นส่วนโค้ดในบทช่วยสอนนี้
- เอกสาร PDF ที่มีลายเซ็นดิจิทัล: เพื่อวัตถุประสงค์ในการทดสอบ ตรวจสอบให้แน่ใจว่าคุณมีไฟล์ PDF ที่มีลายเซ็นดิจิทัลอย่างน้อยหนึ่งรายการ

## การนำเข้าเนมสเปซที่จำเป็น

ก่อนจะเริ่มเขียนโค้ด สิ่งสำคัญคือต้องนำเข้าเนมสเปซที่จำเป็น เนมสเปซเหล่านี้จะช่วยให้คุณเข้าถึงฟังก์ชัน Aspose.PDF และทำงานกับเอกสาร PDF ได้

```csharp
using System.IO;
using Aspose.Pdf.Forms;
using Aspose.Pdf;
using System;
```

ตอนนี้คุณได้ตั้งค่าสิ่งสำคัญเรียบร้อยแล้ว เรามาดูกระบวนการจริงในการแยกข้อมูลลายเซ็นจาก PDF กัน

## ขั้นตอนที่ 1: การตั้งค่าไดเรกทอรีเอกสาร

 ก่อนที่จะทำงานกับเอกสาร PDF คุณต้องระบุตำแหน่งของไฟล์ที่คุณจะใช้ คุณสามารถแทนที่`"YOUR DOCUMENT DIRECTORY"` พร้อมเส้นทางจริงของไดเร็กทอรีที่คุณจัดเก็บไฟล์ PDF ของคุณ

```csharp
// เส้นทางไปยังไดเร็กทอรีเอกสาร
string dataDir = "YOUR DOCUMENT DIRECTORY";
string input = dataDir + "ExtractSignatureInfo.pdf";
```

ที่นี่ เราจะระบุไดเรกทอรีที่มีไฟล์ PDF และชื่อไฟล์เอง ตรวจสอบให้แน่ใจว่ามีไฟล์อยู่ในไดเรกทอรีนั้น!

## ขั้นตอนที่ 2: การโหลดเอกสาร PDF

 ตอนนี้คุณได้ตั้งค่าไดเร็กทอรีของคุณแล้ว ขั้นตอนต่อไปคือการโหลดเอกสาร PDF โดยใช้`Document` คลาสจาก Aspose.PDF

```csharp
using (Document pdfDocument = new Document(input))
{
    // ดำเนินการ PDF ที่นี่
}
```

 บรรทัดโค้ดนี้จะเริ่มต้น`Document`วัตถุที่แสดงถึงไฟล์ PDF`using` คำชี้แจงนี้ช่วยให้แน่ใจว่าทรัพยากรได้รับการทำความสะอาดหลังจากประมวลผลเอกสารแล้ว

## ขั้นตอนที่ 3: การเข้าถึงฟิลด์แบบฟอร์ม

ในขั้นตอนนี้ เราจะวนซ้ำผ่านฟิลด์ฟอร์มทั้งหมดในเอกสาร PDF เนื่องจากลายเซ็นมักจะถูกจัดเก็บเป็นฟิลด์ฟอร์ม ขั้นตอนนี้จะช่วยให้เราระบุฟิลด์ลายเซ็นได้

```csharp
foreach (Field field in pdfDocument.Form)
{
    // ระบุช่องลายเซ็นที่นี่
}
```

 โดยการวนซ้ำผ่าน`Form` ทรัพย์สินของ`Document` วัตถุ เราสามารถตรวจสอบฟิลด์ฟอร์มแต่ละฟิลด์เพื่อตรวจสอบว่าเป็นฟิลด์ลายเซ็นหรือไม่

## ขั้นตอนที่ 4: การระบุช่องลายเซ็น

 เมื่อคุณเข้าถึงฟิลด์แบบฟอร์มแล้ว ขั้นตอนต่อไปคือการระบุว่าฟิลด์ใดเป็นฟิลด์ลายเซ็น เราสามารถทำได้โดยการแปลงฟิลด์แต่ละฟิลด์เป็น`SignatureField` วัตถุ.

```csharp
SignatureField sf = field as SignatureField;
if (sf != null)
{
    // แยกข้อมูลลายเซ็น
}
```

 ที่นี่เราใช้`as` คำสำคัญในการพยายามที่จะแปลงฟิลด์ฟอร์มแต่ละฟิลด์เป็น`SignatureField`. หากแคสต์ประสบความสำเร็จ เราจะรู้ว่าสนามนั้นเป็นลายเซ็น

## ขั้นตอนที่ 5: การแยกใบรับรอง

เมื่อคุณระบุฟิลด์ลายเซ็นเรียบร้อยแล้ว งานต่อไปคือการแยกใบรับรองจากลายเซ็น ใบรับรองประกอบด้วยข้อมูลสำคัญเกี่ยวกับผู้ลงนามและความถูกต้องของลายเซ็น

```csharp
Stream cerStream = sf.ExtractCertificate();
```

 การ`ExtractCertificate` วิธีการส่งคืน a`Stream` วัตถุที่มีข้อมูลใบรับรอง สตรีมนี้สามารถใช้เพื่อบันทึกใบรับรองสำหรับการวิเคราะห์หรือจัดเก็บเพิ่มเติม

## ขั้นตอนที่ 6: บันทึกใบรับรองลงในไฟล์

 เมื่อคุณแยกใบรับรองแล้ว ขั้นตอนสุดท้ายคือการบันทึกลงในไฟล์ ในกรณีนี้ เราจะบันทึกใบรับรองเป็น`.cer` ไฟล์.

```csharp
if (cerStream != null)
{
    using (cerStream)
    {
        byte[] bytes = new byte[cerStream.Length];
        using (FileStream fs = new FileStream(dataDir + @"input.cer", FileMode.CreateNew))
        {
            cerStream.Read(bytes, 0, bytes.Length);
            fs.Write(bytes, 0, bytes.Length);
        }
    }
}
```

ในบล็อกโค้ดนี้ เราจะ:

1. ตรวจสอบว่าสตรีมใบรับรองไม่ใช่ค่าว่าง
2. อ่านข้อมูลใบรับรองลงในอาร์เรย์ไบต์
3.  เขียนอาร์เรย์ไบต์ลงใน`.cer` ไฟล์อยู่ในไดเร็กทอรีเอกสาร

## บทสรุป

การแยกลายเซ็นดิจิทัลและข้อมูลใบรับรองที่เกี่ยวข้องจากเอกสาร PDF โดยใช้ Aspose.PDF สำหรับ .NET ทำได้ง่ายมากเมื่อแบ่งเป็นขั้นตอนง่ายๆ ไม่ว่าคุณจะกำลังตรวจสอบเอกสาร ยืนยันลายเซ็น หรือเพียงแค่จัดเก็บใบรับรองเพื่อความปลอดภัย บทช่วยสอนนี้จะช่วยให้คุณมีความรู้ในการดำเนินการอย่างมีประสิทธิภาพ โปรดจำไว้ว่าการรักษาความปลอดภัยและยืนยันเอกสารเป็นสิ่งสำคัญในโลกดิจิทัลปัจจุบัน และการใช้เครื่องมือเช่น Aspose.PDF สำหรับ .NET จะทำให้การจัดการง่ายขึ้นมาก

## คำถามที่พบบ่อย

### ฉันสามารถแยกลายเซ็นหลายรายการจาก PDF โดยใช้ Aspose.PDF สำหรับ .NET ได้หรือไม่
ใช่ โค้ดจะวนซ้ำผ่านฟิลด์ฟอร์มทั้งหมดในเอกสาร ทำให้คุณสามารถดึงลายเซ็นหลายรายการออกมาได้ หากมีอยู่

### จะเกิดอะไรขึ้นถ้าไม่พบลายเซ็นใน PDF?
ถ้าไม่มีฟิลด์ลายเซ็น โค้ดจะข้ามฟิลด์เหล่านั้นโดยไม่เกิดข้อผิดพลาด

### ฉันสามารถใช้แนวทางนี้เพื่อตรวจสอบความถูกต้องของลายเซ็นได้หรือไม่
แม้ว่าคุณจะสามารถแยกใบรับรองได้ แต่การตรวจสอบความถูกต้องของลายเซ็นจะต้องมีขั้นตอนเพิ่มเติม เช่น การตรวจสอบห่วงโซ่ความน่าเชื่อถือของใบรับรอง

### เป็นไปได้หรือไม่ที่จะแยกข้อมูลฟิลด์ฟอร์มอื่นโดยใช้ Aspose.PDF สำหรับ .NET?
ใช่ Aspose.PDF ช่วยให้คุณสามารถเข้าถึงและจัดการฟิลด์ฟอร์มประเภทต่างๆ ใน PDF ไม่ใช่แค่ฟิลด์ลายเซ็นเท่านั้น

### ฉันสามารถดูรายละเอียดใบรับรองที่แยกออกมาได้อย่างไร
 เมื่อใบรับรองได้รับการบันทึกเป็น`.cer` ไฟล์ คุณสามารถเปิดได้โดยใช้โปรแกรมดูใบรับรองใดๆ หรือจะนำเข้าไปในที่เก็บใบรับรองของระบบเพื่อตรวจสอบเพิ่มเติม