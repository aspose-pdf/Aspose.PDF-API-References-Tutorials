---
title: จัดเก็บภาพในคอลเลคชัน XImage
linktitle: จัดเก็บภาพในคอลเลคชัน XImage
second_title: เอกสารอ้างอิง Aspose.PDF สำหรับ API ของ .NET
description: เรียนรู้วิธีจัดเก็บรูปภาพในคอลเลคชัน XImage โดยใช้ Aspose.PDF สำหรับ .NET ในคู่มือทีละขั้นตอนฉบับสมบูรณ์นี้
type: docs
weight: 290
url: /th/net/programming-with-images/store-image-in-ximage-collection/
---
## การแนะนำ

ในยุคดิจิทัลทุกวันนี้ การจัดการและแก้ไขเอกสารด้วยโปรแกรมถือเป็นสิ่งสำคัญสำหรับแอปพลิเคชันต่างๆ มากมาย Aspose.PDF สำหรับ .NET ช่วยให้ผู้พัฒนาสามารถทำงานกับไฟล์ PDF ได้อย่างง่ายดาย ช่วยเพิ่มประสิทธิภาพเวิร์กโฟลว์และเปิดโอกาสให้สร้างเนื้อหาแบบไดนามิกได้ ในคู่มือนี้ เราจะเจาะลึกกระบวนการจัดเก็บภาพในคอลเลกชัน XImage ซึ่งเป็นฟีเจอร์สำคัญที่ช่วยให้คุณฝังภาพลงใน PDF ได้โดยตรง พร้อมที่จะเริ่มต้นการเดินทางในการสร้างเนื้อหาที่น่าทึ่งนี้แล้ว

## ข้อกำหนดเบื้องต้น

ก่อนที่เราจะเจาะลึกโค้ดและกระบวนการ คุณจะต้องแน่ใจว่าคุณมีบางสิ่งบางอย่างอยู่ในสถานที่นั้น:

- สภาพแวดล้อม .NET: คุณควรติดตั้ง .NET Framework ไว้ในเครื่องของคุณ เลือกเวอร์ชันที่เหมาะสมตามความต้องการของโครงการของคุณ
- Aspose.PDF สำหรับ .NET: ตรวจสอบให้แน่ใจว่าคุณมีไลบรารี Aspose.PDF คุณสามารถดาวน์โหลดได้จาก[ที่นี่](https://releases.aspose.com/pdf/net/) หรือเริ่มต้นด้วยการทดลองใช้ฟรี[ที่นี่](https://releases.aspose.com/).
- ไฟล์รูปภาพ: คุณต้องมีไฟล์รูปภาพ (เช่น JPG หรือ PNG) ที่คุณต้องการจัดเก็บในรูปแบบ PDF สำหรับตัวอย่างนี้ เราจะใช้ไฟล์ชื่อ "aspose-logo.jpg"
- ความเข้าใจพื้นฐานเกี่ยวกับ C#: ความคุ้นเคยกับการเขียนโปรแกรม C# จะช่วยให้คุณทำตามได้อย่างราบรื่น

## แพ็คเกจนำเข้า

หากต้องการเริ่มใช้ Aspose.PDF สำหรับ .NET คุณจะต้องนำเข้าเนมสเปซที่จำเป็น ขั้นตอนนี้จะเป็นการวางรากฐานสำหรับการใช้ฟังก์ชันทั้งหมดที่ไลบรารีมีให้

```csharp
using System;
using System.IO;
using Aspose.Pdf.Operators;
```

การนำเข้าเนมสเปซเหล่านี้จะช่วยเปิดใช้งานฟีเจอร์ต่างๆ ใน Aspose.PDF รวมถึงการสร้างเอกสาร การประมวลผลรูปภาพ และอื่นๆ อีกมากมาย

เรามาแบ่งขั้นตอนออกเป็นขั้นตอนที่จัดการได้เพื่อให้คุณปฏิบัติตามได้ง่ายขึ้น

## ขั้นตอนที่ 1: ตั้งค่าไดเรกทอรีเอกสารของคุณ

สิ่งแรกที่คุณต้องทำคืออะไร? กำหนดว่าเอกสารของคุณจะอยู่ที่ใด คุณจะต้องตั้งค่าตัวแปรที่เก็บเส้นทางไปยังไดเร็กทอรีเอกสารของคุณ นี่คือที่ที่คุณจะบันทึก PDF

```csharp
string dataDir = "YOUR DOCUMENT DIRECTORY"; // แทนที่ด้วยไดเร็กทอรีเอกสารจริงของคุณ
```

## ขั้นตอนที่ 2: เริ่มต้นเอกสาร

ตอนนี้ถึงเวลาสร้างเอกสาร PDF ใหม่แล้ว ขั้นตอนนี้เป็นขั้นตอนที่ PDF ของคุณจะมีชีวิตชีวา 

```csharp
Aspose.Pdf.Document document = new Document();
```

ที่นี่ เรากำลังสร้างอินสแตนซ์ของวัตถุ Document ใหม่ซึ่งจะทำหน้าที่เป็นผืนผ้าใบของเรา

## ขั้นตอนที่ 3: เพิ่มหน้าใหม่

ผลงานชิ้นเอกทุกชิ้นต้องมีผืนผ้าใบใช่หรือไม่ ในกรณีของเรา เราต้องมีหน้าสำหรับทำงานภายในเอกสาร

```csharp
document.Pages.Add();
Page page = document.Pages[1]; // รับหน้าแรก
```

เรากำลังเพิ่มหน้าใหม่ลงในเอกสารของเรา ตอนนี้เราจะดำเนินการบนหน้านี้

## ขั้นตอนที่ 4: โหลดไฟล์รูปภาพ

ขั้นตอนต่อไป คุณจะต้องโหลดภาพลงในโปรแกรมของคุณ ขั้นตอนนี้จะคล้ายกับการเปิดหนังสือเพื่ออ่าน คุณต้องเข้าถึงเนื้อหาเสียก่อนจึงจะสามารถใช้งานได้

```csharp
using (FileStream imageStream = new FileStream(dataDir + "aspose-logo.jpg", FileMode.Open))
{
```

บรรทัดนี้จะเปิดไฟล์รูปภาพเป็นสตรีมซึ่งช่วยให้เราสามารถจัดการและฝังลงใน PDF ได้

## ขั้นตอนที่ 5: เพิ่มรูปภาพลงในหน้าทรัพยากร

ตอนนี้ คุณก็มีรูปภาพพร้อมแล้ว ถึงเวลาเพิ่มรูปภาพนั้นลงในทรัพยากรของหน้า โดยพื้นฐานแล้วก็คือแจ้ง PDF ว่า "เฮ้ ฉันมีรูปภาพเจ๋งๆ ที่อยากให้คุณจำไว้!"

```csharp
page.Resources.Images.Add(imageStream, ImageFilterType.Flate);
XImage ximage = page.Resources.Images[page.Resources.Images.Count];
```

 โค้ดนี้จะทำหน้าที่เพิ่มรูปภาพลงใน PDF และกำหนดให้กับ`XImage` ตัวแปรที่เราสามารถอ้างอิงได้ภายหลัง

## ขั้นตอนที่ 6: เตรียมการวาดภาพ

ขั้นตอนต่อไปคือการจัดวางรูปภาพบนหน้า คุณต้องกำหนดพิกัดเพื่อให้รูปภาพอยู่ในตำแหน่งที่คุณต้องการ

```csharp
page.Contents.Add(new GSave());
```

บรรทัดนี้จะบันทึกสถานะกราฟิกไว้สำหรับการคืนค่าในภายหลัง เหมือนกับการจับภาพการตั้งค่าต่างๆ ก่อนที่เราจะเปลี่ยนแปลงอะไร

## ขั้นตอนที่ 7: กำหนดตำแหน่งและขนาดของภาพ

ตอนนี้ ให้กำหนดว่าคุณต้องการวางภาพของคุณขนาดเท่าใดและวางไว้ที่ใด:

```csharp
int lowerLeftX = 0;
int lowerLeftY = 0;
int upperRightX = 600;
int upperRightY = 600;
Aspose.Pdf.Rectangle rectangle = new Aspose.Pdf.Rectangle(lowerLeftX, lowerLeftY, upperRightX, upperRightY);
```

บล็อกโค้ดนี้จะกำหนดขนาดของรูปสี่เหลี่ยมผืนผ้าที่จะใส่รูปภาพของคุณ ซึ่งจะทำให้รูปภาพมีตำแหน่งเริ่มต้นบนหน้าของคุณ

## ขั้นตอนที่ 8: สร้างเมทริกซ์การแปลง 

เพื่อควบคุมวิธีการวางภาพ เราจะกำหนดเมทริกซ์การแปลง ซึ่งจะควบคุมวิธีการแสดงภาพในพิกัดปลายทาง

```csharp
Matrix matrix = new Matrix(new double[] { rectangle.URX - rectangle.LLX, 0, 0, rectangle.URY - rectangle.LLY, rectangle.LLX, rectangle.LLY });
```

ลองคิดดูว่านี่เป็นการจัดทำแผนที่ก่อนออกเดินทาง ซึ่งจะช่วยกำหนดว่าภาพจะปรากฏบนหน้าอย่างไร

## ขั้นตอนที่ 9: วางรูปภาพบนหน้า

ตอนนี้ถึงเวลาที่จะบอก PDF จริงๆ แล้วว่าควรใส่รูปภาพนั้นไว้ที่ไหน

```csharp
page.Contents.Add(new ConcatenateMatrix(matrix));
page.Contents.Add(new Do(ximage.Name));
page.Contents.Add(new GRestore());
```

ที่นี่ เรากำลังเพิ่มคำสั่งลงในสตรีมเนื้อหาของ PDF ที่จะวาดภาพตามเมทริกซ์ที่เราเพิ่งสร้างขึ้น

## ขั้นตอนที่ 10: บันทึกเอกสาร

ในที่สุด เราก็สามารถบันทึกผลงานชิ้นเอกของเราไว้ได้แล้ว! นี่คือช่วงเวลาที่ผลงานหนักทั้งหมดของคุณมารวมกันเป็นผลงานที่จับต้องได้

```csharp
document.Save(dataDir + "FlateDecodeCompression.pdf");
```

คุณได้แจ้งให้ Aspose.PDF บันทึกเอกสารโดยใช้ชื่อไฟล์ที่กำหนดไว้ เมื่อคุณรันโค้ดนี้ คุณจะพบไฟล์ PDF ที่เพิ่งสร้างขึ้นในไดเร็กทอรีที่ระบุ พร้อมด้วยรูปภาพที่ฝังไว้

## บทสรุป

และแล้วคุณก็ได้เรียนรู้แล้ว! คุณได้เรียนรู้วิธีใช้ Aspose.PDF สำหรับ .NET เพื่อจัดเก็บภาพในคอลเลกชัน XImage ทีละจุดแล้ว การได้เห็นโค้ดของคุณเป็นรูปเป็นร่างและสร้างสิ่งที่เป็นประโยชน์ขึ้นมานั้นช่างน่าพอใจไม่ใช่น้อย ไม่ว่าคุณจะกำลังสร้างแอปพลิเคชันหรือเพียงแค่ต้องการสร้างรายงานอัตโนมัติ คู่มือนี้ถือเป็นส่วนพื้นฐานที่ดี โปรดจำไว้ว่าพลังของ Aspose.PDF สามารถช่วยคุณได้ในหลายๆ งานนอกเหนือจากงานนี้ ดังนั้นอย่าหยุดค้นคว้า!

## คำถามที่พบบ่อย

### รูปแบบไฟล์ใดบ้างที่รองรับรูปภาพใน Aspose.PDF?
Aspose.PDF รองรับรูปแบบภาพต่างๆ รวมถึง JPG, PNG, BMP และ GIF

### ฉันสามารถเปลี่ยนขนาดรูปภาพเมื่อเพิ่มลงใน PDF ได้ไหม?
ใช่ คุณสามารถเปลี่ยนขนาดของภาพที่แสดงใน PDF ได้โดยการปรับพิกัดที่กำหนดไว้ในสี่เหลี่ยมผืนผ้า

### ฉันต้องมีใบอนุญาตเพื่อใช้ Aspose.PDF หรือไม่?
 Aspose เสนอบริการทดลองใช้ฟรีและตัวเลือกการซื้อต่างๆ คุณสามารถค้นหาได้[ที่นี่](https://purchase.aspose.com/buy).

### ฉันจะได้รับการสนับสนุนได้อย่างไรหากประสบปัญหา?
 คุณสามารถขอความช่วยเหลือจากชุมชน Aspose ได้[ที่นี่](https://forum.aspose.com/c/pdf/10).

### มีวิธีการบีบอัดให้กับรูปภาพที่เพิ่มลงใน PDF หรือไม่
ใช่ เมื่อเพิ่มรูปภาพลงใน PDF คุณสามารถระบุประเภทตัวกรองรูปภาพเพื่อใช้การบีบอัด เช่น Flate ได้