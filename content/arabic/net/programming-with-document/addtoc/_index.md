---
title: إضافة جدول المحتويات إلى ملف PDF
linktitle: إضافة جدول المحتويات إلى ملف PDF
second_title: مرجع واجهة برمجة التطبيقات Aspose.PDF لـ .NET
description: تعرف على كيفية إضافة جدول محتويات إلى ملف PDF باستخدام Aspose.PDF لـ .NET. يبسط هذا الدليل خطوة بخطوة العملية ويضمن سهولة التنقل داخل مستنداتك.
type: docs
weight: 40
url: /ar/net/programming-with-document/addtoc/
---
## مقدمة

هل سبق لك أن تصفحت ملف PDF طويلًا دون توقف، متمنيًا أن يحتوي على جدول محتويات منظم جيدًا؟ حسنًا، اليوم هو يومك المحظوظ! في هذا البرنامج التعليمي، ستتعلم كيفية إضافة جدول محتويات إلى ملف PDF الخاص بك باستخدام Aspose.PDF لـ .NET. سواء كنت تعمل على تقرير معقد أو كتاب إلكتروني أو اقتراح عمل، يمكن لجدول المحتويات أن يحول مستندك إلى تحفة فنية احترافية يمكن التنقل فيها.

## المتطلبات الأساسية

قبل أن ننتقل إلى الكود، دعنا نتأكد من أنك حصلت على كل ما تحتاجه:

1. Aspose.PDF لـ .NET: تأكد من تنزيل مكتبة Aspose.PDF وتثبيتها. يمكنك تنزيلها من[هنا](https://releases.aspose.com/pdf/net/).
   
2. بيئة التطوير: تأكد من أن لديك بيئة تطوير .NET مثل Visual Studio مثبتة على جهازك.

3.  الترخيص: إذا لم يكن لديك ترخيص، يمكنك الحصول على نسخة تجريبية مجانية أو طلب ترخيص مؤقت[هنا](https://purchase.aspose.com/temporary-license/).

## استيراد الحزم

للبدء، تأكد من استيراد المساحات الأساسية اللازمة في بداية ملف التعليمات البرمجية الخاص بك. إليك كيفية القيام بذلك:

```csharp
using System.IO;
using System;
using Aspose.Pdf;
using Aspose.Pdf.Text;
```

تتيح لك مساحات الأسماء هذه الوصول إلى وظائف محددة لملف PDF ومعالجة عناصر النص داخل مستندك.

دعنا نقسم هذه المهمة إلى خطوات صغيرة الحجم. سترشدك كل خطوة خلال عملية إنشاء جدول المحتويات وإدراجه في مستند PDF الخاص بك.

## الخطوة 1: تحميل مستند PDF

أول شيء يتعين علينا فعله هو تحميل ملف PDF الموجود حيث نريد إضافة جدول المحتويات.

```csharp
string dataDir = "YOUR DOCUMENT DIRECTORY";
Document doc = new Document(dataDir + "AddTOC.pdf");
```

 في هذه الخطوة، نحدد المسار إلى دليل المستند ونقوم بتحميل ملف PDF باستخدام`Document` الكائن. تأكد من استبدال`"YOUR DOCUMENT DIRECTORY"` مع المسار الفعلي لملفك.

## الخطوة 2: إدراج صفحة جديدة لجدول المحتويات

بعد ذلك، نقوم بإدراج صفحة جديدة في بداية مستند PDF. ستستضيف هذه الصفحة جدول المحتويات.

```csharp
Page tocPage = doc.Pages.Insert(1);
```

من خلال إدراج صفحة جدول المحتويات في البداية، فإننا نضمن ظهورها كأول شيء يراه القراء في ملف PDF.

## الخطوة 3: إنشاء كائن معلومات جدول المحتويات

الآن، لنقم بإنشاء كائن يمثل معلومات جدول المحتويات. وسنضيف أيضًا عنوانًا إلى جدول المحتويات لجعله بارزًا.

```csharp
TocInfo tocInfo = new TocInfo();
TextFragment title = new TextFragment("Table Of Contents");
title.TextState.FontSize = 20;
title.TextState.FontStyle = FontStyles.Bold;
tocInfo.Title = title;
tocPage.TocInfo = tocInfo;
```

هنا، قمنا بتعيين عنوان جدول المحتويات كـ "جدول المحتويات"، وزدنا حجم الخط، وجعلناه غامقًا للتأكيد.

## الخطوة 4: تحديد عناصر جدول المحتويات

في هذه الخطوة، نقوم بتحديد العناصر (أو العناوين) التي سيتم عرضها في جدول المحتويات. ستساعد هذه العناصر القراء على التنقل إلى أقسام معينة من المستند.

```csharp
string[] titles = new string[4];
titles[0] = "First page";
titles[1] = "Second page";
titles[2] = "Third page";
titles[3] = "Fourth page";
```

لقد قمنا بإنشاء مجموعة من السلاسل التي ستكون بمثابة عناصر جدول المحتويات لدينا، والتي تتوافق مع الصفحات المختلفة في ملف PDF.

## الخطوة 5: إنشاء عناوين جدول المحتويات

الآن يأتي الجزء الحاسم - إضافة العناوين إلى جدول المحتويات وربطها بالصفحات الخاصة بها.

```csharp
for (int i = 0; i < 2; i++)
{
    Aspose.Pdf.Heading heading2 = new Aspose.Pdf.Heading(1);
    TextSegment segment2 = new TextSegment();
    heading2.TocPage = tocPage;
    heading2.Segments.Add(segment2);

    heading2.DestinationPage = doc.Pages[i + 2];
    heading2.Top = doc.Pages[i + 2].Rect.Height;
    segment2.Text = titles[i];

    tocPage.Paragraphs.Add(heading2);
}
```

وهذا ما يحدث:
- العنوان: نقوم بإنشاء`Heading` الكائن وإضافة`TextSegment` إليها.
- صفحة الوجهة: قمنا بتعيين الصفحة التي سيرتبط بها كل عنوان.
- الموضع العلوي: نحدد الموضع في الصفحة الذي سيشير إليه العنوان.
- النص: يحصل كل عنوان على عنوانه الخاص من المصفوفة التي أنشأناها سابقًا.

تعمل هذه الحلقة على إنشاء عناوين للعنصرين الأولين في جدول المحتويات وربطهما بالصفحات المقابلة.

## الخطوة 6: احفظ ملف PDF مع جدول المحتويات

أخيرًا، بعد أن أضفنا جميع عناصر جدول المحتويات، حان الوقت لحفظ ملف PDF المحدث.

```csharp
dataDir = dataDir + "TOC_out.pdf";
doc.Save(dataDir);
```

تم الآن حفظ الملف مع إضافة جدول المحتويات إلى ملف PDF. تهانينا - لقد نجحت في إضافة جدول المحتويات!

## الخطوة 7: رسالة التأكيد

لإعلام المستخدم بانتهاء العملية، سنعرض رسالة بسيطة في وحدة التحكم.

```csharp
Console.WriteLine("\nTOC added successfully to an existing PDF.\nFile saved at " + dataDir);
```

## خاتمة

والآن، مع Aspose.PDF for .NET، لا يصبح إضافة جدول المحتويات إلى ملف PDF أمرًا سهلاً فحسب، بل إنه قابل للتخصيص أيضًا. وسواء كنت بحاجة إلى إنشاء روابط تنقل بسيطة أو هياكل معقدة، فإن هذه الأداة ستلبي احتياجاتك. لذا، في المرة القادمة التي تعمل فيها على ملف PDF طويل، لا تنس إضافة جدول المحتويات لإضفاء لمسة احترافية!

## الأسئلة الشائعة

### هل يمكنني تخصيص مظهر جدول المحتويات في Aspose.PDF؟  
نعم، يمكنك تخصيص مظهر جدول المحتويات بالكامل، بما في ذلك نمط الخط وحجمه ومحاذاته.

### كيف أضيف عناوين فرعية إلى جدول المحتويات؟  
 يمكنك إضافة عناوين فرعية عن طريق تعديل`Heading` المستوى (على سبيل المثال،`Heading(2)`) لإنشاء جدول محتويات هرمي.

### هل من الممكن تحديث جدول المحتويات تلقائيًا إذا تغيرت الوثيقة؟  
لا، لن يتم تحديث جدول المحتويات تلقائيًا. ستحتاج إلى إعادة إنشائه إذا تغير هيكل المستند.

### هل يمكنني ربط إدخالات جدول المحتويات بمستندات خارجية؟  
نعم، يمكنك استخدام الارتباطات التشعبية لربط إدخالات جدول المحتويات بملفات PDF أو عناوين URL الخارجية.

### هل يدعم Aspose.PDF جداول المحتويات متعددة المستويات؟  
نعم، يدعم Aspose.PDF جداول المحتويات متعددة المستويات للمستندات المعقدة التي تحتوي على أقسام فرعية.