---
title: หมายเลขหน้าในส่วนท้ายของส่วนหัวโดยใช้กล่องลอย
linktitle: หมายเลขหน้าในส่วนท้ายของส่วนหัวโดยใช้กล่องลอย
second_title: Aspose.PDF สำหรับการอ้างอิง .NET API
description: เรียนรู้วิธีเพิ่มหมายเลขหน้าในส่วนหัวและส่วนท้ายของเอกสาร PDF ด้วย Aspose.PDF สำหรับ .NET
type: docs
weight: 150
url: /th/net/programming-with-stamps-and-watermarks/page-number-in-header-footer-using-floating-box/
---
ในบทช่วยสอนนี้ เราจะแนะนำคุณทีละขั้นตอนเกี่ยวกับวิธีเพิ่มหมายเลขหน้าในส่วนหัวและส่วนท้ายของเอกสาร PDF โดยใช้ FloatingBox กับ Aspose.PDF สำหรับ .NET เราจะใช้ซอร์สโค้ด C# ที่ให้มาเพื่อสร้างเอกสาร PDF เพิ่มหน้า สร้าง FloatingBox กำหนดตำแหน่งและเพิ่มหมายเลขหน้า จากนั้นบันทึกเอกสาร PDF ที่แก้ไข

## ขั้นตอนที่ 1: การตั้งค่าสภาพแวดล้อม

ก่อนที่คุณจะเริ่มต้น ตรวจสอบให้แน่ใจว่าคุณมีสิ่งต่อไปนี้:

- สภาพแวดล้อมการพัฒนา .NET ที่ติดตั้งไว้
- ไลบรารี Aspose.PDF สำหรับ .NET ดาวน์โหลดและอ้างอิงในโครงการของคุณ

## ขั้นตอนที่ 2: การสร้างเอกสาร PDF และเพิ่มหน้า

ขั้นตอนแรกคือการสร้างอินสแตนซ์ของเอกสาร PDF และเพิ่มหน้าเข้าไป มีวิธีดังนี้:

```csharp
// เส้นทางไปยังไดเร็กทอรีเอกสาร
string dataDir = "YOUR DOCUMENTS DIRECTORY";

// สร้างอินสแตนซ์เอกสาร PDF
Aspose.Pdf.Document pdf = new Aspose.Pdf.Document();

// เพิ่มหน้าลงในเอกสาร PDF
Aspose.Pdf.Page page = pdf.Pages.Add();
```

อย่าลืมแทนที่ "ไดเรกทอรีเอกสารของคุณ" ด้วยเส้นทางจริงไปยังไดเรกทอรีที่คุณต้องการบันทึกเอกสาร PDF

## ขั้นตอนที่ 3: การสร้าง FloatingBox และเพิ่มหมายเลขหน้า

เมื่อเพิ่มหน้าลงในเอกสาร PDF แล้ว เราสามารถสร้าง FloatingBox กำหนดตำแหน่ง และเพิ่มหมายเลขหน้าลงไปได้ มีวิธีดังนี้:

```csharp
// สร้าง FloatingBox ที่มีความกว้าง 140 และความสูง 80
Aspose.Pdf.FloatingBox box1 = new Aspose.Pdf.FloatingBox(140, 80);

// กำหนดตำแหน่งด้านซ้ายของย่อหน้า
box1. Left = 2;

// ตั้งค่าตำแหน่งบนสุดของย่อหน้า
box1. Top = 10;

// เพิ่มหมายเลขหน้าลงใน FloatingBox
box1.Paragraphs.Add(new Aspose.Pdf.Text.TextFragment("Page: ($p/ $P )"));

// เพิ่ม FloatingBox ลงในเพจ
page.Paragraphs.Add(box1);
```

โค้ดด้านบนสร้าง FloatingBox ที่มีความกว้าง 140 และความสูง 80 ต่อไป เราจะกำหนดตำแหน่งโดยการระบุค่าด้านซ้ายและด้านบน สุดท้ายนี้ เราเพิ่มหมายเลขหน้าลงใน FloatingBox โดยใช้ TextFragment ที่มีไวยากรณ์ "($p/ $P )" ซึ่งจะถูกแทนที่ด้วยหมายเลขหน้าปัจจุบันและจำนวนหน้าทั้งหมด

## ขั้นตอนที่ 4: บันทึกเอกสาร PDF ที่แก้ไข

เมื่อเพิ่มหมายเลขหน้าลงในส่วนหัวหรือส่วนท้ายโดยใช้ FloatingBox แล้ว เราก็สามารถบันทึกเอกสาร PDF ที่แก้ไขแล้วได้ มีวิธีดังนี้:

```csharp
// บันทึกเอกสาร PDF ที่แก้ไข
pdf.Save(dataDir + "PageNumberinHeaderFooterUsingFloatingBox_out.pdf");
```

โค้ดด้านบนจะบันทึกเอกสาร PDF ที่แก้ไขแล้วไปยังไดเร็กทอรีที่ระบุ

### ตัวอย่างซอร์สโค้ดสำหรับ Page Numberin Header Footer โดยใช้ Floating Box โดยใช้ Aspose.PDF สำหรับ .NET 
```csharp

// เส้นทางไปยังไดเร็กทอรีเอกสาร
string dataDir = "YOUR DOCUMENT DIRECTORY";

// สร้างอินสแตนซ์เอกสาร
Aspose.Pdf.Document pdf = new Aspose.Pdf.Document();

// เพิ่มหน้าลงในเอกสาร pdf
Aspose.Pdf.Page page = pdf.Pages.Add();

//เตรียมใช้งานอินสแตนซ์ใหม่ของคลาส FloatingBox
Aspose.Pdf.FloatingBox box1 = new Aspose.Pdf.FloatingBox(140, 80);

// ค่าทศนิยมที่ระบุตำแหน่งด้านซ้ายของย่อหน้า
box1.Left = 2;

// ค่าลอยตัวที่ระบุตำแหน่งบนสุดของย่อหน้า
box1.Top = 10;

// เพิ่มมาโครลงในคอลเลกชันย่อหน้าของ FloatingBox
box1.Paragraphs.Add(new Aspose.Pdf.Text.TextFragment("Page: ($p/ $P )"));

// เพิ่ม FloatingBox ให้กับเพจ
page.Paragraphs.Add(box1);

// บันทึกเอกสาร
pdf.Save(dataDir + "PageNumberinHeaderFooterUsingFloatingBox_out.pdf");

```

## บทสรุป

ขอแสดงความยินดี! คุณได้เรียนรู้วิธีเพิ่มหมายเลขหน้าในส่วนหัวและส่วนท้ายของเอกสาร PDF โดยใช้ FloatingBox กับ Aspose.PDF สำหรับ .NET ตอนนี้คุณสามารถปรับแต่งส่วนหัวและส่วนท้ายของคุณได้โดยการเพิ่มข้อมูลแบบไดนามิก เช่น หมายเลขหน้า

### คำถามที่พบบ่อย

#### ถาม: FloatingBox คืออะไร และใช้ในการเพิ่มหมายเลขหน้าในส่วนหัวหรือส่วนท้ายของเอกสาร PDF ได้อย่างไร

ตอบ: FloatingBox เป็นองค์ประกอบเค้าโครงอเนกประสงค์ใน Aspose.PDF ที่สามารถเก็บเนื้อหาได้หลากหลาย รวมถึงข้อความและรูปภาพ ในบทช่วยสอนนี้ ใช้เพื่อสร้างคอนเทนเนอร์สำหรับหมายเลขหน้า ซึ่งช่วยให้คุณสามารถแทรกหมายเลขหน้าปัจจุบันและจำนวนหน้าทั้งหมดลงในส่วนหัวหรือส่วนท้ายแบบไดนามิกได้

#### ถาม: ซอร์สโค้ด C# ที่ให้มาสามารถเพิ่มหมายเลขหน้าโดยใช้ FloatingBox ได้อย่างไร

ตอบ: ข้อมูลโค้ดสาธิตวิธีการสร้างเอกสาร PDF, เพิ่มหน้า, สร้าง FloatingBox, กำหนดตำแหน่งภายในหน้า และแทรกหมายเลขหน้าโดยใช้ TextFragment ไวยากรณ์ "($p/ $P )" ใน TextFragment จะถูกแทนที่ด้วยหมายเลขหน้าปัจจุบันและจำนวนหน้าทั้งหมด

#### ถาม: ฉันสามารถปรับแต่งลักษณะที่ปรากฏและการจัดรูปแบบของหมายเลขหน้าที่เพิ่มโดยใช้ FloatingBox ได้หรือไม่

ตอบ: ได้ คุณสามารถปรับแต่งลักษณะที่ปรากฏของหมายเลขหน้าได้โดยการแก้ไขคุณสมบัติของ TextFragment ภายใน FloatingBox คุณสามารถเปลี่ยนขนาดแบบอักษร สี สไตล์ การจัดตำแหน่ง และตัวเลือกการจัดรูปแบบอื่นๆ ได้

#### ถาม: เป็นไปได้หรือไม่ที่จะเพิ่มองค์ประกอบไดนามิกต่างๆ เช่น วันที่และเวลา ลงในส่วนหัวหรือส่วนท้ายโดยใช้แนวทางที่คล้ายกัน

ตอบ: แน่นอน คุณสามารถเพิ่มองค์ประกอบไดนามิกต่างๆ เช่น วันที่ เวลา ข้อมูลเมตาของเอกสาร หรือข้อความที่กำหนดเองได้โดยการแก้ไขเนื้อหา TextFragment ภายใน FloatingBox คุณสามารถใช้มาโคร เช่น "($p/ $P )" สำหรับหมายเลขหน้า หรือ "($date)" สำหรับวันที่ปัจจุบัน

#### ถาม: ฉันจะระบุตำแหน่งของ FloatingBox ภายในส่วนหัวหรือส่วนท้ายได้อย่างไร
 ตอบ: รหัสที่ให้มาจะกำหนดตำแหน่งของ FloatingBox โดยใช้`Left` และ`Top` คุณสมบัติ. คุณสามารถปรับค่าเหล่านี้เพื่อวางตำแหน่ง FloatingBox ได้ตามต้องการภายในส่วนหัวหรือส่วนท้าย

#### ถาม: ฉันสามารถใช้แบบอักษรหรือสไตล์อื่นสำหรับหมายเลขหน้าในส่วนหัวหรือส่วนท้ายได้หรือไม่

ตอบ: ได้ คุณสามารถปรับแต่งแบบอักษร สไตล์ และคุณสมบัติการจัดรูปแบบอื่นๆ ของข้อความหมายเลขหน้าได้โดยการแก้ไขคุณสมบัติ TextFragment ภายใน FloatingBox

#### ถาม: จะเกิดอะไรขึ้นหากเนื้อหาใน FloatingBox มีขนาดเกินขนาด

ตอบ: หากเนื้อหาภายใน FloatingBox มีขนาดเกินขนาด อาจถูกตัดออกหรืออาจเกิดปัญหาเค้าโครงขึ้น ตรวจสอบให้แน่ใจว่าขนาดของ FloatingBox เหมาะสมสำหรับการรองรับเนื้อหา และพิจารณาปรับเค้าโครงหน้าหากจำเป็น

#### ถาม: เป็นไปได้ไหมที่จะเพิ่ม FloatingBoxes หลายอันที่มีเนื้อหาต่างกันที่ส่วนหัวหรือส่วนท้ายของหน้าเดียวกัน

ตอบ: ได้ คุณสามารถเพิ่ม FloatingBoxes หลายอันที่มีเนื้อหาต่างกันไปที่ส่วนหัวหรือส่วนท้ายของหน้าเดียวกันได้โดยการสร้างอินสแตนซ์ FloatingBox แยกกัน และเพิ่มลงในคอลเลกชัน Paragraphs ของเพจ

#### ถาม: ฉันสามารถใช้วิธี FloatingBox เพื่อเพิ่มเนื้อหาไปยังส่วนอื่นๆ ของเอกสาร PDF เช่น เนื้อความหรือระยะขอบได้หรือไม่

ตอบ: แม้ว่า FloatingBoxes มักใช้สำหรับส่วนหัวและส่วนท้าย แต่คุณยังสามารถใช้เพื่อเพิ่มเนื้อหาไปยังส่วนอื่นๆ ของเอกสาร PDF เช่น เนื้อความหรือระยะขอบ โดยการวางตำแหน่งตามนั้นภายในหน้า