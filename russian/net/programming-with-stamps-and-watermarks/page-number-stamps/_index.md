---
title: Штампы номеров страниц в файле PDF
linktitle: Штампы номеров страниц в файле PDF
second_title: Aspose.PDF для справочника API .NET
description: Узнайте, как добавить штампы с номерами страниц в файл PDF с помощью Aspose.PDF для .NET.
type: docs
weight: 160
url: /ru/net/programming-with-stamps-and-watermarks/page-number-stamps/
---
В этом руководстве мы шаг за шагом расскажем вам, как добавить штампы с номерами страниц в файл PDF с помощью Aspose.PDF для .NET. Мы будем использовать предоставленный исходный код C#, чтобы открыть существующий PDF-документ, создать штамп номера страницы, задать его свойства и добавить его на определенную страницу в PDF-файле.

## Шаг 1. Настройка среды

Прежде чем начать, убедитесь, что у вас есть следующее:

- Установленная среда разработки .NET.
- Библиотека Aspose.PDF для .NET загружена и указана в вашем проекте.

## Шаг 2: Загрузка существующего документа PDF

Первым шагом является загрузка существующего документа PDF в ваш проект. Вот как:

```csharp
// Путь к каталогу документов.
string dataDir = "YOUR DOCUMENTS DIRECTORY";

// Откройте существующий PDF-документ
Document pdfDocument = new Document(dataDir + "PageNumberStamp.pdf");
```

Обязательно замените «КАТАЛОГ ВАШИХ ДОКУМЕНТОВ» на фактический путь к каталогу, в котором находится ваш PDF-документ.

## Шаг 3: Создание и настройка штампа нумерации страниц

Теперь, когда документ PDF загружен, мы можем создать буфер нумерации страниц и настроить его в соответствии с нашими потребностями. Вот как:

```csharp
// Создать буфер номеров страниц
PageNumberStamp pageNumberStamp = new PageNumberStamp();

// Определите, находится ли буфер в фоновом режиме или нет
pageNumberStamp.Background = false;

// Формат буфера нумерации страниц
pageNumberStamp.Format = "Page # of " + pdfDocument.Pages.Count;

// Нижнее поле буфера нумерации страниц
pageNumberStamp.BottomMargin = 10;

// Горизонтальное выравнивание буфера нумерации страниц
pageNumberStamp.HorizontalAlignment = HorizontalAlignment.Center;

// Начальный номер нумерации страниц
pageNumberStamp.StartingNumber = 1;

// Установить свойства текста буфера номера страницы
pageNumberStamp.TextState.Font = FontRepository.FindFont("Arial");
pageNumberStamp.TextState.FontSize = 14.0F;
pageNumberStamp.TextState.FontStyle = FontStyles.Bold;
pageNumberStamp.TextState.FontStyle = FontStyles.Italic;
pageNumberStamp.TextState.ForegroundColor = Color.Aqua;
```

Приведенный выше код создает штамп номера страницы с такими свойствами, как формат номера страницы, нижнее поле, горизонтальное выравнивание, начальный номер и свойства текста.

## Шаг 4. Добавление штампа номера страницы на определенную страницу

После настройки штампа номера страницы мы можем добавить его на определенную страницу документа PDF. Вот как:

```csharp
// Добавить буфер номеров страниц на определенную страницу
pdfDocument.Pages[1].AddStamp(pageNumberStamp);
```

Приведенный выше код добавляет штамп номера страницы на первую страницу документа PDF. При необходимости вы можете изменить номер страницы.

## Шаг 5: Сохранение измененного PDF-документа

После добавления штампа номера страницы в документ PDF мы можем сохранить измененный документ PDF. Вот как:

```csharp
// Сохраните измененный PDF-документ
pdfDocument.Save(dataDir + "PageNumberStamp_out.pdf");
```

Обязательно замените «КАТАЛОГ ВАШИХ ДОКУМЕНТОВ» на фактический путь к каталогу, в котором вы хотите сохранить отредактированный PDF-документ.

### Пример исходного кода для штампов номеров страниц с использованием Aspose.PDF для .NET 
```csharp

// Путь к каталогу документов.
string dataDir = "YOUR DOCUMENT DIRECTORY";

// Открыть документ
Document pdfDocument = new Document(dataDir+ "PageNumberStamp.pdf");

// Создать штамп с номером страницы
PageNumberStamp pageNumberStamp = new PageNumberStamp();

// Является ли штамп фоном
pageNumberStamp.Background = false;
pageNumberStamp.Format = "Page # of " + pdfDocument.Pages.Count;
pageNumberStamp.BottomMargin = 10;
pageNumberStamp.HorizontalAlignment = HorizontalAlignment.Center;
pageNumberStamp.StartingNumber = 1;

// Установить свойства текста
pageNumberStamp.TextState.Font = FontRepository.FindFont("Arial");
pageNumberStamp.TextState.FontSize = 14.0F;
pageNumberStamp.TextState.FontStyle = FontStyles.Bold;
pageNumberStamp.TextState.FontStyle = FontStyles.Italic;
pageNumberStamp.TextState.ForegroundColor = Color.Aqua;

// Добавить штамп на определенную страницу
pdfDocument.Pages[1].AddStamp(pageNumberStamp);
dataDir = dataDir + "PageNumberStamp_out.pdf";

// Сохранить выходной документ
pdfDocument.Save(dataDir);
Console.WriteLine("\nPage number stamp added successfully.\nFile saved at " + dataDir);

```

## Заключение

Поздравляем! Вы узнали, как добавлять штампы с номерами страниц в документ PDF с помощью Aspose.PDF для .NET. Теперь вы можете персонализировать свои PDF-документы, добавляя четкие и информативные номера страниц.

### Часто задаваемые вопросы о штампах с номерами страниц в файле PDF

#### В: Что такое штамп номера страницы и как он используется для добавления номеров страниц в файл PDF?

О: Штамп номера страницы — это функция в Aspose.PDF, которая позволяет добавлять динамические номера страниц к определенным страницам документа PDF. В этом руководстве это достигается путем создания объекта PageNumberStamp, настройки его свойств и добавления его на назначенную страницу.

#### Вопрос. Как в предоставленном исходном коде C# выполняется добавление штампов с номерами страниц в файл PDF?

О: В коде показано, как загрузить существующий документ PDF, создать PageNumberStamp, задать различные свойства (такие как формат, шрифт, выравнивание и т. д.), а затем добавить штамп на определенную страницу. Штамп автоматически подсчитывает общее количество страниц и вставляет правильные номера страниц.

#### В: Можно ли настроить внешний вид номера страницы, например стиль шрифта, цвет и размер?

О: Конечно, вы можете настроить внешний вид штампа с номером страницы, изменив такие свойства, как шрифт, размер шрифта, стиль шрифта (полужирный, курсив и т. д.) и цвет текста.

#### В: Можно ли добавлять штампы с номерами страниц на несколько страниц документа PDF?

О: Да, вы можете добавлять штампы с номерами страниц на несколько страниц, создавая несколько объектов PageNumberStamp и добавляя каждый из них на нужные страницы.

#### В: Могу ли я выбрать, будет ли штамп с номером страницы отображаться как часть содержимого страницы или как фоновый элемент?

 О: Да, вы можете указать, будет ли штамп с номером страницы отображаться как часть содержимого страницы или как фоновый элемент, установив параметр`Background` свойство PageNumberStamp.

#### В: Как указать формат номера страницы, включая общее количество страниц?

 A: Код использует`Format`свойство PageNumberStamp, чтобы указать формат номера страницы. Макрос "# из" используется для представления общего количества страниц.

#### В: Что произойдет, если я добавлю один и тот же штамп с номером страницы на несколько страниц?

О: При добавлении одного и того же экземпляра PageNumberStamp на несколько страниц будут отображаться правильные номера страниц для каждой страницы. Штамп автоматически корректирует номер страницы и общее количество страниц.

#### Вопрос. Можно ли добавлять штампы с номерами страниц в разделы верхнего или нижнего колонтитула PDF-документа?

О: Хотя PageNumberStamps обычно добавляются непосредственно к содержимому страницы, вы можете использовать FloatingBox или другие методы, чтобы расположить их в разделах верхнего или нижнего колонтитула.

#### В: Как указать положение штампа номера страницы на странице?

 А:`BottomMargin` и`HorizontalAlignment` свойства PageNumberStamp позволяют управлять положением штампа на странице.

#### В: Что делать, если я хочу начать нумерацию страниц с другого номера, а не с 1?

 О: Вы можете установить`StartingNumber`свойство PageNumberStamp для указания номера начальной страницы.