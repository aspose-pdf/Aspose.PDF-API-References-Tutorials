---
title: แทนที่ข้อความในนิพจน์ทั่วไปในไฟล์ PDF
linktitle: แทนที่นิพจน์ปกติของ Texton ในไฟล์ PDF
second_title: เอกสารอ้างอิง Aspose.PDF สำหรับ API ของ .NET
description: เรียนรู้วิธีการแทนที่ข้อความตามนิพจน์ทั่วไปในไฟล์ PDF โดยใช้ Aspose.PDF สำหรับ .NET ปฏิบัติตามคำแนะนำทีละขั้นตอนของเราเพื่อดำเนินการเปลี่ยนแปลงข้อความโดยอัตโนมัติอย่างมีประสิทธิภาพ
type: docs
weight: 360
url: /th/net/programming-with-text/replace-text-on-regular-expression/
---
## การแนะนำ

Aspose.PDF สำหรับ .NET เป็นเครื่องมือที่น่าทึ่งที่ช่วยให้นักพัฒนาสามารถจัดการไฟล์ PDF ได้อย่างง่ายดาย หนึ่งในคุณสมบัติที่ทรงพลังของเครื่องมือนี้คือความสามารถในการค้นหาข้อความตามนิพจน์ทั่วไปและแทนที่ข้อความนั้น หากคุณเคยต้องจัดการกับ PDF ที่ต้องเปลี่ยนรูปแบบข้อความเฉพาะ เช่น วันที่ หมายเลขโทรศัพท์ หรือรหัส นี่คือสิ่งที่คุณกำลังมองหา ในบทช่วยสอนนี้ ฉันจะแนะนำคุณตลอดกระบวนการแทนที่ข้อความโดยใช้นิพจน์ทั่วไปในไฟล์ PDF เราจะแบ่งขั้นตอนเหล่านี้ออกเป็นขั้นตอนที่ทำตามได้ง่าย เพื่อให้คุณผสานฟังก์ชันนี้เข้ากับโปรเจ็กต์ของคุณได้อย่างราบรื่น

## ข้อกำหนดเบื้องต้น

ก่อนที่จะเจาะลึกโค้ด โปรดตรวจสอบให้แน่ใจว่าคุณได้ตั้งค่าทุกอย่างเรียบร้อยแล้ว:

1.  Aspose.PDF สำหรับ .NET: คุณจะต้องมี Aspose.PDF สำหรับ .NET เวอร์ชันล่าสุด คุณสามารถดาวน์โหลดได้[ที่นี่](https://releases.aspose.com/pdf/net/).
2. IDE: Visual Studio หรือ Integrated Development Environment (IDE) อื่นๆ ที่เข้ากันได้กับ .NET
3. .NET Framework: ตรวจสอบให้แน่ใจว่าคุณได้ติดตั้ง .NET Framework 4.0 หรือใหม่กว่าแล้ว
4. เอกสาร PDF: ไฟล์ PDF ตัวอย่างที่คุณต้องการค้นหาและแทนที่ข้อความ

เมื่อคุณเตรียมทุกอย่างลงตัวแล้ว คุณก็พร้อมที่จะเริ่มต้นได้เลย!

## แพ็คเกจนำเข้า

สิ่งแรกที่เราต้องทำคือการนำเข้าแพ็คเกจที่จำเป็น วิธีนี้จะช่วยให้เราสามารถเข้าถึงคลาสและวิธีการที่จำเป็นทั้งหมดจาก Aspose.PDF ได้

```csharp
using System.IO;
using Aspose.Pdf;
using Aspose.Pdf.Text;
using System;
```

สิ่งนี้ช่วยให้เราทำงานกับเอกสาร PDF และจัดการส่วนข้อความภายในเอกสารได้

ตอนนี้มาดูขั้นตอนต่างๆ กันทีละขั้นตอน ทำตามขณะที่เราสร้างการแทนที่ข้อความตามนิพจน์ทั่วไป

## ขั้นตอนที่ 1: โหลดเอกสาร PDF

 ขั้นแรก คุณต้องโหลดเอกสาร PDF ที่คุณจะใช้ในการแทนที่ข้อความ ซึ่งทำได้โดยใช้`Document` คลาสจาก Aspose.PDF

```csharp
string dataDir = "YOUR DOCUMENT DIRECTORY";
Document pdfDocument = new Document(dataDir + "SearchRegularExpressionPage.pdf");
```

 ในขั้นตอนนี้ให้แทนที่`"YOUR DOCUMENT DIRECTORY"`ด้วยเส้นทางจริงที่จัดเก็บไฟล์ PDF ของคุณ รหัสนี้จะเปิด PDF และโหลดลงใน`pdfDocument` วัตถุที่เราจะจัดการในขั้นตอนถัดไป

## ขั้นตอนที่ 2: กำหนดนิพจน์ทั่วไป

 ตอนนี้คุณได้โหลดเอกสารแล้ว ขั้นตอนต่อไปคือการกำหนดนิพจน์ทั่วไปที่จะค้นหารูปแบบข้อความที่คุณสนใจ ตัวอย่างเช่น หากคุณต้องการแทนที่ช่วงปี เช่น "1999-2000" คุณสามารถใช้นิพจน์ทั่วไปได้`\d{4}-\d{4}`.

```csharp
TextFragmentAbsorber textFragmentAbsorber = new TextFragmentAbsorber("\\d{4}-\\d{4}"); 
```

 เส้นนี้ตั้งขึ้นเป็น`TextFragmentAbsorber` ซึ่งจะค้นหาตัวเลขสี่หลักตามด้วยเครื่องหมายขีดกลาง จากนั้นจึงตามด้วยตัวเลขสี่หลักอีกตัวหนึ่ง คุณสามารถปรับเปลี่ยนนิพจน์ทั่วไปตามต้องการเพื่อให้ตรงกับกรณีการใช้งานเฉพาะของคุณ

## ขั้นตอนที่ 3: เปิดใช้งานตัวเลือกการค้นหานิพจน์ทั่วไป

 Aspose.PDF ช่วยให้คุณปรับแต่งวิธีการค้นหาข้อความได้อย่างละเอียด ในกรณีนี้ เราจะเปิดใช้งานการจับคู่นิพจน์ทั่วไปโดยใช้`TextSearchOptions` ระดับ.

```csharp
TextSearchOptions textSearchOptions = new TextSearchOptions(true);
textFragmentAbsorber.TextSearchOptions = textSearchOptions;
```

 โดยการตั้งค่าตัวเลือกนี้เป็น`true`คุณเปิดใช้งานการใช้นิพจน์ทั่วไปสำหรับการค้นหาภายใน PDF

## ขั้นตอนที่ 4: ติดแผ่นดูดซับลงบนหน้าที่ต้องการ

 ต่อไปเราจะใช้`TextFragmentAbsorber` นำไปใช้กับหน้าใดหน้าหนึ่งของเอกสาร ตัวอย่างนี้ใช้กับหน้าแรก

```csharp
pdfDocument.Pages[1].Accept(textFragmentAbsorber);
```

วิธีการนี้จะแยกข้อความทั้งหมดที่ตรงกับนิพจน์ทั่วไปจากหน้าแรกของเอกสาร หากคุณต้องการค้นหาทั้งเอกสาร คุณสามารถวนซ้ำผ่านหน้าทั้งหมดได้

## ขั้นตอนที่ 5: วนซ้ำและแทนที่ข้อความ

ตอนนี้มาถึงส่วนสนุก ๆ แล้ว เราจะวนซ้ำผ่านส่วนข้อความที่แยกออกมา แทนที่ข้อความ และปรับแต่งคุณสมบัติต่าง ๆ เช่น ขนาดแบบอักษร ประเภทของแบบอักษร และสี

```csharp
TextFragmentCollection textFragmentCollection = textFragmentAbsorber.TextFragments;

foreach (TextFragment textFragment in textFragmentCollection)
{
    textFragment.Text = "New Phrase"; // แทนที่ด้วยข้อความใหม่ของคุณ
    textFragment.TextState.Font = FontRepository.FindFont("Verdana");
    textFragment.TextState.FontSize = 22;
    textFragment.TextState.ForegroundColor = Aspose.Pdf.Color.FromRgb(System.Drawing.Color.Blue);
    textFragment.TextState.BackgroundColor = Aspose.Pdf.Color.FromRgb(System.Drawing.Color.Green);
}
```

 ที่นี่ คุณกำลังวนซ้ำผ่านแต่ละส่วนของข้อความที่ตรงกับนิพจน์ทั่วไป สำหรับแต่ละข้อความที่ตรงกัน ข้อความจะถูกแทนที่ด้วย`"New Phrase"`คุณยังสามารถปรับแต่งแบบอักษรเป็น "Verdana" ตั้งขนาดแบบอักษรเป็น 22 และเปลี่ยนแปลงข้อความและสีพื้นหลัง

## ขั้นตอนที่ 6: บันทึกเอกสาร PDF ที่อัปเดต

เมื่อคุณทำการเปลี่ยนแปลงทั้งหมดเสร็จแล้ว ก็ถึงเวลาบันทึกเอกสาร PDF ที่แก้ไขแล้ว

```csharp
dataDir = dataDir + "ReplaceTextonRegularExpression_out.pdf";
pdfDocument.Save(dataDir);
```

การดำเนินการนี้จะบันทึก PDF ที่อัปเดตพร้อมข้อความทั้งหมดแทนที่เป็นไฟล์ใหม่ชื่อ`ReplaceTextonRegularExpression_out.pdf`.

## ขั้นตอนที่ 7: ตรวจสอบการเปลี่ยนแปลง

สุดท้ายเพื่อยืนยันว่าทุกอย่างทำงาน ให้พิมพ์ข้อความไปยังคอนโซล:

```csharp
Console.WriteLine("\nText replaced successfully based on a regular expression.\nFile saved at " + dataDir);
```

ข้อความนี้จะยืนยันว่ากระบวนการแทนที่ข้อความเสร็จสมบูรณ์ และแสดงตำแหน่งที่บันทึก PDF ใหม่

## บทสรุป

คุณได้แทนที่ข้อความในไฟล์ PDF ที่อิงตามนิพจน์ทั่วไปสำเร็จแล้วโดยใช้ Aspose.PDF สำหรับ .NET! ไม่ว่าคุณจะกำลังดำเนินการประมวลผลเอกสารอัตโนมัติหรือเพียงแค่ลบข้อมูลที่ล้าสมัยออกไป ฟีเจอร์นี้ก็มีประสิทธิภาพอย่างเหลือเชื่อ ด้วยโค้ดเพียงไม่กี่บรรทัด คุณสามารถเปลี่ยนแปลงข้อความที่ซับซ้อนในเอกสารขนาดใหญ่ได้ภายในไม่กี่วินาที

## คำถามที่พบบ่อย

### ฉันสามารถใช้นิพจน์ทั่วไปหลายรายการในเอกสารเดียวได้ไหม
 ใช่ คุณสามารถสร้างได้หลายรายการ`TextFragmentAbsorber` วัตถุแต่ละอันมีนิพจน์ทั่วไปต่างกัน และนำมาใช้กับเอกสาร

### Aspose.PDF สำหรับ .NET เข้ากันได้กับ .NET Core หรือไม่
ใช่ Aspose.PDF สำหรับ .NET รองรับทั้ง .NET Framework และ .NET Core

### ฉันสามารถแทนที่ข้อความในหลายหน้าในครั้งเดียวได้ไหม
แน่นอน! แทนที่จะใช้ตัวดูดซับกับหน้าเดียว คุณสามารถวนซ้ำผ่านหน้าทั้งหมดหรือแม้แต่ใช้กับเอกสารทั้งหมดพร้อมกันก็ได้

### หากฉันต้องการค้นหาข้อความที่ไม่คำนึงถึงตัวพิมพ์เล็ก/ใหญ่จะทำอย่างไร
คุณสามารถปรับเปลี่ยนนิพจน์ทั่วไปเพื่อให้ไม่คำนึงถึงตัวพิมพ์เล็กหรือใหญ่ได้ด้วยการใช้แฟล็กนิพจน์ทั่วไปที่เหมาะสมหรือปรับแต่งตัวเลือกการค้นหา

### ฉันสามารถแทนที่รูปภาพในไฟล์ PDF ได้หรือไม่?
ใช่ Aspose.PDF สำหรับ .NET ยังรองรับการแทนที่รูปภาพและการจัดการภายในเอกสาร PDF ด้วย