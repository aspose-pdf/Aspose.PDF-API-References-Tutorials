---
title: ลงนามดิจิทัลพร้อมประทับเวลาในไฟล์ PDF
linktitle: ลงนามดิจิทัลพร้อมประทับเวลาในไฟล์ PDF
second_title: เอกสารอ้างอิง Aspose.PDF สำหรับ API ของ .NET
description: เรียนรู้วิธีการดำเนินการลายเซ็นดิจิทัลพร้อมประทับเวลาในไฟล์ PDF โดยใช้ Aspose.PDF สำหรับ .NET
type: docs
weight: 50
url: /th/net/programming-with-security-and-signatures/digitally-sign-with-time-stamp/
---
ในบทช่วยสอนนี้ เราจะแนะนำคุณเกี่ยวกับกระบวนการลงนามดิจิทัลในไฟล์ PDF พร้อมประทับเวลาโดยใช้ Aspose.PDF สำหรับ .NET ลายเซ็นดิจิทัลพร้อมประทับเวลาช่วยรับประกันความถูกต้องและความสมบูรณ์ของเอกสารโดยการเพิ่มลายนิ้วมืออิเล็กทรอนิกส์พร้อมประทับเวลา

## ขั้นตอนที่ 1: ข้อกำหนดเบื้องต้น

ก่อนที่คุณจะเริ่มต้น โปรดตรวจสอบให้แน่ใจว่าคุณมีข้อกำหนดเบื้องต้นดังต่อไปนี้:

- ความรู้พื้นฐานเกี่ยวกับภาษาการเขียนโปรแกรม C#
- การติดตั้ง Visual Studio บนเครื่องของคุณ
- ติดตั้งไลบรารี Aspose.PDF สำหรับ .NET แล้ว

## ขั้นตอนที่ 2: การตั้งค่าสภาพแวดล้อม

ในการเริ่มต้น ให้ทำตามขั้นตอนเหล่านี้เพื่อตั้งค่าสภาพแวดล้อมการพัฒนาของคุณ:

1. เปิด Visual Studio และสร้างโปรเจ็กต์ C# ใหม่
2. นำเข้าเนมสเปซที่จำเป็นลงในไฟล์โค้ดของคุณ:

```csharp
using Aspose.Pdf;
using Aspose.Pdf.Forms;
```

## ขั้นตอนที่ 3: ลายเซ็นดิจิทัลพร้อมประทับเวลา

ขั้นตอนแรกคือดำเนินการลงนามดิจิทัลพร้อมประทับเวลาในไฟล์ PDF โค้ดที่ให้มาจะแสดงวิธีการบรรลุลายเซ็นนี้ด้วย Aspose.PDF สำหรับ .NET

```csharp
string dataDir = "YOUR DOCUMENTS DIRECTORY";
string pfxFile = "";
using (Document document = new Document(dataDir + @"DigitallySign.pdf"))
{
     using (PdfFileSignature signature = new PdfFileSignature(document))
     {
         PKCS7 pkcs = new PKCS7(pfxFile, "pfx_password");
         TimestampSettings timestampSettings = new TimestampSettings("https:\\your_timestamp_settings", "user:password");
         pkcs. TimestampSettings = timestampSettings;
         System.Drawing.Rectangle rect = new System.Drawing.Rectangle(100, 100, 200, 100);
         signature.Sign(1, "Reason for signing", "Contact", "Location", true, rect, pkcs);
         signature.Save(dataDir + "DigitallySignWithTimeStamp_out.pdf");
     }
}
```

โค้ดนี้จะโหลดไฟล์ PDF สร้างลายเซ็นดิจิทัลพร้อมค่าประทับเวลาโดยใช้ไฟล์ PFX (คีย์ส่วนตัว) และพารามิเตอร์ค่าประทับเวลาที่ระบุ จากนั้นลายเซ็นจะถูกเพิ่มลงในไฟล์ PDF และบันทึกด้วยคำต่อท้าย "-ออก".

### ตัวอย่างโค้ดต้นฉบับสำหรับการลงนามแบบดิจิทัลพร้อมประทับเวลาโดยใช้ Aspose.PDF สำหรับ .NET 
```csharp
// เส้นทางไปยังไดเร็กทอรีเอกสาร
string dataDir = "YOUR DOCUMENTS DIRECTORY";
string pfxFile = "";
using (Document document = new Document(dataDir + @"DigitallySign.pdf"))
{
	using (PdfFileSignature signature = new PdfFileSignature(document))
	{
		PKCS7 pkcs = new PKCS7(pfxFile, "pfx_password");
		TimestampSettings timestampSettings = new TimestampSettings("https:\\your_timestamp_settings", "user:password"); // สามารถละเว้นชื่อผู้ใช้/รหัสผ่านได้
		pkcs.TimestampSettings = timestampSettings;
		System.Drawing.Rectangle rect = new System.Drawing.Rectangle(100, 100, 200, 100);
		// สร้างลายเซ็นประเภทใดประเภทหนึ่งจากสามประเภท
		signature.Sign(1, "Signature Reason", "Contact", "Location", true, rect, pkcs);
		// บันทึกไฟล์ PDF เอาท์พุต
		signature.Save(dataDir + "DigitallySignWithTimeStamp_out.pdf");
	}
}
```

## บทสรุป

ขอแสดงความยินดี! คุณได้ดำเนินการลงนามดิจิทัลพร้อมประทับเวลาในไฟล์ PDF โดยใช้ Aspose.PDF สำหรับ .NET สำเร็จแล้ว บทช่วยสอนนี้ครอบคลุมกระบวนการทีละขั้นตอนตั้งแต่การสร้างลายเซ็นไปจนถึงการบันทึกไฟล์ PDF ที่อัปเดตแล้ว ตอนนี้คุณสามารถใช้คุณลักษณะนี้เพื่อเพิ่มลายเซ็นดิจิทัลพร้อมประทับเวลาในไฟล์ PDF ของคุณได้แล้ว

### คำถามที่พบบ่อยสำหรับการลงนามดิจิทัลพร้อมประทับเวลาในไฟล์ PDF

#### ถาม: จุดประสงค์ของการลงนามดิจิทัลด้วยการประทับเวลาคืออะไร

A: การลงนามแบบดิจิทัลด้วยวันที่และเวลาจะเพิ่มลายนิ้วมืออิเล็กทรอนิกส์พร้อมวันที่และเวลาลงในไฟล์ PDF ซึ่งช่วยรับรองความถูกต้องและความสมบูรณ์ของเอกสาร ณ จุดเวลาที่ระบุในเวลา

#### ถาม: ต้องมีข้อกำหนดเบื้องต้นอะไรบ้างในการเริ่มบทช่วยสอนนี้?

ก: ก่อนที่คุณจะเริ่มต้น ตรวจสอบให้แน่ใจว่าคุณมีความเข้าใจพื้นฐานเกี่ยวกับภาษาการเขียนโปรแกรม C# แล้ว ติดตั้ง Visual Studio และติดตั้งไลบรารี Aspose.PDF สำหรับ .NET เรียบร้อยแล้ว

#### ถาม: ฉันจะตั้งค่าสภาพแวดล้อมการพัฒนาของฉันได้อย่างไร

ตอบ: ปฏิบัติตามขั้นตอนที่ให้มาเพื่อตั้งค่าสภาพแวดล้อมการพัฒนาของคุณ รวมถึงการสร้างโปรเจ็กต์ C# ใหม่ใน Visual Studio และนำเข้าเนมสเปซที่จำเป็น

#### ถาม: ฉันจะเพิ่มลายเซ็นดิจิทัลพร้อมวันที่และเวลาลงใน PDF ได้อย่างไร

A: โค้ดตัวอย่างที่ให้มาจะสาธิตวิธีการโหลดไฟล์ PDF, สร้างลายเซ็นดิจิทัลพร้อมค่าประทับเวลาโดยใช้ไฟล์ PFX (คีย์ส่วนตัว) และการตั้งค่าค่าประทับเวลาที่ระบุ, เพิ่มลายเซ็นลงในไฟล์ PDF และบันทึกไฟล์ที่อัปเดต

#### ถาม: ไฟล์ PFX คืออะไร และทำไมจึงใช้ในตัวอย่าง

A: ไฟล์ PFX (Personal Exchange Format) มีคีย์ส่วนตัวและใบรับรอง ซึ่งใช้ที่นี่เพื่อให้มีฟังก์ชันการเข้ารหัสสำหรับลายเซ็นดิจิทัล โปรดแทนที่ตัวแทนด้วยไฟล์ PFX และรหัสผ่านของคุณ

#### ถาม: TimestampSettings คืออะไร?

A: TimestampSettings จะกำหนดค่าสำหรับเซิร์ฟเวอร์ timestamp ที่ใช้เพิ่ม timestamp อิเล็กทรอนิกส์ลงในลายเซ็น ซึ่งรวมถึง URL ของเซิร์ฟเวอร์ timestamp และข้อมูลประจำตัวผู้ใช้ที่เป็นทางเลือก

#### ถาม: ฉันสามารถใช้เซิร์ฟเวอร์ประทับเวลาอื่นนอกเหนือจากเซิร์ฟเวอร์ในตัวอย่างได้หรือไม่
 A: ใช่ คุณสามารถใช้เซิร์ฟเวอร์ประทับเวลาที่รองรับได้ทั้งหมด แทนที่ URL และหากจำเป็น ให้ระบุข้อมูลประจำตัวผู้ใช้ที่เหมาะสมใน`TimestampSettings` วัตถุ.

#### ถาม: จุดประสงค์ของการระบุรูปสี่เหลี่ยมลายเซ็นคืออะไร?

A: สี่เหลี่ยมผืนผ้าลายเซ็นจะกำหนดตำแหน่งและขนาดของลายเซ็นดิจิทัลที่ปรากฏบนหน้า PDF ปรับค่าเหล่านี้เพื่อจัดตำแหน่งลายเซ็นตามต้องการ

#### ถาม: จะเกิดอะไรขึ้นหากเซิร์ฟเวอร์ประทับเวลาไม่พร้อมใช้งานในระหว่างการลงนาม?

A: หากเซิร์ฟเวอร์ประทับเวลาไม่พร้อมใช้งานระหว่างการลงนาม กระบวนการอาจล้มเหลวหรือใช้เวลานานขึ้น โปรดตรวจสอบให้แน่ใจว่าเซิร์ฟเวอร์ประทับเวลาของคุณเชื่อถือได้และสามารถเข้าถึงได้

#### ถาม: ฉันจะตรวจสอบการมีอยู่ของค่าเวลาใน PDF ที่ลงนามได้อย่างไร

 A: คุณสามารถตรวจสอบ PDF ที่ลงนามแล้วได้โดยใช้โค้ดตัวอย่างที่ให้มา`TimestampSettings` ที่คุณใช้ระหว่างการลงนามควรจะมีอยู่ในรายละเอียดลายเซ็น

#### ถาม: ลายเซ็นดิจิทัลพร้อมวันที่และเวลามีผลผูกพันทางกฎหมายหรือไม่?

A: ลายเซ็นดิจิทัลพร้อมวันที่และเวลาถือเป็นสิ่งที่มีค่าทางกฎหมายในเขตอำนาจศาลหลายแห่ง และมักถือว่าเชื่อถือได้มากกว่าลายเซ็นดิจิทัลธรรมดา ปรึกษาผู้เชี่ยวชาญด้านกฎหมายในเขตอำนาจศาลของคุณเกี่ยวกับข้อบังคับเฉพาะ

#### ถาม: ฉันสามารถเพิ่มลายเซ็นดิจิทัลหลายรายการพร้อมวันที่และเวลาลงใน PDF ได้หรือไม่

A: ใช่ คุณสามารถเพิ่มลายเซ็นดิจิทัลหลายรายการพร้อมไทม์สแตมป์ลงในไฟล์ PDF ได้โดยการเรียกกระบวนการสร้างลายเซ็นหลายครั้ง ลายเซ็นแต่ละรายการจะมีไทม์สแตมป์ของตัวเอง