---
title: Найдите текст и нарисуйте прямоугольник
linktitle: Найдите текст и нарисуйте прямоугольник
second_title: Справочник по Aspose.PDF для .NET API
description: Узнайте, как искать текст в PDF-файле, рисовать прямоугольники вокруг найденного текста и сохранять измененный документ с помощью Aspose.PDF для .NET.
type: docs
weight: 460
url: /ru/net/programming-with-text/search-text-and-draw-rectangle/
---
В этом руководстве объясняется, как использовать Aspose.PDF для .NET для поиска определенного текста в документе PDF, нарисовать прямоугольник вокруг найденного текста и сохранить измененный документ. Приведенный исходный код C# демонстрирует процесс шаг за шагом.

## Предварительные условия

Прежде чем продолжить обучение, убедитесь, что у вас есть следующее:

- Базовые знания языка программирования C#.
- Установлена библиотека Aspose.PDF для .NET. Вы можете получить его с веб-сайта Aspose или использовать NuGet для установки в свой проект.

## Шаг 1. Настройте проект

Начните с создания нового проекта C# в предпочитаемой вами интегрированной среде разработки (IDE) и добавьте ссылку на библиотеку Aspose.PDF для .NET.

## Шаг 2. Импортируйте необходимые пространства имен.

Добавьте следующие директивы using в начало файла C#, чтобы импортировать необходимые пространства имен:

```csharp
using Aspose.Pdf;
using Aspose.Pdf.Text;
using Aspose.Pdf.Content;
using Aspose.Pdf.Facades;
```

## Шаг 3. Установите путь к каталогу документов.

 Задайте путь к каталогу вашего документа, используя`dataDir` переменная:

```csharp
string dataDir = "YOUR DOCUMENT DIRECTORY";
```

 Заменять`"YOUR DOCUMENT DIRECTORY"` с фактическим путем к каталогу вашего документа.

## Шаг 4. Загрузите PDF-документ.

 Загрузите PDF-документ, используя`Document` сорт:

```csharp
Document document = new Document(dataDir + "SearchAndGetTextFromAll.pdf");
```

 Заменять`"SearchAndGetTextFromAll.pdf"` с фактическим именем вашего PDF-файла.

## Шаг 5. Создайте TextFragmentAbsorber

 Создать`TextFragmentAbsorber` объект, чтобы найти все экземпляры входной поисковой фразы:

```csharp
TextFragmentAbsorber textAbsorber = new TextFragmentAbsorber(@"[\S]+");
```

 Заменять`@"[\S]+"` с желаемым шаблоном регулярного выражения.

## Шаг 6. Включите поиск по регулярным выражениям

 Включите поиск по регулярным выражениям, установив параметр`TextSearchOptions` свойство абсорбера:

```csharp
TextSearchOptions textSearchOptions = new TextSearchOptions(true);
textAbsorber.TextSearchOptions = textSearchOptions;
```

## Шаг 7. Поиск на всех страницах.

Примите поглотитель для всех страниц документа:

```csharp
document.Pages.Accept(textAbsorber);
```

## Шаг 8: Нарисуйте прямоугольник вокруг найденного текста.

 Создать`PdfContentEditor` объект и перебираем полученные фрагменты текста, рисуя прямоугольник вокруг каждого текстового сегмента:

```csharp
var editor = new PdfContentEditor(document);
foreach (TextFragment textFragment in textAbsorber.TextFragments)
{
    foreach (TextSegment textSegment in textFragment.Segments)
    {
        DrawBox(editor, textFragment.Page.Number, textSegment, System.Drawing.Color.Red);
    }
}
```

## Шаг 9. Сохраните измененный документ.

Сохраните измененный документ:

```csharp
dataDir = dataDir + "SearchTextAndDrawRectangle_out.pdf";
document.Save(dataDir);
```

 Обязательно замените`"SearchTextAndDrawRectangle_out.pdf"` с желаемым именем выходного файла.

### Пример исходного кода для поиска текста и рисования прямоугольника с использованием Aspose.PDF для .NET 
```csharp
// Путь к каталогу документов.
string dataDir = "YOUR DOCUMENT DIRECTORY";
// Открыть документ
Document document = new Document(dataDir + "SearchAndGetTextFromAll.pdf");
// Создайте объект TextAbsorber, чтобы найти все фразы, соответствующие регулярному выражению.
TextFragmentAbsorber textAbsorber = new TextFragmentAbsorber(@"[\S]+");
TextSearchOptions textSearchOptions = new TextSearchOptions(true);
textAbsorber.TextSearchOptions = textSearchOptions;
document.Pages.Accept(textAbsorber); 
var editor = new PdfContentEditor(document); 
foreach (TextFragment textFragment in textAbsorber.TextFragments)
{
	foreach (TextSegment textSegment in textFragment.Segments)
	{
			DrawBox(editor, textFragment.Page.Number, textSegment, System.Drawing.Color.Red);
	}
}
dataDir = dataDir + "SearchTextAndDrawRectangle_out.pdf";
document.Save(dataDir);
Console.WriteLine("\nRectangle drawn successfully on searched text.\nFile saved at " + dataDir);
```

## Заключение

Поздравляем! Вы успешно научились искать определенный текст в PDF-документе, рисовать прямоугольник вокруг найденного текста и сохранять измененный документ с помощью Aspose.PDF для .NET. В этом руководстве представлено пошаговое руководство: от настройки проекта до выполнения необходимых действий. Теперь вы можете включить этот код в свои собственные проекты C# для управления текстом и рисования прямоугольников в файлах PDF.

### Часто задаваемые вопросы

#### Вопрос: Какова цель урока «Найти текст и нарисовать прямоугольник»?

О: Учебное пособие «Поиск текста и рисование прямоугольника» призвано помочь пользователям в процессе использования библиотеки Aspose.PDF для .NET для поиска определенного текста в PDF-документе, рисования прямоугольников вокруг найденных текстовых сегментов и сохранения измененных документ. В руководстве представлены подробные инструкции и примеры кода C#, иллюстрирующие каждый этап процесса.

#### Вопрос: Как это руководство поможет нарисовать прямоугольники вокруг определенного текста в PDF-документе?

О: В этом руководстве представлено подробное руководство о том, как найти и нарисовать прямоугольники вокруг определенных текстовых сегментов в PDF-документе. Он демонстрирует процесс настройки проекта, загрузки PDF-документа, включения поиска по регулярным выражениям, рисования прямоугольников вокруг найденных текстовых сегментов и сохранения измененного PDF-файла.

#### Вопрос: Какие предварительные условия необходимы для изучения этого руководства?

О: Прежде чем приступить к изучению руководства, вы должны иметь базовое представление о языке программирования C#. Кроме того, вам необходимо установить библиотеку Aspose.PDF for .NET. Вы можете получить его с веб-сайта Aspose или установить в свой проект с помощью NuGet.

#### Вопрос: Как мне настроить свой проект для использования этого руководства?

О: Начните с создания нового проекта C# в предпочитаемой вами интегрированной среде разработки (IDE). Затем добавьте ссылку на библиотеку Aspose.PDF для .NET в свой проект. Это позволит вам использовать функции библиотеки для управления PDF-документами.

#### Вопрос: Могу ли я нарисовать прямоугольники вокруг определенного текста с помощью этого урока?

О: Да, в руководстве основное внимание уделяется рисованию прямоугольников вокруг определенных текстовых сегментов в PDF-документе. Он демонстрирует, как найти нужный текст с помощью регулярных выражений, создать прямоугольники вокруг определенных текстовых сегментов и сохранить измененный PDF-файл.

#### Вопрос: Как указать текст, который я хочу найти, и обвести его прямоугольниками?

 О: Чтобы указать текст, который вы хотите найти, и нарисовать вокруг него прямоугольники, создайте`TextFragmentAbsorber` объект и задайте его шаблон с помощью`Text` параметр. Заменить шаблон по умолчанию`@"[\S]+"` в коде руководства с нужным шаблоном регулярного выражения.

#### Вопрос: Как включить поиск текста по регулярному выражению?

 О: Поиск по регулярным выражениям включается путем создания`TextSearchOptions` объект и установить его значение`true` . Назначьте этот объект`TextSearchOptions` собственность`TextFragmentAbsorber` пример. Это гарантирует, что шаблон регулярного выражения будет использоваться во время текстового поиска.

#### Вопрос: Как нарисовать прямоугольники вокруг найденного текста?

 A: После идентификации текстовых сегментов с помощью`TextFragmentAbsorber` , в учебнике предусмотрен цикл для перебора этих сегментов. Для каждого текстового сегмента в учебнике показано, как создать вокруг него прямоугольник с помощью`DrawBox` и укажите внешний вид прямоугольника.

#### Вопрос: Как сохранить измененный PDF-файл с нарисованными прямоугольниками?

О: После рисования прямоугольников вокруг нужных текстовых сегментов используйте`Document` класс`Save` метод сохранения измененного документа. Пример кода в руководстве демонстрирует, как сохранить отредактированный PDF-файл и отобразить сообщение об успехе.

#### Вопрос: Можно ли настроить внешний вид нарисованных прямоугольников?

 О: Да, вы можете настроить внешний вид нарисованных прямоугольников. В примере кода руководства`DrawBox` Метод используется для создания прямоугольников. Вы можете изменить такие свойства, как цвет, стиль и толщина, чтобы настроить внешний вид нарисованных прямоугольников.