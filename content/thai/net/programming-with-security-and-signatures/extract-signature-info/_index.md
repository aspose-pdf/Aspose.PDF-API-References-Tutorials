---
title: ดึงข้อมูลลายเซ็น
linktitle: ดึงข้อมูลลายเซ็น
second_title: เอกสารอ้างอิง Aspose.PDF สำหรับ API ของ .NET
description: การแยกข้อมูลลายเซ็นโดยใช้ Aspose.PDF สำหรับ .NET
type: docs
weight: 80
url: /th/net/programming-with-security-and-signatures/extract-signature-info/
---
กระบวนการดึงข้อมูลลายเซ็นจากเอกสาร PDF สามารถเป็นประโยชน์ได้ในหลายสถานการณ์ ไม่ว่าคุณจะต้องตรวจสอบความถูกต้องของเอกสารที่ลงนามหรือวิเคราะห์ใบรับรองที่ใช้สำหรับลายเซ็น ไลบรารี Aspose.PDF สำหรับ .NET ก็มีวิธีแก้ปัญหาที่สะดวก ในบทช่วยสอนนี้ เราจะแนะนำคุณตลอดกระบวนการดึงข้อมูลลายเซ็นโดยใช้โค้ดต้นฉบับ C# ที่ให้มาทีละขั้นตอน

## ความต้องการ

ก่อนที่เราจะเริ่ม โปรดตรวจสอบให้แน่ใจว่าคุณมีข้อกำหนดเบื้องต้นดังต่อไปนี้:

1. ความรู้พื้นฐานเกี่ยวกับภาษาการเขียนโปรแกรม C#
2. Aspose.PDF สำหรับไลบรารี .NET ติดตั้งอยู่บนระบบของคุณ
3. เอกสาร PDF ที่ถูกต้องพร้อมช่องลายเซ็นหนึ่งช่องขึ้นไป

ตอนนี้มาดูรายละเอียดการใช้งานกัน

## ขั้นตอนที่ 1: นำเข้าไลบรารีที่จำเป็น

 ในการเริ่มต้น คุณต้องนำเข้าไลบรารีที่จำเป็นเข้าสู่โปรเจ็กต์ C# ของคุณ ในกรณีนี้ เราต้องนำเข้า`Aspose.Pdf` และ`System.IO` เนมสเปซ สามารถทำได้โดยเพิ่มโค้ดต่อไปนี้ที่จุดเริ่มต้นของไฟล์ C#:

```csharp
using Aspose.Pdf;
using System.IO;
```

## ขั้นตอนที่ 2: การตั้งค่าเส้นทางเอกสาร

ขั้นต่อไป คุณต้องกำหนดเส้นทางไปยังเอกสาร PDF ที่คุณต้องการแยกข้อมูลลายเซ็นออกมา แทนที่`"YOUR DOCUMENTS DIRECTORY"` ในชิ้นส่วนโค้ดต่อไปนี้โดยมีเส้นทางจริงไปยังเอกสารของคุณ:

```csharp
string dataDir = "YOUR DOCUMENTS DIRECTORY";
string input = dataDir + "ExtractSignatureInfo.pdf";
```

## ขั้นตอนที่ 3: การดึงข้อมูลลายเซ็น

ตอนนี้มาดูส่วนหลักของโค้ดกัน ซึ่งเราจะดึงข้อมูลลายเซ็นจากเอกสาร PDF เราจะวนซ้ำในแต่ละฟิลด์ในแบบฟอร์มของเอกสารและตรวจสอบว่าเป็นฟิลด์ลายเซ็นหรือไม่ หากพบฟิลด์ลายเซ็น เราจะดำเนินการดึงใบรับรอง เพิ่มโค้ดสั้นๆ ดังต่อไปนี้:

```csharp
using (Document pdfDocument = new Document(input))
{
     foreach(Field field in pdfDocument.Form)
     {
         SignatureField sf = field as SignatureField;
         if (sf != null)
         {
             // ดึงใบรับรองออกมา
             Stream cerStream = sf.ExtractCertificate();
             if (cerStream != null)
             {
                 using (cerStream)
                 {
                     byte[] bytes = new byte[cerStream.Length];
                     using (FileStream fs = new FileStream(dataDir + @"input.cer", FileMode.CreateNew))
                     {
                         cerStream.Read(bytes, 0, bytes.Length);
                         fs.Write(bytes, 0, bytes.Length);
                     }
                 }
             }
         }
     }
}
```

## ขั้นตอนที่ 4: การแยกใบรับรอง

ในขั้นตอนนี้ เราจะแยกใบรับรองจากฟิลด์ลายเซ็นและบันทึกเป็นไฟล์ จากนั้นเราสามารถวิเคราะห์หรือนำใบรับรองที่แยกออกมาเพื่อวัตถุประสงค์ในการตรวจสอบความถูกต้องได้ ตัวอย่างโค้ดด้านล่างนี้จะสาธิตกระบวนการแยกและบันทึก:

```csharp
Stream cerStream = sf.ExtractCertificate();
if (cerStream != null)
{
     using (cerStream)
     {
         byte[] bytes = new byte[cerStream.Length];
         using (FileStream fs = new FileStream(dataDir + @"input.cer", FileMode.CreateNew))
         {
             cerStream.Read(bytes, 0, bytes.Length);
             fs.Write(bytes, 0, bytes.Length);
         }
     }
}
```

## ขั้นตอนที่ 5

: การบันทึกใบรับรอง

สุดท้าย เราจะบันทึกใบรับรองที่แยกออกมาเป็นไฟล์ ในตัวอย่างนี้ ใบรับรองจะถูกบันทึกด้วยชื่อ "input.cer" ในไดเร็กทอรีที่ระบุ คุณสามารถปรับเปลี่ยนโค้ดให้เหมาะกับความต้องการของคุณได้ นี่คือตัวอย่างโค้ดสำหรับการบันทึกใบรับรอง:

```csharp
using (FileStream fs = new FileStream(dataDir + @"input.cer", FileMode.CreateNew))
{
     fs.Write(bytes, 0, bytes.Length);
}
```

เสร็จเรียบร้อย! คุณได้แยกข้อมูลลายเซ็นสำเร็จแล้วโดยใช้ Aspose.PDF สำหรับ .NET คุณสามารถรวมโค้ดนี้ลงในแอปพลิเคชันของคุณเองหรือปรับเปลี่ยนตามความต้องการของคุณได้ตามต้องการ

### ตัวอย่างโค้ดต้นฉบับสำหรับการดึงข้อมูลลายเซ็นโดยใช้ Aspose.PDF สำหรับ .NET 
```csharp
try
{
	// เส้นทางไปยังไดเร็กทอรีเอกสาร
	string dataDir = "YOUR DOCUMENTS DIRECTORY";
	string input = dataDir + "ExtractSignatureInfo.pdf";
	using (Document pdfDocument = new Document(input))
	{
		foreach (Field field in pdfDocument.Form)
		{
			SignatureField sf = field as SignatureField;
			if (sf != null)
			{
				Stream cerStream = sf.ExtractCertificate();
				if (cerStream != null)
				{
					using (cerStream)
					{
						byte[] bytes = new byte[cerStream.Length];
						using (FileStream fs = new FileStream(dataDir + @"input.cer", FileMode.CreateNew))
						{
							cerStream.Read(bytes, 0, bytes.Length);
							fs.Write(bytes, 0, bytes.Length);
						}
					}
				}
			}
		}
	}
}
catch (Exception ex)
{
	Console.WriteLine(ex.Message);
}
```

## บทสรุป

ในบทช่วยสอนนี้ เราได้แนะนำทีละขั้นตอนเกี่ยวกับวิธีการดึงข้อมูลลายเซ็นจากเอกสาร PDF โดยใช้ไลบรารี Aspose.PDF สำหรับ .NET เราได้กล่าวถึงกระบวนการนำเข้าไลบรารีที่จำเป็น การตั้งค่าเส้นทางเอกสาร การดึงข้อมูลลายเซ็น การดึงใบรับรอง และการบันทึกลงในไฟล์ โดยทำตามขั้นตอนเหล่านี้ คุณสามารถดึงรายละเอียดลายเซ็นและทำงานกับข้อมูลดังกล่าวได้อย่างง่ายดายตามต้องการ

### คำถามที่พบบ่อย

#### ถาม: เหตุใดฉันจึงต้องดึงข้อมูลลายเซ็นจากเอกสาร PDF

ก: การแยกข้อมูลลายเซ็นจากเอกสาร PDF มีประโยชน์ในการตรวจสอบความถูกต้องของเอกสารที่ลงนามและวิเคราะห์ใบรับรองที่ใช้สำหรับลายเซ็น กระบวนการนี้ช่วยให้แน่ใจว่าเนื้อหาที่ลงนามนั้นมีความสมบูรณ์ และอาจมีความจำเป็นสำหรับวัตถุประสงค์ทางกฎหมายและความปลอดภัย

#### ถาม: Aspose.PDF สำหรับ .NET คืออะไร?

A: Aspose.PDF สำหรับ .NET เป็นไลบรารีที่ช่วยให้นักพัฒนาสามารถทำงานกับเอกสาร PDF ในแอปพลิเคชัน .NET ได้ โดยไลบรารีนี้มีคุณสมบัติมากมายสำหรับการสร้าง แก้ไข และโต้ตอบกับไฟล์ PDF ด้วยโปรแกรม

#### ถาม: ข้อกำหนดเบื้องต้นในการแยกข้อมูลลายเซ็นโดยใช้ Aspose.PDF สำหรับ .NET คืออะไร

ก: หากต้องการแยกข้อมูลลายเซ็น คุณต้องมีความรู้พื้นฐานเกี่ยวกับภาษาการเขียนโปรแกรม C# ไลบรารี Aspose.PDF สำหรับ .NET ที่ติดตั้งในระบบของคุณ และเอกสาร PDF ที่ถูกต้องซึ่งประกอบด้วยฟิลด์ลายเซ็นหนึ่งรายการขึ้นไป

#### ถาม: ฉันจะนำเข้าไลบรารีที่จำเป็นสำหรับกระบวนการแยกไฟล์ได้อย่างไร

A: คุณสามารถนำเข้าไลบรารีที่จำเป็นได้โดยการเพิ่ม`using` คำสั่งสำหรับ`Aspose.Pdf` และ`System.IO` ที่จุดเริ่มต้นของไฟล์ C# ของคุณ คำสั่งเหล่านี้ช่วยให้คุณสามารถใช้คลาสและวิธีการที่จำเป็นสำหรับการแยกข้อมูลลายเซ็น

#### ถาม: ฉันจะระบุเอกสาร PDF เพื่อแยกข้อมูลลายเซ็นได้อย่างไร

 A: คุณสามารถกำหนดเส้นทางไปยังเอกสาร PDF ได้โดยการแทนที่`"YOUR DOCUMENTS DIRECTORY"` โดยมีเส้นทางจริงไปยังเอกสารของคุณในสไนปเป็ตโค้ดที่ให้มา เส้นทางนี้ใช้เพื่อโหลดเอกสาร PDF ที่คุณต้องการดึงข้อมูลลายเซ็นออกมา

#### ถาม: กระบวนการในการดึงข้อมูลลายเซ็นจากเอกสาร PDF คืออะไร

A: กระบวนการแยกไฟล์เกี่ยวข้องกับการวนซ้ำผ่านฟิลด์ฟอร์มของเอกสาร PDF ตรวจสอบว่าฟิลด์แต่ละฟิลด์เป็นฟิลด์ลายเซ็นหรือไม่ และหากใช่ ให้แยกใบรับรองที่เกี่ยวข้อง ใบรับรองที่แยกไฟล์สามารถบันทึกเป็นไฟล์สำหรับการวิเคราะห์หรือการตรวจสอบเพิ่มเติม

#### ถาม: จะดึงใบรับรองจากช่องลายเซ็นได้อย่างไร?

ก: ใบรับรองจะถูกดึงมาจากช่องลายเซ็นโดยใช้`ExtractCertificate()` วิธีการที่ให้ไว้โดย`SignatureField` คลาสใน Aspose.PDF สำหรับ .NET วิธีการนี้ส่งคืนสตรีมที่ประกอบด้วยข้อมูลใบรับรอง

#### ถาม: ฉันจะบันทึกใบรับรองที่แยกออกมาเป็นไฟล์ได้อย่างไร

 A: คุณสามารถบันทึกใบรับรองที่แยกออกมาเป็นไฟล์ได้โดยการอ่านสตรีมใบรับรองและเขียนเนื้อหาลงในไฟล์โดยใช้`FileStream` คลาส โค้ดที่ให้ไว้ในบทช่วยสอนนี้สาธิตกระบวนการนี้

#### ถาม: ฉันสามารถใช้ใบรับรองที่แยกออกมาเพื่อการตรวจสอบลายเซ็นได้หรือไม่

A: ใช่ สามารถใช้ใบรับรองที่สกัดออกมาเพื่อยืนยันลายเซ็นได้ คุณสามารถวิเคราะห์รายละเอียดของใบรับรองและตรวจสอบความถูกต้องเพื่อให้แน่ใจว่าเอกสารที่ลงนามนั้นสมบูรณ์

#### ถาม: ฉันจะรวมโค้ดนี้ลงในแอปพลิเคชันของฉันเองได้อย่างไร

A: คุณสามารถรวมโค้ดที่ให้มาลงในแอปพลิเคชัน C# ของคุณเองได้โดยทำตามคำแนะนำทีละขั้นตอน แก้ไขเส้นทางและชื่อไฟล์ตามต้องการ และรวมโค้ดลงในโปรเจ็กต์ที่มีอยู่ของคุณ

#### ถาม: มีฟีเจอร์อื่นๆ ใน Aspose.PDF สำหรับ .NET ที่เกี่ยวข้องกับการจัดการลายเซ็นหรือไม่

A: ใช่ Aspose.PDF สำหรับ .NET มีฟีเจอร์ต่างๆ มากมายสำหรับการทำงานกับลายเซ็นดิจิทัล รวมถึงการลงนามในเอกสาร การตรวจสอบลายเซ็น และการเพิ่มข้อมูลประทับเวลา คุณสามารถสำรวจเอกสารประกอบอย่างเป็นทางการเพื่อดูรายละเอียดเพิ่มเติมเกี่ยวกับฟีเจอร์เหล่านี้ได้

#### ถาม: ฉันสามารถหาแหล่งข้อมูลเพิ่มเติมสำหรับการใช้ Aspose.PDF สำหรับ .NET ได้จากที่ใด

 A: สำหรับข้อมูลเพิ่มเติม บทช่วยสอน และทรัพยากรเกี่ยวกับการใช้ Aspose.PDF สำหรับ .NET[Aspose.PDF สำหรับ .NET](https://reference.aspose.com/pdf/net/).

#### ถาม: สามารถดึงลายเซ็นจากเอกสาร PDF ที่เข้ารหัสได้หรือไม่

A: ความสามารถในการดึงลายเซ็นจากเอกสาร PDF ที่เข้ารหัสอาจขึ้นอยู่กับการตั้งค่าการเข้ารหัสและการอนุญาตของเอกสาร คุณอาจต้องแน่ใจว่าคุณมีสิทธิ์ที่จำเป็นในการเข้าถึงและดึงข้อมูลลายเซ็น

#### ถาม: ฉันสามารถดึงลายเซ็นหลายรายการจากเอกสาร PDF เดียวได้หรือไม่

A: ใช่ คุณสามารถแก้ไขโค้ดที่ให้มาเพื่อทำซ้ำในฟิลด์ลายเซ็นทั้งหมดในเอกสาร PDF และดึงข้อมูลลายเซ็นจากแต่ละฟิลด์ได้ วิธีนี้ช่วยให้คุณดึงข้อมูลเกี่ยวกับลายเซ็นหลายรายการที่มีอยู่ในเอกสารได้

#### ถาม: มีกรณีการใช้งานจริงในการแยกข้อมูลลายเซ็นอะไรบ้าง

ก: กรณีการใช้งานจริงบางกรณีสำหรับการดึงข้อมูลลายเซ็น ได้แก่ การตรวจสอบความถูกต้องของเอกสารที่ลงนามดิจิทัล การวิเคราะห์รายละเอียดใบรับรองเพื่อวัตถุประสงค์ในการปฏิบัติตามกฎระเบียบ และการรักษาบันทึกลายเซ็นและผู้ลงนามเพื่อวัตถุประสงค์ในการตรวจสอบ

#### ถาม: มีข้อควรพิจารณาทางกฎหมายใด ๆ หรือไม่เมื่อดึงข้อมูลลายเซ็น?

ก: การดึงข้อมูลลายเซ็นอาจส่งผลทางกฎหมาย โดยเฉพาะอย่างยิ่งเมื่อต้องจัดการกับเอกสารที่มีผลผูกพันทางกฎหมาย ตรวจสอบให้แน่ใจว่าคุณปฏิบัติตามกฎระเบียบและกฎหมายที่เกี่ยวข้องกับลายเซ็นอิเล็กทรอนิกส์และความถูกต้องของเอกสารในเขตอำนาจศาลของคุณ