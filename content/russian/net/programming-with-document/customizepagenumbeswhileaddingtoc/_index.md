---
title: Настройте номера страниц при добавлении оглавления
linktitle: Настройте номера страниц при добавлении оглавления
second_title: Справочник по API Aspose.PDF для .NET
description: Узнайте, как настраивать номера страниц при добавлении оглавления в документы PDF с помощью Aspose.PDF для .NET в этом подробном руководстве.
type: docs
weight: 100
url: /ru/net/programming-with-document/customizepagenumbeswhileaddingtoc/
---
## Введение

В мире управления документами PDF-файлы доминируют. Это формат, к которому обращаются для обмена и сохранения документов на различных платформах. Но что делать, если вы хотите улучшить свои PDF-документы такими функциями, как оглавление (TOC)? Вот тут-то и вступает в игру Aspose.PDF для .NET! Эта мощная библиотека позволяет разработчикам с легкостью манипулировать PDF-файлами, позволяя им добавлять, изменять и настраивать содержимое без особых усилий. В этом уроке мы рассмотрим, как настраивать номера страниц при добавлении оглавления в ваши PDF-документы с помощью Aspose.PDF для .NET. Итак, хватайте свою шляпу кодера и начнем!

## Предпосылки

Прежде чем перейти к коду, вам необходимо выполнить несколько действий:

1. Visual Studio: Убедитесь, что на вашем компьютере установлена Visual Studio. Это будет наша среда разработки.
2. Aspose.PDF для .NET: Вам необходимо загрузить и установить библиотеку Aspose.PDF. Вы можете найти ее[здесь](https://releases.aspose.com/pdf/net/).
3. Базовые знания C#: знакомство с программированием на C# поможет вам лучше понимать фрагменты кода.
4. Образец файла PDF: Имейте готовый образец файла PDF, с которым мы можем работать. Вы можете создать простой файл или загрузить существующий PDF.

## Импортные пакеты

Для начала нам нужно импортировать необходимые пакеты. Откройте ваш проект Visual Studio и добавьте ссылку на библиотеку Aspose.PDF. Вы можете сделать это с помощью NuGet Package Manager:

1. Щелкните правой кнопкой мыши по вашему проекту в обозревателе решений.
2. Выберите «Управление пакетами NuGet».
3. Найдите «Aspose.PDF» и установите его.

```csharp
using Aspose.Pdf.Text;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
```

После установки библиотеки вы можете приступить к написанию кода!

## Шаг 1: Настройте каталог документов

Первым делом нам нужно настроить наш каталог документов. Здесь мы будем хранить наши входные и выходные файлы PDF. 

```csharp
string dataDir = "YOUR DOCUMENT DIRECTORY";
string inFile = dataDir + "42824.pdf";
string outFile = dataDir + "42824_out.pdf";
```

В этом фрагменте замените`YOUR DOCUMENT DIRECTORY` с фактическим путем, где находятся ваши файлы PDF. Это поможет нам загрузить существующий PDF и сохранить измененную версию.

## Шаг 2: Загрузите существующий PDF-файл

Теперь, когда у нас настроен каталог документов, давайте загрузим существующий PDF-файл. 

```csharp
Document doc = new Document(inFile);
```

 Здесь мы создаем новый`Document` объект, передавая путь к входному файлу. Это позволяет нам программно манипулировать содержимым PDF.

## Шаг 3: Вставьте новую страницу для оглавления

Далее нам необходимо создать новую страницу в нашем PDF-файле, где будет находиться оглавление.

```csharp
Aspose.Pdf.Page tocPage = doc.Pages.Insert(1);
```

Эта строка вставляет новую страницу в начало документа. TOC будет отображаться на этой странице.

## Шаг 4: Создание информации о содержании

Теперь давайте создадим объект для представления информации TOC.

```csharp
TocInfo tocInfo = new TocInfo();
TextFragment title = new TextFragment("Table Of Contents");
title.TextState.FontSize = 20;
title.TextState.FontStyle = FontStyles.Bold;
tocInfo.Title = title;
tocInfo.PageNumbersPrefix = "P";
tocPage.TocInfo = tocInfo;
```

 На этом этапе мы создаем`TocInfo` объект и устанавливаем его заголовок на "Table Of Contents". Мы также настраиваем размер и стиль шрифта.`PageNumbersPrefix` установлено значение «P», которое будет префиксом номеров страниц в оглавлении.

## Шаг 5: Добавьте заголовки в оглавление

А теперь самое интересное! Мы пройдемся по страницам документа и добавим заголовки в наше оглавление.

```csharp
for (int i = 1; i < doc.Pages.Count; i++)
{
    Aspose.Pdf.Heading heading2 = new Aspose.Pdf.Heading(1);
    TextSegment segment2 = new TextSegment();
    heading2.TocPage = tocPage;
    heading2.Segments.Add(segment2);
    heading2.DestinationPage = doc.Pages[i + 1];
    heading2.Top = doc.Pages[i + 1].Rect.Height;
    segment2.Text = "Page " + i.ToString();
    tocPage.Paragraphs.Add(heading2);
}
```

 В этом цикле мы создаем новый`Heading` объект для каждой страницы. Мы задаем целевую страницу для каждого заголовка и указываем текст для отображения, который является "Страница X", где X — номер страницы. Наконец, мы добавляем заголовок на страницу TOC.

## Шаг 6: Сохраните обновленный документ.

После добавления всех необходимых заголовков пришло время сохранить наш обновленный документ.

```csharp
doc.Save(outFile);
```

Эта строка сохраняет измененный PDF с включенным оглавлением. Теперь вы можете открыть выходной файл и увидеть свое настроенное оглавление!

## Заключение

И вот оно! Вы успешно настроили номера страниц, добавив оглавление в свой PDF-документ с помощью Aspose.PDF для .NET. Эта мощная библиотека упрощает работу с PDF-файлами, и с помощью всего нескольких строк кода вы можете значительно улучшить свои документы. Независимо от того, создаете ли вы отчеты, электронные книги или любой другой тип PDF-файлов, наличие оглавления может значительно улучшить навигацию для ваших читателей. Так чего же вы ждете? Погрузитесь в Aspose.PDF и начните создавать потрясающие PDF-файлы уже сегодня!

## Часто задаваемые вопросы

### Что такое Aspose.PDF для .NET?
Aspose.PDF для .NET — это библиотека, которая позволяет разработчикам создавать, изменять и конвертировать PDF-документы программным способом.

### Могу ли я использовать Aspose.PDF бесплатно?
 Да, Aspose предлагает бесплатную пробную версию, которую вы можете использовать для изучения возможностей библиотеки. Вы можете загрузить ее[здесь](https://releases.aspose.com/).

### Как получить поддержку по Aspose.PDF?
 Вы можете получить поддержку, посетив форум Aspose.[здесь](https://forum.aspose.com/c/pdf/10).

### Есть ли временная лицензия?
 Да, вы можете запросить временную лицензию для Aspose.PDF[здесь](https://purchase.aspose.com/temporary-license/).

### Где можно купить Aspose.PDF для .NET?
 Вы можете приобрести Aspose.PDF для .NET[здесь](https://purchase.aspose.com/buy).