---
title: Добавить отметку даты и времени в файл PDF
linktitle: Добавить отметку даты и времени в файл PDF
second_title: Справочник по API Aspose.PDF для .NET
description: Узнайте, как добавлять отметку даты и времени в файлы PDF с помощью Aspose.PDF для .NET с помощью этого пошагового руководства. Идеально подходит для повышения подлинности документа.
type: docs
weight: 10
url: /ru/net/programming-with-stamps-and-watermarks/add-date-time-stamp/
---
## Введение

Когда дело доходит до управления документами, особенно PDF-файлами, добавление отметки даты и времени может стать решающим фактором. Работаете ли вы с юридическими документами, отчетами по проектам или счетами-фактурами, отметка времени не только добавляет подлинности, но и обеспечивает четкую запись того, когда документ был создан или изменен. В этом руководстве мы проведем вас через процесс добавления отметки даты и времени в файл PDF с помощью библиотеки Aspose.PDF для .NET. 

Эта статья разработана так, чтобы быть простой и понятной, поэтому даже если вы новичок в программировании или библиотеке Aspose.PDF, вы сможете с уверенностью реализовать эту функцию. Давайте погрузимся!

## Предпосылки

Прежде чем начать, вам необходимо выполнить несколько предварительных условий:

1. Visual Studio: Убедитесь, что на вашем компьютере установлена Visual Studio. Здесь вы будете писать и выполнять свой код.
2. Aspose.PDF для .NET: Вам необходимо загрузить и установить библиотеку Aspose.PDF. Последнюю версию вы можете найти[здесь](https://releases.aspose.com/pdf/net/).
3. Базовые знания C#: знакомство с программированием на C# поможет вам лучше понять примеры, но не волнуйтесь, если вы только начинаете; мы объясним все шаг за шагом.
4.  Файл PDF: Подготовьте пример файла PDF. Для нашего примера мы будем использовать файл с именем`AddTextStamp.pdf`.

Как только вы выполните все эти предварительные условия, вы будете готовы приступить к добавлению отметок даты и времени в свои PDF-файлы!

## Импортные пакеты

Для начала вам нужно импортировать необходимые пространства имен в ваш проект C#. Вот как это сделать:

### Создать новый проект

1. Откройте Visual Studio: запустите приложение Visual Studio.
2. Создать новый проект: Выберите «Создать новый проект» на начальном экране.
3. Выберите консольное приложение: выберите «Консольное приложение (.NET Framework)» из списка шаблонов проектов.
4.  Назовите свой проект: дайте своему проекту имя, например,`PDFDateTimeStamp`.

### Добавить ссылку Aspose.PDF

1. Щелкните правой кнопкой мыши по папке «Ссылки». В обозревателе решений щелкните правой кнопкой мыши по папке «Ссылки» вашего проекта.
2. Выберите «Добавить ссылку»: Выберите «Добавить ссылку» в контекстном меню.
3. Найдите Aspose.PDF: Перейдите в папку, куда вы скачали Aspose.PDF, и выберите его. Нажмите «ОК», чтобы добавить его в свой проект.

### Импорт требуемых пространств имен

 В верхней части вашего`Program.cs` файл, вам необходимо импортировать следующие пространства имен:

```csharp
using System.IO;
using Aspose.Pdf;
using Aspose.Pdf.Text;
using System;
using Aspose.Pdf.Annotations;
```

Теперь, когда у нас все готово, давайте разберем процесс добавления отметки даты и времени в PDF-файл на понятные и легко выполнимые шаги.

## Шаг 1: Укажите каталог документов

Во-первых, вам нужно указать каталог, в котором находится ваш PDF-файл. Это важно, поскольку код будет искать PDF-файл в этом каталоге.

```csharp
// Путь к каталогу документов.
string dataDir = "YOUR DOCUMENT DIRECTORY"; // Замените на ваш реальный путь
```

 Обязательно замените`YOUR DOCUMENT DIRECTORY` с фактическим путем к вашему PDF-файлу.

## Шаг 2: Откройте PDF-документ.

Далее вам нужно открыть PDF-документ, в который вы хотите добавить временную метку. 

```csharp
// Открыть документ
Document pdfDocument = new Document(dataDir + "AddTextStamp.pdf");
```

 Эта строка кода инициализирует`Document` класс и загружает ваш PDF-файл в`pdfDocument` объект.

## Шаг 3: Создайте отметку даты и времени

Теперь пришло время сгенерировать отметку даты и времени. Вы отформатируете ее для отображения определенным образом. 

```csharp
string annotationText = DateTime.Now.ToString("MM/dd/yy hh:mm:ss tt ");
```

 Здесь,`DateTime.Now` получает текущую дату и время, и`ToString` форматирует его в нужный вам формат.

## Шаг 4: Создайте текстовый штамп

Теперь, когда строка даты и времени готова, вы можете создать текстовый штамп, который будет добавлен в ваш PDF-файл.

```csharp
// Создать текстовый штамп
TextStamp textStamp = new TextStamp(annotationText);
```

 Эта строка создает новый экземпляр`TextStamp` используя отформатированную строку даты и времени.

## Шаг 5: Задайте свойства штампа

Вы можете настроить внешний вид и положение штампа. Вот как задать его свойства:

```csharp
// Установить свойства штампа
textStamp.BottomMargin = 10;
textStamp.RightMargin = 20;
textStamp.HorizontalAlignment = Aspose.Pdf.HorizontalAlignment.Right;
textStamp.VerticalAlignment = VerticalAlignment.Bottom;
```

На этом этапе мы задаем поля и выравниваем штамп по нижнему правому углу страницы PDF-файла.

## Шаг 6: Добавьте штамп в PDF-файл

Теперь пришло время добавить текстовый штамп в ваш PDF-документ. 

```csharp
// Добавление марки в коллекцию марок
pdfDocument.Pages[1].AddStamp(textStamp);
```

Эта строка добавляет штамп на первую страницу PDF. Вы можете изменить номер страницы, если хотите разместить его на другой странице.

## Шаг 7: Создайте свободную текстовую аннотацию (необязательно)

Если вы хотите добавить аннотацию к марке, вы можете создать`FreeTextAnnotation` следующее:

```csharp
DefaultAppearance default_appearance = new DefaultAppearance("Arial", 6, System.Drawing.Color.Black);
FreeTextAnnotation textAnnotation = new FreeTextAnnotation(pdfDocument.Pages[1], new Aspose.Pdf.Rectangle(0, 0, 0, 0), default_appearance);
textAnnotation.Name = "Stamp";
textAnnotation.Accept(new AnnotationSelector(textAnnotation));
textAnnotation.Contents = textStamp.Value;
```

Этот необязательный шаг создает свободную текстовую аннотацию, которая может предоставить дополнительный контекст или информацию о марке.

## Шаг 8: Настройте границу аннотации

Если вы хотите настроить границу своей аннотации, вы также можете это сделать:

```csharp
Border border = new Border(textAnnotation);
border.Width = 0;
border.Dash = new Dash(1, 1);
textAnnotation.Border = border;
textAnnotation.Rect = new Aspose.Pdf.Rectangle(0, 0, 0, 0);
pdfDocument.Pages[1].Annotations.Add(textAnnotation);
```

Этот фрагмент кода устанавливает ширину границы на 0, делая ее невидимой, и добавляет аннотацию в PDF-файл.

## Шаг 9: Сохраните PDF-документ.

Наконец, вам необходимо сохранить измененный PDF-документ. 

```csharp
dataDir = dataDir + "AddDateTimeStamp_out.pdf"; // Укажите имя выходного файла
pdfDocument.Save(dataDir);
Console.WriteLine("\nDate time stamp added successfully.\nFile saved at " + dataDir);
```

Эта строка сохраняет PDF с добавленной временной меткой в новый файл. Вы можете проверить указанный каталог, чтобы увидеть вывод.

## Заключение

Поздравляем! Вы успешно добавили отметку даты и времени в файл PDF с помощью Aspose.PDF для .NET. Эта простая, но эффективная функция может улучшить ваши документы, сделав их более профессиональными и предоставив четкую запись того, когда они были созданы или изменены. 

## Часто задаваемые вопросы

### Могу ли я настроить формат даты в метке времени?
 Да, вы можете изменить`ToString`способ изменить формат даты по вашему желанию.

### Можно ли использовать Aspose.PDF бесплатно?
 Aspose.PDF предлагает бесплатную пробную версию, но для полного функционала вам необходимо приобрести лицензию. Вы можете получить временную лицензию[здесь](https://purchase.aspose.com/temporary-license/).

### Можно ли добавить несколько временных меток в PDF-файл?
 Конечно! Вы можете создать несколько`TextStamp` экземпляры и добавляйте их на разные страницы или в разные позиции PDF-файла.

### Что делать, если у меня нет Visual Studio?
Вы можете использовать любую среду разработки C# или текстовый редактор, но для запуска и отладки проекта рекомендуется Visual Studio.

### Где я могу найти больше примеров использования Aspose.PDF?
 Вы можете изучить больше примеров и руководств в[Документация Aspose.PDF](https://reference.aspose.com/pdf/net/).