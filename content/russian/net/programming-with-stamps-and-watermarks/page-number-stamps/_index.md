---
title: Штампы номеров страниц в PDF-файле
linktitle: Штампы номеров страниц в PDF-файле
second_title: Справочник по API Aspose.PDF для .NET
description: Узнайте, как добавлять штампы номеров страниц в PDF-файл с помощью Aspose.PDF для .NET.
type: docs
weight: 160
url: /ru/net/programming-with-stamps-and-watermarks/page-number-stamps/
---
В этом уроке мы шаг за шагом покажем вам, как добавлять штампы номеров страниц в PDF-файл с помощью Aspose.PDF для .NET. Мы воспользуемся предоставленным исходным кодом C#, чтобы открыть существующий PDF-документ, создать штамп номеров страниц, задать его свойства и добавить его на определенную страницу в PDF-файле.

## Шаг 1: Настройка среды

Прежде чем начать, убедитесь, что у вас есть следующее:

- Установленная среда разработки .NET.
- Библиотека Aspose.PDF для .NET, загруженная и указанная в вашем проекте.

## Шаг 2: Загрузка существующего PDF-документа

Первый шаг — загрузить существующий PDF-документ в ваш проект. Вот как это сделать:

```csharp
// Путь к каталогу документов.
string dataDir = "YOUR DOCUMENTS DIRECTORY";

// Откройте существующий PDF-документ
Document pdfDocument = new Document(dataDir + "PageNumberStamp.pdf");
```

Обязательно замените «КАТАЛОГ ВАШИХ ДОКУМЕНТОВ» фактическим путем к каталогу, в котором находится ваш PDF-документ.

## Шаг 3: Создание и настройка штампа нумерации страниц

Теперь, когда PDF-документ загружен, мы можем создать буфер нумерации страниц и настроить его в соответствии с нашими потребностями. Вот как:

```csharp
// Создать буфер номеров страниц
PageNumberStamp pageNumberStamp = new PageNumberStamp();

// Определите, находится ли буфер в фоновом режиме или нет.
pageNumberStamp.Background = false;

// Формат буфера нумерации страниц
pageNumberStamp.Format = "Page # of " + pdfDocument.Pages.Count;

// Нижнее поле буфера нумерации страниц
pageNumberStamp.BottomMargin = 10;

// Горизонтальное выравнивание буфера нумерации страниц
pageNumberStamp.HorizontalAlignment = HorizontalAlignment.Center;

// Начальный номер нумерации страниц
pageNumberStamp.StartingNumber = 1;

// Установить свойства текста буфера номера страницы
pageNumberStamp.TextState.Font = FontRepository.FindFont("Arial");
pageNumberStamp.TextState.FontSize = 14.0F;
pageNumberStamp.TextState.FontStyle = FontStyles.Bold;
pageNumberStamp.TextState.FontStyle = FontStyles.Italic;
pageNumberStamp.TextState.ForegroundColor = Color.Aqua;
```

Приведенный выше код создает штамп номера страницы со свойствами, такими как формат номера страницы, нижнее поле, горизонтальное выравнивание, начальный номер и свойства текста.

## Шаг 4: Добавление штампа номера страницы на определенную страницу

После настройки штампа номера страницы мы можем добавить его на определенную страницу документа PDF. Вот как:

```csharp
// Добавить буфер номера страницы к определенной странице
pdfDocument.Pages[1].AddStamp(pageNumberStamp);
```

Приведенный выше код добавляет штамп номера страницы на первую страницу документа PDF. Вы можете изменить номер страницы по мере необходимости.

## Шаг 5: Сохранение измененного PDF-документа

После добавления штампа номера страницы в документ PDF мы можем сохранить измененный документ PDF. Вот как:

```csharp
// Сохраните измененный PDF-документ.
pdfDocument.Save(dataDir + "PageNumberStamp_out.pdf");
```

Обязательно замените «КАТАЛОГ ВАШИХ ДОКУМЕНТОВ» фактическим путем к каталогу, в котором вы хотите сохранить отредактированный PDF-документ.

### Пример исходного кода для штампов номеров страниц с использованием Aspose.PDF для .NET 
```csharp

// Путь к каталогу документов.
string dataDir = "YOUR DOCUMENT DIRECTORY";

// Открыть документ
Document pdfDocument = new Document(dataDir+ "PageNumberStamp.pdf");

// Создать штамп номера страницы
PageNumberStamp pageNumberStamp = new PageNumberStamp();

// Является ли марка фоновой
pageNumberStamp.Background = false;
pageNumberStamp.Format = "Page # of " + pdfDocument.Pages.Count;
pageNumberStamp.BottomMargin = 10;
pageNumberStamp.HorizontalAlignment = HorizontalAlignment.Center;
pageNumberStamp.StartingNumber = 1;

// Установить свойства текста
pageNumberStamp.TextState.Font = FontRepository.FindFont("Arial");
pageNumberStamp.TextState.FontSize = 14.0F;
pageNumberStamp.TextState.FontStyle = FontStyles.Bold;
pageNumberStamp.TextState.FontStyle = FontStyles.Italic;
pageNumberStamp.TextState.ForegroundColor = Color.Aqua;

// Добавить штамп на определенную страницу
pdfDocument.Pages[1].AddStamp(pageNumberStamp);
dataDir = dataDir + "PageNumberStamp_out.pdf";

// Сохранить выходной документ
pdfDocument.Save(dataDir);
Console.WriteLine("\nPage number stamp added successfully.\nFile saved at " + dataDir);

```

## Заключение

Поздравляем! Вы узнали, как добавлять штампы номеров страниц в PDF-документ с помощью Aspose.PDF для .NET. Теперь вы можете персонализировать свои PDF-документы, добавляя понятные и информативные номера страниц.

### Часто задаваемые вопросы о штампах номеров страниц в PDF-файле

#### В: Что такое штамп номера страницы и как он используется для добавления номеров страниц в PDF-файл?

A: Штамп номера страницы — это функция в Aspose.PDF, которая позволяет добавлять динамические номера страниц на определенные страницы документа PDF. В этом руководстве это достигается путем создания объекта PageNumberStamp, настройки его свойств и добавления его на указанную страницу.

#### В: Каким образом предоставленный исходный код C# добавляет штампы номеров страниц в PDF-файл?

A: Код демонстрирует, как загрузить существующий PDF-документ, создать PageNumberStamp, задать различные свойства (такие как формат, шрифт, выравнивание и т. д.), а затем добавить штамп на определенную страницу. Штамп автоматически подсчитывает общее количество страниц и вставляет правильные номера страниц.

#### В: Могу ли я настроить внешний вид номера страницы, например стиль шрифта, цвет и размер?

A: Конечно, вы можете настроить внешний вид штампа номера страницы, изменив такие свойства, как шрифт, размер шрифта, стиль шрифта (жирный, курсив и т. д.) и цвет текста.

#### В: Можно ли добавить штампы номеров страниц на несколько страниц в документе PDF?

A: Да, вы можете добавить штампы номеров страниц на несколько страниц, создав несколько объектов PageNumberStamp и добавив каждый из них на нужные страницы.

#### В: Могу ли я выбрать, будет ли штамп с номером страницы отображаться как часть содержимого страницы или как фоновый элемент?

 A: Да, вы можете контролировать, будет ли штамп номера страницы отображаться как часть содержимого страницы или как фоновый элемент, установив`Background` свойство PageNumberStamp.

#### В: Как указать формат номера страницы, включая общее количество страниц?

 A: Код использует`Format`свойство PageNumberStamp для указания формата номера страницы. Макрос "# of" используется для представления общего количества страниц.

#### В: Что произойдет, если я добавлю один и тот же штамп с номером страницы на несколько страниц?

A: Добавление одного и того же экземпляра PageNumberStamp к нескольким страницам отобразит правильные номера страниц для каждой страницы. Штамп автоматически корректирует номер страницы и общее количество страниц.

#### В: Могу ли я добавить штампы номеров страниц в верхние или нижние колонтитулы PDF-документа?

A: Хотя PageNumberStamps обычно добавляются непосредственно к содержимому страницы, вы можете использовать FloatingBox или другие методы, чтобы разместить их в разделах верхнего или нижнего колонтитула.

#### В: Как указать положение штампа номера страницы на странице?

 А:`BottomMargin` и`HorizontalAlignment` Свойства PageNumberStamp позволяют контролировать положение штампа на странице.

#### В: Что делать, если я хочу начать нумерацию страниц с другой цифры, а не с 1?

 A: Вы можете установить`StartingNumber`свойство PageNumberStamp для указания номера начальной страницы.