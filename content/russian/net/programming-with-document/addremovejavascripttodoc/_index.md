---
title: Добавить Удалить Javascript в PDF-документ
linktitle: Добавить Удалить Javascript в документ
second_title: Справочник по API Aspose.PDF для .NET
description: Узнайте, как добавлять и удалять JavaScript в PDF-документе с помощью Aspose.PDF для .NET. Пошаговое руководство с обучающими материалами по коду для сценариев на уровне документа.
type: docs
weight: 30
url: /ru/net/programming-with-document/addremovejavascripttodoc/
---
## Введение

В этом руководстве мы рассмотрим, как использовать Aspose.PDF для .NET для вставки JavaScript в PDF-файл и как удалить его при необходимости. К концу этого руководства у вас будет четкое понимание того, как без усилий манипулировать JavaScript в PDF-файлах.

## Предпосылки

Прежде чем мы углубимся в код, вам необходимо настроить несколько вещей:

1.  Aspose.PDF для .NET: Вам понадобится библиотека Aspose.PDF для .NET, установленная в вашем проекте. Если у вас ее еще нет, возьмите библиотеку из[Страница загрузки Aspose.PDF для .NET](https://releases.aspose.com/pdf/net/).
2. IDE или текстовый редактор: вы можете использовать любую совместимую с .NET IDE, например Visual Studio.
3. Базовые знания C#: в этом руководстве предполагается, что вы хорошо разбираетесь в C# и знакомы с работой с PDF-файлами.
4. Лицензия: Обязательно используйте действующую лицензию, чтобы избежать ограничений. Вы можете получить временную лицензию от[здесь](https://purchase.aspose.com/temporary-license/).

## Импортные пакеты

Чтобы начать использовать Aspose.PDF для .NET, вам нужно импортировать необходимые пространства имен в ваш проект. Вот как:

```csharp
using System.IO;
using System;
using Aspose.Pdf;
using Aspose.Pdf.Annotations;
using Aspose.Pdf.Text;
using System.Collections;
```

 Эти два пространства имен имеют важное значение.`Aspose.Pdf` позволяет работать с PDF-документами, при этом`System.Collections` будет использоваться для обработки ключей JavaScript.

Давайте разберем весь процесс добавления и удаления JavaScript из PDF-файла на простые для понимания шаги.

## Шаг 1: Инициализация нового PDF-документа

Первое, что вам нужно сделать, это создать новый PDF-документ. Этот документ будет служить нам чистым холстом для добавления JavaScript.

```csharp
Document doc = new Document();
doc.Pages.Add();
```

 Здесь мы инициализируем новый`Document` объект и добавление к нему пустой страницы. Думайте об этом как о фундаменте вашего PDF.

## Шаг 2: Добавьте JavaScript в PDF-файл

Теперь, когда у нас есть документ, пришло время добавить в него немного JavaScript. JavaScript в PDF-файлах можно использовать для добавления пользовательских поведений, таких как оповещения или проверка форм.

```csharp
doc.JavaScript["func1"] = "function func1() { hello(); }";
doc.JavaScript["func2"] = "function func2() { hello(); }";
```

В этом фрагменте кода мы добавляем две функции JavaScript (`func1` и`func2` ) в PDF. Эти функции могут выполнять различные задачи в зависимости от ваших потребностей. Здесь мы просто вызываем функцию-заполнитель, называемую`hello()`.

## Шаг 3: Сохраните PDF-файл с помощью JavaScript

После добавления нужного JavaScript-кода пришло время сохранить PDF-файл.

```csharp
doc.Save(dataDir + "AddJavascript.pdf");
```

 Это сохранит документ с JavaScript под именем`AddJavascript.pdf` в указанном каталоге (`dataDir`).

## Шаг 4: Загрузка и просмотр JavaScript в существующем PDF-файле

Допустим, вам нужно проверить или изменить функции JavaScript в существующем PDF. Первым шагом является загрузка файла PDF и доступ к ключам JavaScript.

```csharp
Document doc1 = new Document(dataDir + "AddJavascript.pdf");
IList keys = (System.Collections.IList)doc1.JavaScript.Keys;
```

 Мы загружаем существующий`AddJavascript.pdf` и сохранение ключей JavaScript в списке.`Keys` Свойство возвращает имена всех функций JavaScript, прикрепленных к документу.

## Шаг 5: Отображение функций JavaScript

Далее мы можем выполнить итерацию по функциям JavaScript, чтобы увидеть, что доступно в документе.

```csharp
Console.WriteLine("=============================== ");
foreach (string key in keys)
{
    Console.WriteLine(key + " ==> " + doc1.JavaScript[key]);
}
```

Это выведет на консоль имя каждой функции JavaScript и соответствующий ей код. Это полезно, если вы хотите проверить, какие функции в данный момент находятся в документе.

## Шаг 6: Удалите JavaScript из PDF-файла

 Теперь предположим, что вы хотите удалить определенную функцию JavaScript, например`func1`. Вот как это можно сделать:

```csharp
doc1.JavaScript.Remove("func1");
Console.WriteLine("Key 'func1' removed ");
```

 The`Remove` Метод принимает имя функции JavaScript в качестве аргумента и удаляет ее из документа.

## Шаг 7: Проверка удаления JavaScript

 После удаления JavaScript вы можете перепечатать оставшиеся функции, чтобы убедиться, что`func1` успешно удален.

```csharp
Console.WriteLine("=============================== ");
foreach (string key in keys)
{
    Console.WriteLine(key + " ==> " + doc1.JavaScript[key]);
}
Console.WriteLine("Javascript added/removed successfully.");
```

Последняя часть кода гарантирует, что все на месте и функции JavaScript обновляются правильно.

## Заключение

Поздравляем! Вы только что узнали, как добавлять и удалять JavaScript из PDF-документа с помощью Aspose.PDF для .NET. Эта мощная функция может использоваться для различных задач, от добавления динамических сообщений до выполнения пользовательских вычислений или проверок. Манипулируя JavaScript в PDF-файле, вы можете значительно улучшить пользовательский опыт.

## Часто задаваемые вопросы

### Можно ли добавить несколько функций JavaScript в один PDF-файл?
 Конечно! Вы можете добавить столько функций JavaScript, сколько вам нужно, используя`doc.JavaScript` коллекция.

### Что произойдет, если я попытаюсь удалить несуществующую функцию JavaScript?
 Если функция не существует, то`Remove` метод не выдаст ошибку, но и ничего не удалит.

### Можно ли запустить JavaScript сразу после открытия PDF-файла?
Да! Вы можете настроить JavaScript для запуска при определенных триггерах, таких как открытие документа или нажатие кнопки.

### Могу ли я редактировать JavaScript после его добавления в PDF-файл?
Да, вы можете загрузить существующий PDF-файл, получить доступ к его JavaScript, изменить код и снова сохранить документ.

### Влияет ли удаление JavaScript на остальное содержимое PDF-файла?
Нет, удаление JavaScript влияет только на скрипт. Содержимое PDF остается неизменным.