---
title: Удалить гиперссылки после преобразования из HTML
linktitle: Удалить гиперссылки после преобразования из HTML
second_title: Справочник по API Aspose.PDF для .NET
description: Узнайте, как удалить гиперссылки из HTML-документов после преобразования в PDF с помощью Aspose.PDF для .NET, в этом пошаговом руководстве.
type: docs
weight: 250
url: /ru/net/document-conversion/remove-hyperlinks-after-converting-from-html/
---
## Введение

В цифровую эпоху преобразование HTML-документов в PDF является обычной задачей. Однако иногда вам может понадобиться удалить гиперссылки из преобразованного PDF по разным причинам, например, для улучшения читаемости или предотвращения нежелательной навигации. В этом руководстве мы рассмотрим, как добиться этого с помощью Aspose.PDF для .NET. 

## Предпосылки

Прежде чем приступить к изучению кода, убедитесь, что у вас выполнены следующие предварительные условия:

1. Visual Studio: Убедитесь, что на вашем компьютере установлена Visual Studio. Это будет ваша среда разработки.
2.  Aspose.PDF для .NET: Вам нужна библиотека Aspose.PDF. Вы можете загрузить ее с[здесь](https://releases.aspose.com/pdf/net/).
3. Базовые знания C#: знакомство с программированием на C# поможет вам лучше понимать код.

## Импортные пакеты

Для начала вам нужно импортировать необходимые пакеты в ваш проект C#. Вот как это можно сделать:

1. Откройте проект Visual Studio.
2. Щелкните правой кнопкой мыши свой проект в обозревателе решений и выберите «Управление пакетами NuGet».
3.  Искать`Aspose.PDF` и установите его.

```csharp
using Aspose.Pdf.Annotations;
using Aspose.Pdf.Text;
using System.IO;
```

Теперь, когда вы все настроили, давайте разберем процесс удаления гиперссылок из HTML-файла после его преобразования в PDF.

## Шаг 1: Настройте каталог документов

Прежде всего, вам нужно указать путь к каталогу ваших документов. Это то место, где находится ваш HTML-файл и где будет сохранен выходной PDF-файл.

```csharp
// Путь к каталогу документов.
string dataDir = "YOUR DOCUMENT DIRECTORY";
```

 Заменять`"YOUR DOCUMENT DIRECTORY"` на фактический путь, где хранится ваш HTML-файл.

## Шаг 2: Загрузите HTML-документ

 Далее вы загрузите HTML-документ с помощью`Document` класс из Aspose.PDF. Этот класс позволяет легко работать с PDF-документами.

```csharp
Document doc = new Document(dataDir + "SampleHtmlFile.html", new HtmlLoadOptions());
```

 Здесь мы загружаем HTML-файл с именем`SampleHtmlFile.html`. Убедитесь, что этот файл существует в указанном вами каталоге.

## Шаг 3: Сохраните документ в потоке памяти

Прежде чем начать обработку аннотаций, нам нужно сохранить документ в потоке памяти. Этот шаг имеет решающее значение, поскольку он подготавливает документ к дальнейшей обработке.

```csharp
doc.Save(new MemoryStream());
```

Эта строка сохраняет документ в памяти, позволяя нам работать с ним, не записывая его на диск.

## Шаг 4: Просмотрите аннотации

Теперь мы пройдемся по аннотациям в документе. Аннотации — это такие элементы, как ссылки, комментарии и выделения. Нас особенно интересуют аннотации-ссылки.

```csharp
foreach (Annotation a in doc.Pages[1].Annotations)
{
    if (a.AnnotationType == AnnotationType.Link)
    {
        // Обработать аннотацию ссылки
    }
}
```

В этом цикле мы проверяем, является ли тип аннотации ссылкой. Если это так, то переходим к следующим шагам.

## Шаг 5: Удалить действие гиперссылки

Для каждой аннотации ссылки нам нужно проверить, есть ли у нее действие гиперссылки. Если да, мы удалим гиперссылку, установив ее URI на пустую строку.

```csharp
LinkAnnotation la = (LinkAnnotation)a;
if (la.Action is GoToURIAction)
{
    GoToURIAction gta = (GoToURIAction)la.Action;
    gta.URI = "";
```

Этот фрагмент кода гарантирует эффективное удаление действия гиперссылки.

## Шаг 6: Усвоение фрагментов текста

Далее мы впитаем фрагменты текста, связанные с аннотацией ссылки. Это позволит нам манипулировать внешним видом текста.

```csharp
TextFragmentAbsorber tfa = new TextFragmentAbsorber();
tfa.TextSearchOptions = new TextSearchOptions(a.Rect);
doc.Pages[a.PageIndex].Accept(tfa);
```

 Здесь мы создаем`TextFragmentAbsorber` и установите его параметры поиска в прямоугольнике аннотации. Это помогает нам найти текст, который был связан.

## Шаг 7: Измените внешний вид текста

Получив фрагменты текста, мы можем изменить их внешний вид. В этом случае мы удалим подчеркивание и изменим цвет текста на черный.

```csharp
foreach (TextFragment tf in tfa.TextFragments)
{
    tf.TextState.Underline = false;
    tf.TextState.ForegroundColor = Color.Black;
}
```

Этот шаг повышает читабельность текста за счет удаления оформления гиперссылок.

## Шаг 8: Удалить аннотацию

После изменения текста мы можем безопасно удалить аннотацию ссылки из документа.

```csharp
doc.Pages[a.PageIndex].Annotations.Delete(a);
}
```

Эта строка удаляет гиперссылку из PDF-файла, гарантируя, что она больше не будет существовать в конечном выводе.

## Шаг 9: Сохраните измененный документ.

Наконец, нам нужно сохранить измененный документ в новый PDF-файл. Это последний шаг в нашем процессе.

```csharp
doc.Save(dataDir + "RemoveHyperlinksFromText_out.pdf");
```

 Эта строка сохраняет документ с удаленными гиперссылками, создавая новый PDF-файл с именем`RemoveHyperlinksFromText_out.pdf`.

## Заключение

И вот оно! Вы успешно удалили гиперссылки из HTML-документа после его преобразования в PDF с помощью Aspose.PDF для .NET. Этот процесс не только повышает читабельность вашего PDF, но и дает вам контроль над представляемым вами контентом. 

## Часто задаваемые вопросы

### Можно ли удалить гиперссылки из любого PDF-документа?
Да, вы можете удалить гиперссылки из любого PDF-документа с помощью Aspose.PDF для .NET.

### Можно ли использовать Aspose.PDF бесплатно?
 Aspose.PDF предлагает бесплатную пробную версию, но для полного использования функций вам необходимо приобрести лицензию. Проверьте[купить страницу](https://purchase.aspose.com/buy).

### Что делать, если у меня возникнут проблемы при использовании Aspose.PDF?
 Вы можете обратиться за помощью по адресу[форум поддержки](https://forum.aspose.com/c/pdf/10).

### Можно ли конвертировать другие форматы файлов в PDF с помощью Aspose?
Да, Aspose поддерживает различные форматы файлов для преобразования в PDF.

### Где можно скачать Aspose.PDF для .NET?
 Вы можете скачать его с сайта[ссылка для скачивания](https://releases.aspose.com/pdf/net/).