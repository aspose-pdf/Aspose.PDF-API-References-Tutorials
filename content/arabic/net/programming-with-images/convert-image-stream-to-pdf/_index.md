---
title: تحويل تدفق الصور إلى ملف PDF
linktitle: تحويل تدفق الصور إلى ملف PDF
second_title: مرجع واجهة برمجة التطبيقات Aspose.PDF لـ .NET
description: يمكنك تحويل تدفق الصور إلى PDF بسهولة باستخدام Aspose.PDF for .NET من خلال هذا الدليل المفصل خطوة بخطوة. تعرّف على كيفية التعامل مع تحويلات الصور إلى PDF دون عناء.
type: docs
weight: 70
url: /ar/net/programming-with-images/convert-image-stream-to-pdf/
---
## مقدمة

هل تساءلت يومًا عن كيفية تحويل تدفق الصور مباشرةً إلى ملف PDF؟ سواء كنت تبحث عن أرشفة الصور أو مشاركة المستندات أو إعداد العروض التقديمية، فإن تحويل الصور إلى ملفات PDF يعد حيلة قيمة يجب أن تكون في جعبتك. لحسن الحظ، باستخدام Aspose.PDF لـ .NET، فإن هذه العملية ليست مباشرة فحسب، بل إنها مرنة وفعالة أيضًا.

في هذا البرنامج التعليمي، سنرشدك خطوة بخطوة حول كيفية تحويل تدفق الصور إلى ملف PDF باستخدام Aspose.PDF لـ .NET. سنبدأ بإعداد البيئة اللازمة، ثم نستعرض التعليمات البرمجية في أجزاء صغيرة، ونشرح كل خطوة بالتفصيل.

## المتطلبات الأساسية

قبل أن نتعمق في الكود، دعنا نتأكد من أن لديك كل ما تحتاجه للمتابعة:

1.  Aspose.PDF لـ .NET: أولاً وقبل كل شيء، ستحتاج إلى تثبيت مكتبة Aspose.PDF. يمكنك شراؤها أو شرائها من متجر Google Play.[هنا](https://purchase.aspose.com/buy) أو إذا كنت تريد فقط تجربته، فاحصل على[نسخة تجريبية مجانية](https://releases.aspose.com/pdf/net/).
2. بيئة التطوير: ستحتاج إلى بيئة تطوير متكاملة مثل Visual Studio مع تثبيت .NET.
3.  ترخيص صالح: للاستفادة من الإمكانات الكاملة لبرنامج Aspose.PDF، تحتاج إلى ترخيص صالح. يمكنك التقدم بطلب للحصول على ترخيص صالح.[رخصة مؤقتة](https://purchase.aspose.com/temporary-license/) إذا لم يكن لديك واحدة بعد.
4. المعرفة الأساسية بلغة C#: نظرًا لأن هذا البرنامج التعليمي يعتمد على لغة C#، فمن المفيد أن يكون لديك بعض الألفة مع اللغة.

## استيراد الحزم

قبل كتابة التعليمات البرمجية، تحتاج إلى استيراد مساحات الأسماء الضرورية. وهي ضرورية للعمل مع تدفقات الملفات، وتدفقات الذاكرة، ومستند PDF نفسه.

```csharp
using System.IO;
using Aspose.Pdf;
```

الآن، دعونا نقوم بتقسيم العملية خطوة بخطوة، حتى تتمكن من متابعتها بسهولة.

## الخطوة 1: تعيين مسار الدليل

أول شيء يتعين علينا القيام به هو تحديد المسار إلى المجلد الذي يتم تخزين ملف صورتك فيه. وهذا يضمن إمكانية الوصول إلى الصورة بشكل صحيح للتحويل.

```csharp
string dataDir = "YOUR DOCUMENT DIRECTORY";
```

 يستبدل`"YOUR DOCUMENT DIRECTORY"` مع الدليل الفعلي الذي يوجد به ملف الصورة. سيسمح هذا للبرنامج بتحديد موقع الصورة ومعالجتها للتحويل.

## الخطوة 2: إنشاء مستند PDF

 بعد ذلك، نقوم بإنشاء مستند PDF فارغ والذي سيحتوي في النهاية على صورتنا. باستخدام`Aspose.Pdf.Document` منشئ، نقوم بتهيئة مستند فارغ.

```csharp
Aspose.Pdf.Document pdf1 = new Aspose.Pdf.Document();
```

 هنا، نقوم بإنشاء مثيل جديد`Document` الكائن باستخدام مكتبة Aspose.PDF. سيحمل هذا الكائن بنية PDF، حيث يمكننا لاحقًا إدراج الصورة.

## الخطوة 3: إضافة صفحة جديدة إلى ملف PDF

بمجرد إنشاء المستند، نحتاج إلى إضافة صفحة إليه. هذا هو المكان الذي سيتم وضع صورتنا فيه.

```csharp
Aspose.Pdf.Page sec = pdf1.Pages.Add();
```

 ال`Pages.Add()` تنشئ الطريقة صفحة جديدة داخل مستند PDF الخاص بنا. فكر في هذه الصفحة على أنها لوحة قماشية فارغة حيث سيتم وضع الصورة.

## الخطوة 4: افتح ملف الصورة كدفق

 قبل أن نقوم بإدراج الصورة في ملف PDF، نحتاج إلى قراءتها من نظام الملفات. نقوم بذلك عن طريق إنشاء`FileStream` لفتح ملف الصورة.

```csharp
FileStream fs = File.OpenRead(dataDir + "aspose.jpg");
```

 ال`FileStream` يقرأ ملف الصورة من الدليل المحدد في`dataDir` تأكد من صحة اسم ملف الصورة - هنا نستخدم`aspose.jpg`.

## الخطوة 5: تحويل الصورة إلى مصفوفة بايتات

للتلاعب بالصورة، نقوم بتحويلها إلى مصفوفة بايتات، والتي يمكن معالجتها بسهولة أكبر بواسطة البرنامج.

```csharp
byte[] data = new byte[fs.Length];
fs.Read(data, 0, data.Length);
```

 نقوم بإنشاء مصفوفة بايتات تحتوي على بيانات ملف الصورة بالكامل.`fs.Read()` تقوم الطريقة بقراءة بيانات الصورة في المصفوفة، والتي سيتم تمريرها بعد ذلك للتحويل.

## الخطوة 6: إنشاء كائن MemoryStream

 بعد تحويل الصورة إلى مصفوفة بايتات، نقوم بتحميلها إلى`MemoryStream`هذه الخطوة ضرورية لإدراج الصورة في ملف PDF.

```csharp
MemoryStream ms = new MemoryStream(data);
```

 من خلال تخزين بيانات الصورة في`MemoryStream`نقوم بإعداده لإضافته إلى مستند PDF. يعمل هذا التدفق كذاكرة وسيطة للصورة.

## الخطوة 7: إنشاء كائن الصورة

الآن، حان الوقت لإنشاء كائن صورة يحمل الصورة التي نخطط لإضافتها إلى ملف PDF.

```csharp
Aspose.Pdf.Image imageht = new Aspose.Pdf.Image();
```

 ال`Image` يتم استخدام الفئة من مكتبة Aspose.PDF لتمثيل الصورة التي سيتم تضمينها في ملف PDF.`imageht` الكائن هو في الأساس عنصر نائب للصورة في ملف PDF.

## الخطوة 8: تعيين مصدر الصورة كـ MemoryStream

الآن بعد أن أصبح لدينا كائن الصورة وبيانات الصورة في مجرى الذاكرة، يمكننا ربط الاثنين معًا.

```csharp
imageht.ImageStream = ms;
```

 لقد وضعنا`ImageStream` خاصية كائن الصورة إلى مجرى الذاكرة الذي يحتوي على بيانات الصورة. وهذا يخبر مستند PDF من أين يمكن استرداد الصورة.

## الخطوة 9: أضف الصورة إلى صفحة PDF

وبعد أن أصبح كائن الصورة جاهزًا، نضيفه إلى مجموعة الفقرات الخاصة بالصفحة التي أنشأناها سابقًا.

```csharp
sec.Paragraphs.Add(imageht);
```

 ال`Paragraphs.Add()`تقوم الطريقة بإدراج كائن الصورة في الصفحة، والتي ستعرض الصورة عند فتح ملف PDF.

## الخطوة 10: احفظ ملف PDF

وأخيرًا، نحفظ مستند PDF مع الصورة المضمنة في داخله.

```csharp
pdf1.Save(dataDir + "ConvertMemoryStreamImageToPdf_out.pdf");
```

 ال`Save()` تقوم الطريقة بإخراج ملف PDF بالاسم المحدد. هنا، يتم حفظ ملف PDF باسم`ConvertMemoryStreamImageToPdf_out.pdf` في نفس الدليل مثل ملف الصورة.

## الخطوة 11: إغلاق MemoryStream

من الأفضل دائمًا إغلاق التدفقات بمجرد الانتهاء منها لتحرير الموارد.

```csharp
ms.Close();
```

إغلاق`MemoryStream` يحرر الذاكرة التي كان يستخدمها، وهو أمر ضروري لإدارة الموارد بكفاءة.

## خاتمة

إن تحويل تدفق الصور إلى ملف PDF باستخدام Aspose.PDF for .NET هو وسيلة مرنة وقوية بشكل لا يصدق للتعامل مع تحويلات الصور إلى PDF. سواء كنت تعمل مع دفعات كبيرة من الصور أو ملف واحد، فإن هذا الدليل خطوة بخطوة يوفر نهجًا واضحًا وسهل المتابعة. من خلال هذه العملية، يمكنك دمج وظيفة تحويل الصور إلى PDF في تطبيقاتك دون عناء.

## الأسئلة الشائعة

### ما هي تنسيقات الملفات التي يدعمها Aspose.PDF لتحويل الصور؟
يدعم Aspose.PDF تنسيقات الصور المختلفة مثل JPEG، PNG، BMP، GIF، والمزيد.

### هل يمكنني إضافة صور متعددة إلى ملف PDF واحد باستخدام هذه الطريقة؟
 نعم، يمكنك تكرار عملية إضافة الصور إلى نفس ملف PDF عن طريق إنشاء ملفات إضافية`Image` الأشياء لكل صورة.

### هل استخدام Aspose.PDF مجاني؟
 Aspose.PDF هو منتج مدفوع، ولكن يمكنك تجربته مجانًا عن طريق تنزيله[نسخة تجريبية](https://releases.aspose.com/pdf/net/).

### كيف يمكنني الحصول على ترخيص مؤقت لـ Aspose.PDF؟
 يمكنك التقدم بطلب للحصول على[رخصة مؤقتة](https://purchase.aspose.com/temporary-license/) لأغراض الاختبار.

### هل يدعم Aspose.PDF ملفات PDF المحمية بكلمة مرور؟
نعم، يسمح لك Aspose.PDF بإنشاء ملفات PDF محمية بكلمة مرور ومعالجتها.