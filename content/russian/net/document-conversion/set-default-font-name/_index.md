---
title: Установить имя шрифта по умолчанию
linktitle: Установить имя шрифта по умолчанию
second_title: Справочник по API Aspose.PDF для .NET
description: Узнайте, как задать имя шрифта по умолчанию при рендеринге PDF-файлов в изображения с помощью Aspose.PDF для .NET. Это руководство охватывает предварительные условия, пошаговые инструкции и часто задаваемые вопросы.
type: docs
weight: 270
url: /ru/net/document-conversion/set-default-font-name/
---
## Введение

Вы когда-нибудь пытались преобразовать PDF-документ в изображение, но обнаружили, что шрифты выглядят неправильно? Возможно, текст выглядит искаженным, или исходный шрифт не поддерживается. Вот где установка шрифта по умолчанию может спасти положение! Используя Aspose.PDF для .NET, вы можете легко установить шрифт по умолчанию для вашего PDF-рендеринга, гарантируя, что ваш документ будет выглядеть четким и профессиональным. В этом руководстве мы расскажем вам, как установить имя шрифта по умолчанию при преобразовании PDF-файла в изображение. К концу этого руководства вы будете обладать навыками, которые позволят вам справиться с любыми проблемами преобразования PDF-файла, которые могут возникнуть на вашем пути. Готовы? Давайте погрузимся в это!

## Предпосылки

Прежде чем перейти к коду, вам необходимо выполнить несколько действий:

- Aspose.PDF для .NET: Эта мощная библиотека — то, что мы будем использовать для управления нашим PDF-документом. Вы можете загрузить ее с[Сайт Aspose](https://releases.aspose.com/pdf/net/).
- Visual Studio: Убедитесь, что на вашем компьютере установлена Visual Studio. Это будет наша среда разработки.
- .NET Framework: Убедитесь, что у вас установлен .NET Framework. Aspose.PDF для .NET поддерживает различные версии, поэтому проверьте документацию, чтобы она соответствовала вашим потребностям.
- Документ PDF: Вам понадобится образец документа PDF для работы. Если у вас его нет, создайте простой PDF или загрузите образец онлайн.

Как только вы все настроите, мы готовы приступить к кодированию!

## Импортные пакеты

Прежде чем погрузиться в код, необходимо импортировать необходимые пакеты. Это гарантирует нам доступ ко всем классам и методам, которые нам нужны для нашего проекта.

```csharp
using Aspose.Pdf.Devices;
using System;
using System.Collections.Generic;
using System.IO;
using System.Linq;
using System.Text;
```

Этот импорт имеет решающее значение, поскольку он обеспечивает необходимые пространства имен для обработки PDF-файлов, рендеринга изображений и потоковых операций с файлами.

## Шаг 1: Настройте свой проект и путь к документу

Для начала давайте настроим путь к каталогу, где находится ваш PDF-документ. Это будет вашей отправной точкой для манипуляций с PDF-файлом.

```csharp
// Путь к каталогу документов.
string dataDir = "YOUR DOCUMENT DIRECTORY";
```
 Здесь,`dataDir` это каталог, где находится ваш PDF-документ. Обязательно замените`"YOUR DOCUMENT DIRECTORY"` с фактическим путем к вашему документу. Это важно, так как код должен знать, откуда извлекать файл PDF.

## Шаг 2: Загрузите PDF-документ

Теперь, когда у нас есть путь к документу, следующим шагом будет загрузка PDF-документа в память, чтобы мы могли начать работать с ним.

```csharp
using (Document pdfDocument = new Document(dataDir + "input.pdf"))
```
 Мы используем`Document` класс из библиотеки Aspose.PDF для загрузки нашего PDF-файла. Этот класс предоставляет различные методы и свойства для работы с PDF-документом.`"input.pdf"` следует заменить на фактическое имя файла PDF. Этот файл будет использоваться в качестве входных данных для рендеринга.

## Шаг 3: Создание потока изображений для вывода

После загрузки документа нам нужно настроить поток для сохранения отрендеренного изображения. Здесь будет храниться выходное изображение.

```csharp
using (FileStream imageStream = new FileStream(dataDir + "SetDefaultFontName.png", FileMode.Create))
```
 The`FileStream`класс используется для создания нового файла, в котором будет сохранено отрендеренное изображение. В этом примере мы сохраняем изображение как`"SetDefaultFontName.png"` .`FileMode.Create` обеспечивает создание нового файла или перезапись существующего файла.

## Шаг 4: Установите разрешение изображения.

Перед тем, как преобразовать PDF в изображение, важно установить разрешение. Это определяет качество и четкость выходного изображения.

```csharp
Resolution resolution = new Resolution(300);
```
 The`Resolution` class задает разрешение выходного изображения. Здесь мы выбрали разрешение 300 DPI (точек на дюйм), что является стандартным для высококачественных изображений. Это гарантирует, что текст и графика в вашем PDF будут отображаться четко, без потери деталей.

## Шаг 5: Настройте устройство PNG

Далее нам необходимо настроить устройство, которое будет обрабатывать преобразование PDF-файла в изображение PNG.

```csharp
PngDevice pngDevice = new PngDevice(resolution);
```
 The`PngDevice` класс отвечает за преобразование PDF-документа в изображение PNG. Передавая`resolution` возражаем против этого, мы гарантируем, что изображение будет создано с указанным DPI.

## Шаг 6: Установите имя шрифта по умолчанию

Вот критическая часть – установка имени шрифта по умолчанию. Это будет резервный шрифт в случае, если исходный шрифт в PDF недоступен.

```csharp
RenderingOptions ro = new RenderingOptions();
ro.DefaultFontName = "Arial";
pngDevice.RenderingOptions = ro;
```
 Мы создаем экземпляр`RenderingOptions` и установите его`DefaultFontName` собственность`"Arial"`. Это означает, что если исходный шрифт в PDF не может быть найден, вместо него будет использоваться Arial. Этот шаг имеет решающее значение для сохранения читаемости и внешнего вида текста в визуализированном изображении.

## Шаг 7: Преобразование страницы PDF в изображение

Наконец, когда все настроено, мы можем преобразовать первую страницу PDF-документа в изображение и сохранить его с помощью созданного ранее файлового потока.

```csharp
pngDevice.Process(pdfDocument.Pages[1], imageStream);
```
 The`Process` Метод`PngDevice` класс используется для рендеринга указанной страницы PDF (в данном случае первой страницы) в изображение. Затем вывод сохраняется в`imageStream`. На этом этапе страница PDF преобразуется в изображение PNG с указанным разрешением и шрифтом по умолчанию.

## Шаг 8: Закройте поток файлов и PDF-документ.

После рендеринга изображения необходимо закрыть файловый поток и PDF-документ, чтобы освободить ресурсы.

```csharp
imageStream.Close();
pdfDocument.Dispose();
```
Закрытие`imageStream` гарантирует, что файл будет сохранен правильно и данные не будут утеряны.`pdfDocument` освобождает память и ресурсы, предотвращая возможные утечки памяти.

## Заключение

И вот оно! Всего несколько строк кода — и вы узнали, как задать имя шрифта по умолчанию при рендеринге PDF в изображение с помощью Aspose.PDF для .NET. Этот навык невероятно полезен, особенно при работе с PDF, которые могут содержать неподдерживаемые шрифты. Установив шрифт по умолчанию, вы гарантируете, что ваши рендеринговые изображения сохранят свою читабельность и профессиональный вид.

## Часто задаваемые вопросы

### Что произойдет, если указанный шрифт по умолчанию не установлен в системе?
 Если шрифт по умолчанию указан в`RenderingOptions` не установлен в системе, Aspose.PDF будет использовать резервный шрифт, определенный системой.

### Могу ли я использовать в качестве шрифта по умолчанию другие шрифты, кроме Arial?
Конечно! Вы можете установить любой шрифт, установленный в вашей системе, в качестве шрифта по умолчанию.

### Можно ли преобразовать несколько страниц PDF-файла в изображения за один раз?
Да, вы можете просматривать страницы PDF-файла и обрабатывать каждую страницу по отдельности, используя тот же процесс.

### Влияет ли установка высокого разрешения на производительность рендеринга PDF-файлов?
Да, более высокое разрешение приведет к увеличению размера файлов изображений и может увеличить время рендеринга, но при этом будут создаваться более четкие изображения.

### Могу ли я преобразовать PDF-файл в другие форматы изображений, помимо PNG?
Да, Aspose.PDF поддерживает рендеринг в различные форматы изображений, такие как JPEG, BMP и TIFF.