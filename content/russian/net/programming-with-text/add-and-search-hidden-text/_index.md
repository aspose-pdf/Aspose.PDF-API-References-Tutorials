---
title: Добавление и поиск скрытого текста в PDF-файле
linktitle: Добавление и поиск скрытого текста в PDF-файле
second_title: Справочник по API Aspose.PDF для .NET
description: Научитесь добавлять и искать скрытый текст в документах PDF с помощью Aspose.PDF для .NET. Пошаговое руководство с примерами кода.
type: docs
weight: 20
url: /ru/net/programming-with-text/add-and-search-hidden-text/
---
## Введение

В этом уроке мы проведем вас через пошаговое руководство по добавлению и поиску скрытого текста в файле PDF с помощью Aspose.PDF для .NET. Независимо от того, являетесь ли вы опытным разработчиком или новичком, желающим улучшить свои навыки программирования, эта статья предоставит вам необходимые знания для внедрения функциональности скрытого текста в ваши приложения.

## Предпосылки

Прежде чем приступить к написанию кода, необходимо выполнить несколько предварительных условий:

### Контрольный список требований
- Visual Studio: Убедитесь, что у вас установлена Visual Studio. В этом руководстве предполагается, что вы используете .NET Framework.
-  Aspose.PDF for .NET: Вам нужна библиотека Aspose.PDF for .NET. Вы можете скачать ее[здесь](https://releases.aspose.com/pdf/net/).
- Базовые знания C#: знакомство с программированием на C# поможет вам лучше понимать фрагменты кода.

## Импортные пакеты

Прежде чем вы сможете начать работу с кодом, вам нужно убедиться, что вы импортируете необходимые пространства имен Aspose.PDF. Вот как это сделать:

### Настройте свой проект
1. Откройте Visual Studio и создайте новый проект C# или используйте существующий.
2.  Установите Aspose.PDF, добавив пакет NuGet. Вы можете сделать это, перейдя в диспетчер пакетов NuGet и выполнив поиск`Aspose.PDF`. 
3.  Кроме того, вы можете напрямую загрузить библиотеку с сайта[здесь](https://releases.aspose.com/pdf/net/) и добавьте его в качестве ссылки в свой проект.

### Импорт требуемых пространств имен
В верхней части файла C# импортируйте следующие пространства имен:

```csharp
using Aspose.Pdf.Text;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
```

Этот шаг имеет решающее значение, поскольку эти пространства имен содержат классы и методы, необходимые для работы с PDF-документами.

## Создание PDF-документа со скрытым текстом

Теперь, когда все готово, давайте рассмотрим шаги по созданию PDF-документа, содержащего как видимый, так и невидимый текст.

### Шаг 1: Определите каталог документов
Сначала вам нужно будет настроить путь, по которому будет сохранен PDF. Вот тут-то и начинается волшебство!

```csharp
string dataDir = "YOUR DOCUMENT DIRECTORY"; // Измените это на ваш каталог
```

 Эта строка определяет, где будет храниться ваш сгенерированный PDF. Не забудьте заменить`YOUR DOCUMENT DIRECTORY` с вашим реальным путем.

### Шаг 2: Создайте PDF-документ
Далее давайте создадим новый PDF-документ и добавим в него страницы.

```csharp
Aspose.Pdf.Document doc = new Aspose.Pdf.Document();
Page page = doc.Pages.Add();
```

Здесь мы инициализируем новый документ и добавляем страницу, на которой будем размещать наши текстовые фрагменты.

### Шаг 3: Добавьте видимый и скрытый текст
Теперь мы добавим в наш PDF-файл как видимый, так и невидимый текст.

```csharp
TextFragment frag1 = new TextFragment("This is common text.");
TextFragment frag2 = new TextFragment("This is invisible text.");
```

 В этом фрагменте`frag1` будет видно, тогда как`frag2` будет установлен как невидимый далее.

### Шаг 4: Сделайте текст невидимым
 Чтобы сделать текст`frag2` невидимый, вы просто изменяете его`TextState`.

```csharp
frag2.TextState.Invisible = true;
```

 При установке этого свойства любой текст, связанный с`frag2` не будет отображаться при просмотре PDF-файла.

### Шаг 5: Добавьте фрагменты текста на страницу
Наконец, мы добавляем эти текстовые фрагменты на страницу и сохраняем PDF-файл.

```csharp
page.Paragraphs.Add(frag1);
page.Paragraphs.Add(frag2);
doc.Save(dataDir + "39400_out.pdf");
doc.Dispose();
```

Эта часть кода добавляет наши текстовые фрагменты на страницу. После этого мы сохраняем и утилизируем документ должным образом.

## Поиск скрытого текста в PDF-файле

Теперь, когда мы создали наш PDF с видимым и скрытым текстом, как нам искать этот скрытый текст? Давайте разберемся.

### Шаг 1: Загрузите PDF-документ
Чтобы выполнить поиск текста в PDF-файле, нам сначала нужно загрузить документ, который мы только что создали.

```csharp
doc = new Aspose.Pdf.Document(dataDir + "39400_out.pdf");
```

### Шаг 2: Создание поглотителя фрагментов текста
 Мы будем использовать`TextFragmentAbsorber` для захвата всех фрагментов текста в PDF-файле.

```csharp
TextFragmentAbsorber absorber = new TextFragmentAbsorber();
absorber.Visit(doc.Pages[1]);
```

Здесь мы указываем, что хотим поглотить все фрагменты текста с первой страницы.

### Шаг 3: Перебор фрагментов
Теперь мы можем перебрать собранные фрагменты текста, чтобы выяснить, какие из них видны, а какие скрыты.

```csharp
foreach (TextFragment fragment in absorber.TextFragments)
{
    Console.WriteLine("Text '{0}' on pos {1} invisibility: {2}",
        fragment.Text, fragment.Position.ToString(), fragment.TextState.Invisible);
}
```

 Этот цикл проверяет каждый фрагмент текста и выводит его содержимое вместе с его позицией и статусом видимости. Если`fragment.TextState.Invisible` установлено значение true, это означает, что текст скрыт!

### Шаг 4: Утилизируйте документ
Наконец, не забудьте избавиться от документа, как только закончите работу.

```csharp
doc.Dispose();
```

## Заключение

В этом уроке мы прошли через захватывающий процесс добавления и поиска скрытого текста в PDF-файлах с помощью Aspose.PDF для .NET. Мы узнали, как создать PDF-документ с видимым и скрытым текстом, а также как искать этот скрытый текст программным способом. Эта возможность может быть невероятно полезна в различных приложениях, независимо от того, нужно ли вам хранить конфиденциальную информацию или предоставлять уникальный пользовательский интерфейс в ваших документах.

По мере того, как вы все больше знакомитесь с ASPose.PDF, возможности становятся безграничными. Продолжайте экспериментировать и расширять границы того, чего вы можете достичь с помощью ваших PDF-документов!

## Часто задаваемые вопросы

### Может ли Aspose.PDF обрабатывать зашифрованные PDF-файлы?  
Да, Aspose.PDF поддерживает шифрование и дешифрование PDF-документов. Вы можете легко защитить свои PDF-файлы паролями.

### Существует ли пробная версия Aspose.PDF?  
 Конечно! Вы можете загрузить бесплатную пробную версию с сайта[здесь](https://releases.aspose.com/).

### Какие языки программирования поддерживает Aspose.PDF?  
Aspose.PDF поддерживает несколько языков, включая C#, Java и Python.

### Где я могу найти документацию по Aspose.PDF?  
 Вы можете получить доступ к документации[здесь](https://reference.aspose.com/pdf/net/).

### Как я могу получить поддержку, если у меня возникнут проблемы?  
 Для получения поддержки вы можете посетить форумы Aspose.[здесь](https://forum.aspose.com/c/pdf/10).