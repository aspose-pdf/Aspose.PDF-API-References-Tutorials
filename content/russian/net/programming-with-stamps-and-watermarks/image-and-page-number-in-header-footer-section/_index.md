---
title: Изображение и номер страницы в разделе «Верхний и нижний колонтитулы»
linktitle: Изображение и номер страницы в разделе «Верхний и нижний колонтитулы»
second_title: Справочник по API Aspose.PDF для .NET
description: Узнайте, как добавить изображение и номер страницы в верхний и нижний колонтитулы PDF-документа с помощью Aspose.
type: docs
weight: 110
url: /ru/net/programming-with-stamps-and-watermarks/image-and-page-number-in-header-footer-section/
---
В этом уроке мы шаг за шагом покажем вам, как добавить изображение и номер страницы в раздел верхнего и нижнего колонтитула документа PDF с помощью Aspose.PDF для .NET. Мы покажем вам, как использовать предоставленный исходный код C# для создания страницы, задать верхний и нижний колонтитулы, добавить изображение в верхний колонтитул и текст с номером страницы в нижний колонтитул документа PDF.

## Шаг 1: Настройка среды

Прежде чем начать, убедитесь, что у вас есть следующее:

- Установленная среда разработки .NET.
- Библиотека Aspose.PDF для .NET, загруженная и указанная в вашем проекте.

## Шаг 2: Создание PDF-документа и страницы

Первый шаг — создать новый объект Document и страницу в документе PDF. Вот как это сделать:

```csharp
// Путь к каталогу документов.
string dataDir = "YOUR DOCUMENTS DIRECTORY";

// Создать новый объект документа
Aspose.Pdf.Document doc = new Aspose.Pdf.Document();

// Создать страницу в документе
Aspose.Pdf.Page page = doc.Pages.Add();
```

Приведенный выше код создает новый объект Document и пустую страницу в PDF-документе.

## Шаг 3: Добавление заголовка с изображением

Теперь, когда страница создана, мы можем добавить раздел заголовка с изображением. Вот как:

```csharp
// Создать раздел заголовка
Aspose.Pdf.HeaderFooter header = new Aspose.Pdf.HeaderFooter();

// Установить заголовок страницы
page. Header = header;

// Создать объект изображения
Aspose.Pdf.Image image1 = new Aspose.Pdf.Image();

// Установить путь к изображению
image1.File = dataDir + "aspose-logo.jpg";

// Добавьте изображение в заголовок страницы PDF-документа.
header.Paragraphs.Add(image1);
```

Приведенный выше код создает раздел заголовка, устанавливает заголовок страницы с этим разделом и добавляет изображение в заголовок.

## Шаг 4: Добавление нижнего колонтитула с номером страницы

Теперь, когда заголовок добавлен, мы можем добавить раздел нижнего колонтитула с номером страницы. Вот как:

```csharp
// Создать раздел нижнего колонтитула
Aspose.Pdf.HeaderFooter footer = new Aspose.Pdf.HeaderFooter();

// Определите нижний колонтитул PDF-документа
page. Footer = footer;

// Создать объект TextFragment
Aspose.Pdf.Text.TextFragment txt = new Aspose.Pdf.Text.TextFragment("Page: ($p of $P)");

// Добавьте текст с номером страницы в нижний колонтитул PDF-документа.
footer.Paragraphs.Add(txt);
```

Приведенный выше код создает раздел нижнего колонтитула, устанавливает нижний колонтитул страницы с этим разделом и добавляет TextFragment, содержащий текст «Страница: ($p из $P )».

  который отображает номер страницы.

## Шаг 5: Сохранение измененного PDF-документа

После добавления верхнего и нижнего колонтитулов мы можем сохранить измененный PDF-документ. Вот как это сделать:

```csharp
// Сохраните измененный PDF-документ.
doc.Save(dataDir + "ImageAndPageNumberInHeaderFooter_out.pdf");
```

Приведенный выше код сохраняет отредактированный PDF-документ в указанном каталоге.

### Пример исходного кода для изображения и номера страницы в разделе «Заголовок и нижний колонтитул» с использованием Aspose.PDF для .NET 
```csharp

// Путь к каталогу документов.
string dataDir = "YOUR DOCUMENT DIRECTORY";
Aspose.Pdf.Document doc = new Aspose.Pdf.Document();

// Создать страницу в объекте документа
Aspose.Pdf.Page page = doc.Pages.Add();

// Создать раздел заголовка документа
Aspose.Pdf.HeaderFooter header = new Aspose.Pdf.HeaderFooter();

// Установить заголовок для PDF-файла
page.Header = header;

// Создать объект изображения на странице
Aspose.Pdf.Image image1 = new Aspose.Pdf.Image();

// Укажите путь к файлу изображения
image1.File = dataDir + "aspose-logo.jpg";

// Добавить изображение на главную страницу файла PDF
header.Paragraphs.Add(image1);

//Создать раздел нижнего колонтитула документа
Aspose.Pdf.HeaderFooter footer = new Aspose.Pdf.HeaderFooter();

// Установить нижний колонтитул PDF-файла
page.Footer = footer;

// Создать текстовый объект
Aspose.Pdf.Text.TextFragment txt = new Aspose.Pdf.Text.TextFragment("Page: ($p of $P ) ");

// Добавить текст в раздел «Заголовок» файла PDF
footer.Paragraphs.Add(txt);

// Сохраните PDF-файл
doc.Save(dataDir + "ImageAndPageNumberInHeaderFooter_out.pdf");

```

## Заключение

Поздравляем! Вы узнали, как добавить изображение и номер страницы в раздел верхнего и нижнего колонтитула документа PDF с помощью Aspose.PDF для .NET. Теперь вы можете использовать этот метод для настройки верхнего и нижнего колонтитула в ваших документах PDF.

### Часто задаваемые вопросы

#### В: Какова цель добавления изображения и номера страницы в верхний и нижний колонтитулы PDF-документа?

A: Добавление изображения и номера страницы в раздел верхнего и нижнего колонтитула документа PDF может улучшить его визуальную привлекательность, брендинг и навигационные элементы. Изображение может представлять логотип, водяной знак или любой графический элемент, в то время как номер страницы помогает пользователям отслеживать свой прогресс и находить определенные страницы.

#### В: Как предоставленный исходный код C# помогает добавлять изображение и номер страницы в верхний и нижний колонтитулы PDF-документа?

A: Приведенный код демонстрирует, как создать PDF-документ, добавить страницу, а затем настроить разделы верхнего и нижнего колонтитула. Он показывает, как добавить изображение в верхний колонтитул и фрагмент текста с нумерацией страниц в нижний колонтитул.

#### В: Могу ли я использовать любой формат изображения для заголовка и как указать путь к нему?

 A: Да, вы можете использовать различные форматы изображений (такие как JPEG, PNG, GIF и т. д.) для изображения заголовка. Путь к изображению указывается с помощью`File` собственность`Aspose.Pdf.Image` объект.

#### В: Как настроить внешний вид и расположение изображения в заголовке?

 A: Вы можете настроить внешний вид и расположение изображения, изменив свойства`Aspose.Pdf.Image` объект перед добавлением его в раздел заголовка. Например, вы можете задать размеры изображения, выравнивание, поворот, непрозрачность и т. д.

####  В: Какова цель`TextFragment` object used for the footer?

 А:`TextFragment` объект используется для создания и форматирования текста, который будет отображаться в разделе нижнего колонтитула. В предоставленном коде он используется для отображения номера страницы и общего количества страниц.

#### В: Могу ли я изменить текст нижнего колонтитула, включив в него дополнительную информацию или форматирование?

 A: Да, вы можете изменить текст нижнего колонтитула, изменив содержимое`TextFragment` объект. Вы можете добавить дополнительный текст, изменить шрифты, цвета и форматирование в соответствии с вашими требованиями.

#### В: Можно ли применить разное содержимое верхних и нижних колонтитулов к разным страницам PDF-документа?

 A: Да, вы можете применять разное содержимое верхних и нижних колонтитулов к разным страницам, создавая отдельные`HeaderFooter` объектов и назначение их определенным страницам с помощью`Header` и`Footer` свойства`Aspose.Pdf.Page` объект.

#### В: Как можно дополнительно настроить верхний и нижний колонтитулы, например, изменить стили шрифтов или добавить дополнительные элементы?

A: Вы можете настроить верхний и нижний колонтитулы, используя различные классы и свойства, предоставляемые Aspose.PDF для .NET. Например, вы можете использовать различные параметры форматирования текста, добавлять больше абзацев, изображений или даже таблиц в разделы верхнего и нижнего колонтитулов.

#### В: Могу ли я удалить или очистить разделы верхнего и нижнего колонтитула при необходимости?

A: Да, вы можете удалить или очистить разделы верхнего и нижнего колонтитула, установив`Header` и`Footer` свойства`Aspose.Pdf.Page` возражать против`null`.

#### В: Как я могу гарантировать, что добавленное изображение и номер страницы будут одинаковыми на разных устройствах и в разных программах просмотра?

A: Aspose.PDF для .NET предоставляет функциональные возможности для создания стандартизированных и согласованных PDF-документов, гарантируя, что добавленное изображение и номер страницы будут отображаться одинаково на разных устройствах и в программах просмотра PDF-файлов.