---
title: Изображение и номер страницы в разделе верхнего и нижнего колонтитула
linktitle: Изображение и номер страницы в разделе верхнего и нижнего колонтитула
second_title: Справочник по API Aspose.PDF для .NET
description: Узнайте, как добавить изображение и номер страницы в заголовок PDF-файла с помощью Aspose.PDF для .NET, следуя этому пошаговому руководству.
type: docs
weight: 120
url: /ru/net/programming-with-stamps-and-watermarks/image-and-page-number-in-header-footer-section-inline/
---
## Введение

Aspose.PDF для .NET — это мощный инструмент, который предоставляет обширные возможности для управления и создания PDF-файлов. Если вам нужно добавить изображения, настроить верхние и нижние колонтитулы или управлять текстом, Aspose.PDF поможет вам. В этом уроке мы рассмотрим, как добавить изображение и номер страницы в верхний или нижний колонтитул PDF-документа. Давайте погрузимся в процесс и разберем его пошагово.

## Предпосылки

Прежде чем перейти к коду, давайте убедимся, что у вас все готово для дальнейшего изучения:

-  Aspose.PDF для .NET: Загрузите последнюю версию с сайта[Страница загрузки Aspose PDF](https://releases.aspose.com/pdf/net/).
- Среда разработки: вам понадобится C# IDE, например Visual Studio.
-  Лицензия: Если у вас еще нет лицензии, вы можете получить[временная лицензия здесь](https://purchase.aspose.com/temporary-license/) или купите полную версию у[Магазин Aspose](https://purchase.aspose.com/buy).

Теперь, когда у вас есть все необходимые условия, давайте начнем.

## Импортные пакеты

Прежде чем приступить к кодированию, обязательно импортируйте необходимые пространства имен:

```csharp
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
```

Эти пакеты позволяют работать с PDF-файлами и обрабатывать текст.

## Шаг 1: Настройте каталог документов

Первое, что нам нужно сделать, это определить путь к каталогу, в котором будет сохранен наш PDF-файл. Этот путь можно настроить на папку вашего проекта или любое место на вашем компьютере.

```csharp
// Путь к каталогу документов.
string dataDir = "YOUR DOCUMENT DIRECTORY";
```

 Эта переменная содержит место, где будет сохранен ваш документ. Заменить`"YOUR DOCUMENT DIRECTORY"` с реальным путем.

## Шаг 2: Создание PDF-документа

 На этом этапе мы создаем новый экземпляр`Aspose.Pdf.Document` объект. Этот объект будет служить основой вашего PDF-файла.

```csharp
// Создайте экземпляр объекта Document, вызвав его пустой конструктор.
Aspose.Pdf.Document pdf1 = new Aspose.Pdf.Document();
```

Здесь мы создаем пустой PDF-файл, который позже сможем заполнить содержимым.

## Шаг 3: Добавьте страницу в PDF-файл

Вашему PDF-файлу нужна как минимум одна страница, на которой можно добавить верхние и нижние колонтитулы и содержимое. Давайте добавим пустую страницу в наш документ.

```csharp
// Создать страницу в объекте PDF
Aspose.Pdf.Page page = pdf1.Pages.Add();
```

 Позвонив по телефону`pdf1.Pages.Add()`в документ добавляется новая страница, готовая к настройке верхнего и нижнего колонтитула.

## Шаг 4: Создание и настройка заголовка

Теперь пришло время создать заголовок документа. Сюда мы добавим текст, изображение и номер страницы.

```csharp
// Создать раздел заголовка документа
Aspose.Pdf.HeaderFooter header = new Aspose.Pdf.HeaderFooter();
// Установить заголовок для PDF-файла
page.Header = header;
```

 Мы создаем`HeaderFooter` объект и присвоить его`Header` свойство страницы, гарантирующее, что все, что мы добавляем в заголовок, будет отображаться в верхней части страницы.

## Шаг 5: Добавьте встроенный текст в заголовок

 Добавить текст так же просто, как создать`TextFragment` и указав его свойства. Давайте добавим немного цветного текста в наш заголовок.

```csharp
// Создать текстовый объект
Aspose.Pdf.Text.TextFragment txt1 = new Aspose.Pdf.Text.TextFragment("Aspose.Pdf is a Robust component by");
// Укажите цвет
txt1.TextState.ForegroundColor = Color.Blue;
txt1.IsInLineParagraph = true;
```

 На этом этапе мы создаем`TextFragment` с содержимым "Aspose.Pdf is a Robust component by" и установите его цвет на синий.`IsInLineParagraph` Свойство гарантирует, что текст будет встроенным, то есть он будет отображаться на той же строке, что и другие элементы (например, изображение и дополнительный текст).

## Шаг 6: Вставьте встроенное изображение в заголовок

Чтобы сделать заголовок визуально привлекательным, вы можете добавить изображение в текст. Это может быть логотип вашей компании или любая другая графика.

```csharp
// Создать объект изображения в разделе
Aspose.Pdf.Image image1 = new Aspose.Pdf.Image();
// Укажите путь к файлу изображения
image1.File = dataDir + "aspose-logo.jpg";
// Установить ширину изображения Информация
image1.FixWidth = 50;
image1.FixHeight = 20;
// Укажите, что InlineParagraph сегмента seg1 является изображением.
image1.IsInLineParagraph = true;
```

 Здесь мы добавляем изображение в заголовок, создавая`Image` объекта, задавая его путь и регулируя ширину и высоту.`IsInLineParagraph` обеспечивает выравнивание изображения с текстом.

## Шаг 7: Добавьте дополнительный встроенный текст для завершения заголовка.

Давайте добавим еще немного текста, чтобы завершить встроенный заголовок.

```csharp
Aspose.Pdf.Text.TextFragment txt2 = new Aspose.Pdf.Text.TextFragment(" Pty Ltd.");
txt2.IsInLineParagraph = true;
txt2.TextState.ForegroundColor = Color.Maroon;
header.Paragraphs.Add(txt1);
header.Paragraphs.Add(image1);
header.Paragraphs.Add(txt2);
```

 В этой части мы создаем еще один`TextFragment` с содержимым "Pty Ltd." и задайте его цвет бордовым. В заголовок добавляются как фрагменты текста, так и изображение.

## Шаг 8: Сохраните PDF-файл

После настройки заголовка пришло время сохранить PDF-файл.

```csharp
// Сохранить PDF-файл
pdf1.Save(dataDir + "ImageAndPageNumberInHeaderFooter_UsingInlineParagraph_out.pdf");
```

 The`Save` Метод записывает конечный PDF-файл в указанное место.

## Заключение

Поздравляем! Вы успешно добавили изображение и текст в заголовок документа PDF с помощью Aspose.PDF для .NET. Этот урок провел вас через основные шаги, включая создание документа, добавление страниц, вставку заголовков и размещение встроенного контента, такого как текст и изображения. Aspose.PDF дает вам невероятную гибкость в управлении вашими PDF, будь то манипулирование заголовками, нижними колонтитулами или сложным контентом. 

## Часто задаваемые вопросы

### Могу ли я также добавить номер страницы в заголовок?
 Да! Вы можете легко добавить номер страницы, используя`TextFragment` класс и форматирование его по мере необходимости. Просто вставьте его в раздел заголовка как встроенный контент.

### Как установить фоновое изображение в заголовке?
 Вы можете использовать`BackgroundImage` собственность`HeaderFooter` класс для установки фонового изображения. Однако это не встроенный контент, и он будет охватывать всю область заголовка.

### Можно ли использовать другие форматы изображений, помимо JPEG?
Конечно! Aspose.PDF поддерживает различные форматы изображений, такие как PNG, BMP и GIF.

### Могу ли я настроить шрифт текста в заголовке?
 Да, вы можете использовать`TextState`объект для изменения шрифта, размера и стиля текста.

### Нужна ли мне лицензия для использования Aspose.PDF для .NET?
 Да, Aspose.PDF требует лицензию для использования в производстве, но вы можете начать с[бесплатная пробная версия здесь](https://releases.aspose.com/).