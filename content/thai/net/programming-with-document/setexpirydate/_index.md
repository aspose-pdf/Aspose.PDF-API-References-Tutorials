---
title: กำหนดวันหมดอายุในไฟล์ PDF
linktitle: กำหนดวันหมดอายุในไฟล์ PDF
second_title: เอกสารอ้างอิง Aspose.PDF สำหรับ API ของ .NET
description: เรียนรู้วิธีตั้งค่าวันที่หมดอายุในไฟล์ PDF โดยใช้ Aspose.PDF สำหรับ .NET ด้วยคู่มือทีละขั้นตอนนี้
type: docs
weight: 300
url: /th/net/programming-with-document/setexpirydate/
---
Aspose.PDF สำหรับ .NET เป็นไลบรารีที่มีประสิทธิภาพซึ่งมีคุณสมบัติต่างๆ มากมายสำหรับการทำงานกับไฟล์ PDF หนึ่งในคุณสมบัติดังกล่าวก็คือความสามารถในการกำหนดวันที่หมดอายุสำหรับเอกสาร PDF ในบทช่วยสอนนี้ เราจะแนะนำคุณเกี่ยวกับขั้นตอนการกำหนดวันที่หมดอายุสำหรับเอกสาร PDF โดยใช้ Aspose.PDF สำหรับ .NET 

## ขั้นตอนที่ 1: ตั้งค่าเส้นทางไปยังไดเรกทอรีเอกสาร

ก่อนที่เราจะเริ่มต้น เราต้องกำหนดเส้นทางไปยังไดเร็กทอรีที่เอกสาร PDF ของเราตั้งอยู่ เราจะเก็บเส้นทางนี้ไว้ในตัวแปรที่เรียกว่า "dataDir"

```csharp
string dataDir = "YOUR DOCUMENT DIRECTORY";
```

## ขั้นตอนที่ 2: การสร้างเอกสาร PDF ใหม่

 ในการสร้างเอกสาร PDF ใหม่ เราจำเป็นต้องสร้างอินสแตนซ์ใหม่`Aspose.Pdf.Document` วัตถุ เราสามารถทำได้โดยใช้โค้ดต่อไปนี้:

```csharp
Aspose.Pdf.Document doc = new Aspose.Pdf.Document();
```

## ขั้นตอนที่ 3: การเพิ่มหน้าใหม่ลงในเอกสาร PDF

เมื่อเราสร้างเอกสาร PDF เสร็จแล้ว เราจะเพิ่มหน้าใหม่เข้าไปได้ โดยใช้โค้ดต่อไปนี้:

```csharp
doc.Pages.Add();
```

## ขั้นตอนที่ 4: การเพิ่มข้อความลงในเอกสาร PDF

 หลังจากเพิ่มหน้าลงในเอกสาร PDF แล้ว เราสามารถเพิ่มข้อความลงไปได้โดยใช้`Paragraphs` คอลเลกชัน เราสามารถทำได้โดยใช้โค้ดต่อไปนี้:

```csharp
doc.Pages[1].Paragraphs.Add(new TextFragment("Hello World..."));
```

## ขั้นตอนที่ 5: ตั้งค่าวันที่หมดอายุของ PDF โดยใช้ JavaScript

ในการกำหนดวันหมดอายุของไฟล์ PDF เราต้องสร้างอ็อบเจ็กต์ JavaScript โดยใช้โค้ดต่อไปนี้:

```csharp
JavascriptAction javaScript = new JavascriptAction(
"var year=2017;"
+ "var month=5;"
+ "today = new Date(); today = new Date(today.getFullYear(), today.getMonth());"
+ "expiry = new Date(year, month);"
+ "if (today.getTime() > expiry.getTime())"
+ "app.alert('The file is expired. You need a new one.');");

// ตั้งค่า JavaScript เป็นการดำเนินการเปิด PDF
doc.OpenAction = javaScript;
```

ในโค้ดนี้ เราจะตั้งวันหมดอายุเป็นเดือนพฤษภาคม 2017

## ขั้นตอนที่ 6: บันทึกไฟล์ PDF

 หลังจากที่คุณกำหนดวันที่หมดอายุแล้ว คุณต้องบันทึกไฟล์ PDF หากต้องการทำเช่นนี้ คุณสามารถใช้`Save` วิธีการของ`Document` วัตถุและส่งผ่านเส้นทางที่คุณต้องการบันทึกไฟล์ PDF ที่อัพเดต

```csharp
dataDir = dataDir + "SetExpiryDate_out.pdf";
// บันทึกเอกสาร PDF
doc.Save(dataDir);
```

### ตัวอย่างซอร์สโค้ดสำหรับกำหนดวันหมดอายุโดยใช้ Aspose.PDF สำหรับ .NET

นี่คือตัวอย่างซอร์สโค้ดที่สมบูรณ์สำหรับการตั้งค่าวันที่หมดอายุโดยใช้ Aspose.PDF สำหรับ .NET:

```csharp
// เส้นทางไปยังไดเร็กทอรีเอกสาร
string dataDir = "YOUR DOCUMENT DIRECTORY";

// สร้างอินสแตนซ์ของวัตถุเอกสาร
Aspose.Pdf.Document doc = new Aspose.Pdf.Document();
// เพิ่มหน้าเข้าไปยังคอลเลคชันไฟล์ PDF
doc.Pages.Add();
// เพิ่มข้อความส่วนย่อยลงในคอลเล็กชั่นย่อหน้าของวัตถุหน้า
doc.Pages[1].Paragraphs.Add(new TextFragment("Hello World..."));
// สร้างวัตถุ JavaScript เพื่อกำหนดวันที่หมดอายุของ PDF
JavascriptAction javaScript = new JavascriptAction(
"var year=2017;"
+ "var month=5;"
+ "today = new Date(); today = new Date(today.getFullYear(), today.getMonth());"
+ "expiry = new Date(year, month);"
+ "if (today.getTime() > expiry.getTime())"
+ "app.alert('The file is expired. You need a new one.');");
// ตั้งค่า JavaScript เป็นการดำเนินการเปิด PDF
doc.OpenAction = javaScript;

dataDir = dataDir + "SetExpiryDate_out.pdf";
// บันทึกเอกสาร PDF
doc.Save(dataDir);
```

## บทสรุป

การกำหนดวันหมดอายุสำหรับเอกสาร PDF โดยใช้ Aspose.PDF สำหรับ .NET เป็นฟีเจอร์ที่มีประโยชน์ในการทำให้มั่นใจว่าเอกสารนั้นจะมีอายุใช้งานเฉพาะช่วงเวลาที่กำหนดเท่านั้น โดยปฏิบัติตามคำแนะนำทีละขั้นตอนและใช้โค้ดต้นฉบับ C# ที่ให้มา นักพัฒนาสามารถกำหนดวันหมดอายุและสร้าง PDF ที่มีระยะเวลาใช้งานจำกัดได้อย่างง่ายดาย ฟีเจอร์นี้อาจมีประโยชน์อย่างยิ่งสำหรับเอกสารที่ต้องเข้าถึงหรือแจกจ่ายในระยะเวลาจำกัด

### คำถามที่พบบ่อยสำหรับการกำหนดวันหมดอายุในไฟล์ PDF

#### ถาม: ฉันสามารถกำหนดวันหมดอายุที่แตกต่างกันสำหรับเอกสาร PDF ได้หรือไม่

 A: ใช่ คุณสามารถกำหนดวันหมดอายุที่แตกต่างกันสำหรับเอกสาร PDF ได้โดยแก้ไขโค้ด JavaScript ในขั้นตอนที่ 5 ในตัวอย่างที่ให้มา วันหมดอายุจะถูกตั้งเป็นเดือนพฤษภาคม 2017 หากต้องการกำหนดวันหมดอายุที่แตกต่างกัน คุณต้องแก้ไข`year` และ`month` ตัวแปรในโค้ด JavaScript เป็นปีและเดือนที่ต้องการ

#### ถาม: จะเกิดอะไรขึ้นเมื่อเอกสาร PDF หมดอายุ?

A: เมื่อเอกสาร PDF หมดอายุตามที่ระบุไว้ในโค้ด JavaScript โปรแกรมดูจะแสดงข้อความแจ้งเตือนว่าไฟล์หมดอายุแล้วและผู้ใช้จำเป็นต้องเปิดไฟล์ใหม่ ข้อความแจ้งเตือนนี้จะปรากฏขึ้นเมื่อเปิด PDF

#### ถาม: ฉันสามารถใช้เวลาที่เจาะจงสำหรับวันหมดอายุแทนการใช้แค่เฉพาะวันที่ได้ไหม

 A: ใช่ คุณสามารถกำหนดเวลาหมดอายุในโค้ด JavaScript ได้ โดยการแก้ไข`expiry` ตัวแปรในโค้ด JavaScript เพื่อรวมเวลาที่ต้องการ คุณสามารถตั้งเวลาเฉพาะสำหรับวันหมดอายุได้