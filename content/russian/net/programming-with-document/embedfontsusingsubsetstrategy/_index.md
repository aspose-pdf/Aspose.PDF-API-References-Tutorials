---
title: Встраивание шрифтов в PDF-файл с помощью стратегии подмножества
linktitle: Встраивание шрифтов с помощью стратегии подмножества
second_title: Справочник по API Aspose.PDF для .NET
description: Узнайте, как встроить шрифты в файл PDF с помощью Subset Strategy, используя Aspose.PDF для .NET. Оптимизируйте размер PDF, встраивая только необходимые символы.
type: docs
weight: 130
url: /ru/net/programming-with-document/embedfontsusingsubsetstrategy/
---
## Введение

В цифровую эпоху PDF-файлы стали основным средством обмена документами. Независимо от того, отправляете ли вы отчет, презентацию или электронную книгу, обеспечение корректного отображения шрифтов имеет решающее значение. Вы когда-нибудь открывали PDF-файл и обнаруживали, что текст выглядит не так, как предполагалось? Это часто случается, когда шрифты, используемые в документе, не внедрены должным образом. Вот где в игру вступает Aspose.PDF для .NET! В этом руководстве мы рассмотрим, как встраивать шрифты в PDF-файл с помощью стратегии подмножества, гарантируя, что ваши документы будут выглядеть именно так, как вы задумали, независимо от того, где они просматриваются.

## Предпосылки

Прежде чем мы углубимся в тонкости встраивания шрифтов, вам необходимо иметь под рукой несколько вещей:

1.  Aspose.PDF для .NET: Убедитесь, что у вас установлена библиотека Aspose.PDF. Вы можете загрузить ее с[здесь](https://releases.aspose.com/pdf/net/).
2. Visual Studio: среда разработки, в которой вы можете писать и тестировать свой код .NET.
3. Базовые знания C#: знакомство с программированием на C# поможет вам лучше понимать фрагменты кода.

## Импортные пакеты

Для начала вам нужно импортировать необходимые пакеты в ваш проект C#. Вот как это можно сделать:

### Создать новый проект

Откройте Visual Studio и создайте новый проект C#. Для простоты вы можете выбрать Console Application.

### Добавить ссылку Aspose.PDF

1. Щелкните правой кнопкой мыши по вашему проекту в обозревателе решений.
2. Выберите «Управление пакетами NuGet».
3. Найдите «Aspose.PDF» и установите последнюю версию.

```csharp
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
```

Теперь, когда у нас все готово, давайте шаг за шагом разберем процесс внедрения шрифтов в PDF-файл.

## Шаг 1: Настройте каталог документов

Для начала нам нужно определить, где хранятся наши документы. Это важно, поскольку мы будем читать и писать в этот каталог.

```csharp
// Путь к каталогу документов.
string dataDir = "YOUR DOCUMENT DIRECTORY";
```

 Заменять`"YOUR DOCUMENT DIRECTORY"` с фактическим путем, где находятся ваши PDF-файлы. Это может быть что-то вроде`@"C:\Documents\"`.

## Шаг 2: Загрузите PDF-документ

Далее мы загрузим PDF-документ, который мы хотим изменить. Вот где Aspose.PDF блистает, позволяя нам легко манипулировать PDF-файлами.

```csharp
Document doc = new Document(dataDir + "input.pdf");
```

 Убедитесь, что у вас есть`input.pdf` файл в указанном вами каталоге. Этот файл мы и будем изменять.

## Шаг 3: Подмножество всех шрифтов

Теперь перейдем к сути вопроса: встраивание шрифтов. Начнем с встраивания всех шрифтов как подмножеств. Это означает, что будут встраиваться только те символы, которые используются в документе, что может значительно уменьшить размер файла.

```csharp
// В случае SubsetAllFonts все шрифты будут встроены в документ как подмножество.
doc.FontUtilities.SubsetFonts(FontSubsetStrategy.SubsetAllFonts);
```

 Используя`SubsetAllFonts`мы гарантируем, что каждый шрифт, используемый в документе, будет внедрен, но будут включены только те символы, которые фактически используются.

## Шаг 4: Подмножество только встроенных шрифтов

В некоторых случаях вам может понадобиться встроить только те шрифты, которые уже встроены в документ. Это полезно, если вы хотите сохранить оригинальный вид без добавления новых шрифтов.

```csharp
//Подмножество шрифтов будет встроено для полностью встроенных шрифтов, но шрифты, не встроенные в документ, не будут затронуты.
doc.FontUtilities.SubsetFonts(FontSubsetStrategy.SubsetEmbeddedFontsOnly);
```

Эта строка кода гарантирует, что будут преобразованы только те шрифты, которые уже встроены, оставляя все невстроенные шрифты нетронутыми.

## Шаг 5: Сохраните измененный документ.

Наконец, нам нужно сохранить наши изменения. Это место, где мы записываем измененный документ обратно на диск.

```csharp
doc.Save(dataDir + "Output_out.pdf");
```

 Это создаст новый PDF-файл с именем`Output_out.pdf` в указанном вами каталоге вместе со встроенными шрифтами.

## Заключение

И вот оно! Вы успешно внедрили шрифты в файл PDF с помощью Aspose.PDF для .NET. Выполнив эти шаги, вы можете гарантировать, что ваши документы сохранят свой предполагаемый вид, независимо от того, где они просматриваются. Независимо от того, делитесь ли вы отчетами, презентациями или любым другим типом документа, внедрение шрифтов является важным шагом в поддержании профессионализма и ясности.

## Часто задаваемые вопросы

### Что такое подмножество шрифтов?
Подмножество шрифтов — это процесс включения только тех символов, которые используются в документе, а не всего шрифта, что помогает уменьшить размер файла.

### Зачем мне встраивать шрифты в мой PDF-файл?
Встроенные шрифты гарантируют, что ваш документ будет выглядеть одинаково на всех устройствах, предотвращая проблемы с заменой шрифтов.

### Могу ли я использовать Aspose.PDF бесплатно?
 Да, Aspose предлагает бесплатную пробную версию, которую вы можете использовать для тестирования библиотеки перед покупкой. Вы можете найти ее[здесь](https://releases.aspose.com/).

### Где я могу найти дополнительную документацию?
 Вы можете получить доступ к полной документации по Aspose.PDF для .NET[здесь](https://reference.aspose.com/pdf/net/).

### Что делать, если у меня возникнут проблемы?
 Если у вас возникнут какие-либо проблемы, вы можете обратиться за помощью на форум поддержки Aspose.[здесь](https://forum.aspose.com/c/pdf/10).