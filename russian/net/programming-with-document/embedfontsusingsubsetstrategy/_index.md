---
title: Внедрение шрифтов с использованием стратегии подмножества
linktitle: Внедрение шрифтов с использованием стратегии подмножества
second_title: Aspose.PDF для справочника API .NET
description: Узнайте, как встраивать шрифты в файл PDF с помощью стратегии подмножества, используя Aspose.PDF для .NET. Оптимизируйте размер PDF-файла, вставляя только необходимые символы.
type: docs
weight: 130
url: /ru/net/programming-with-document/embedfontsusingsubsetstrategy/
---

В этом руководстве мы обсудим, как встраивать шрифты в PDF-файл со стратегией подмножества, используя Aspose.PDF для .NET. Aspose.PDF для .NET — это мощная библиотека, которая позволяет разработчикам программно создавать, редактировать и управлять PDF-документами. Встраивание шрифтов в PDF-файл — важный шаг для обеспечения правильного отображения документа на разных устройствах, независимо от того, установлены ли на этих устройствах необходимые шрифты или нет.

## Шаг 1. Создайте новое консольное приложение C#
Для начала создайте новое консольное приложение C# в Visual Studio. Вы можете назвать это как угодно. После создания проекта необходимо добавить ссылку на библиотеку Aspose.PDF для .NET.

## Шаг 2. Импортируйте пространство имен Aspose.PDF
Добавьте следующую строку кода вверху файла C#, чтобы импортировать пространство имен Aspose.PDF:

```csharp
using Aspose.Pdf;
```

## Шаг 3: Загрузите существующий файл PDF
Чтобы встроить шрифты в существующий файл PDF, вам необходимо загрузить этот файл с помощью класса Document. Следующий код демонстрирует, как загрузить существующий файл PDF:

```csharp
// Путь к каталогу документов.
string dataDir = "YOUR DOCUMENT DIRECTORY";

// Загрузите существующий файл PDF
Document doc = new Document(dataDir + "input.pdf");
```

## Шаг 4. Встраивание шрифтов с помощью стратегии подмножества
Aspose.PDF для .NET предоставляет две стратегии внедрения шрифтов: SubsetAllFonts и SubsetEmbeddedFontsOnly.

Стратегия SubsetAllFonts встраивает все шрифты в документ как подмножество. Подмножество — это часть шрифта, содержащая только символы, используемые в документе. Эта стратегия полезна для уменьшения размера файла PDF-документа.

Стратегия SubsetEmbeddedFontsOnly будет внедрять только то подмножество шрифтов, которое уже внедрено в документ. Если шрифт не встроен, эта стратегия не затронет его.

В следующем коде показано, как встроить шрифты в файл PDF с помощью стратегии подмножества:

```csharp
// Все шрифты будут встроены в документ как подмножество в случае SubsetAllFonts.
doc.FontUtilities.SubsetFonts(FontSubsetStrategy.SubsetAllFonts);

// Подмножество шрифтов будет встроено для полностью встроенных шрифтов, но шрифты, которые не встроены в документ, не будут затронуты.
doc.FontUtilities.SubsetFonts(FontSubsetStrategy.SubsetEmbeddedFontsOnly);
```

## Шаг 5: Сохраните PDF-документ
После того, как вы внедрили все шрифты в файл PDF с помощью стратегии подмножества, вам необходимо сохранить документ. Следующий код демонстрирует, как сохранить файл PDF:

```csharp
doc.Save(dataDir + "Output_out.pdf");
```

### Пример исходного кода для внедрения шрифтов со стратегией подмножества с использованием Aspose.PDF для .NET. 

```csharp

            
            // Путь к каталогу документов.
            string dataDir = "YOUR DOCUMENT DIRECTORY";
            Document doc = new Document(dataDir + "input.pdf");
            // Все шрифты будут встроены в документ как подмножество в случае SubsetAllFonts.
            doc.FontUtilities.SubsetFonts(FontSubsetStrategy.SubsetAllFonts);
            // Подмножество шрифтов будет встроено для полностью встроенных шрифтов, но шрифты, которые не встроены в документ, не будут затронуты.
            doc.FontUtilities.SubsetFonts(FontSubsetStrategy.SubsetEmbeddedFontsOnly);
            doc.Save(dataDir + "Output_out.pdf");
            

        
```

## Заключение
В этой статье мы обсудили, как встраивать шрифты в PDF-файл со стратегией подмножества, используя Aspose.PDF для .NET. Aspose.PDF для .NET предоставляет простой и удобный в использовании API для работы с PDF-документами, включая добавление и встраивание шрифтов с различными стратегиями. Встраивание шрифтов в PDF-файл — важный шаг для обеспечения правильного отображения документа на разных устройствах, а стратегия подмножества — полезная функция для уменьшения размера файла PDF-документа.

