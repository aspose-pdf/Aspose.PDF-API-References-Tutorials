---
title: แยกข้อมูลลายเซ็น
linktitle: แยกข้อมูลลายเซ็น
second_title: Aspose.PDF สำหรับการอ้างอิง .NET API
description: แยกข้อมูลลายเซ็นโดยใช้ Aspose.PDF สำหรับ .NET
type: docs
weight: 80
url: /th/net/programming-with-security-and-signatures/extract-signature-info/
---
กระบวนการดึงข้อมูลลายเซ็นจากเอกสาร PDF นั้นค่อนข้างมีประโยชน์ในสถานการณ์ต่างๆ ไม่ว่าคุณจะต้องตรวจสอบความถูกต้องของเอกสารที่ลงนามหรือวิเคราะห์ใบรับรองที่ใช้สำหรับลายเซ็น ไลบรารี Aspose.PDF สำหรับ .NET ก็เป็นโซลูชันที่สะดวกสบาย ในบทช่วยสอนนี้ เราจะแนะนำคุณตลอดกระบวนการแยกข้อมูลลายเซ็นแบบทีละขั้นตอนโดยใช้ซอร์สโค้ด C# ที่ให้มา

## ความต้องการ

ก่อนที่เราจะเริ่มต้น ตรวจสอบให้แน่ใจว่าคุณมีข้อกำหนดเบื้องต้นต่อไปนี้:

1. ความรู้พื้นฐานเกี่ยวกับภาษาการเขียนโปรแกรม C#
2. Aspose.PDF สำหรับไลบรารี .NET ที่ติดตั้งบนระบบของคุณ
3. เอกสาร PDF ที่ถูกต้องพร้อมช่องลายเซ็นอย่างน้อยหนึ่งช่อง

ตอนนี้ เรามาเจาะลึกรายละเอียดการใช้งานกัน

## ขั้นตอนที่ 1: การนำเข้าไลบรารีที่จำเป็น

 ในการเริ่มต้น คุณต้องนำเข้าไลบรารีที่จำเป็นไปยังโปรเจ็กต์ C# ของคุณ ในกรณีนี้เราจำเป็นต้องนำเข้าไฟล์`Aspose.Pdf` และ`System.IO` เนมสเปซ ซึ่งสามารถทำได้โดยการเพิ่มโค้ดต่อไปนี้ที่จุดเริ่มต้นของไฟล์ C# ของคุณ:

```csharp
using Aspose.Pdf;
using System.IO;
```

## ขั้นตอนที่ 2: การตั้งค่าเส้นทางเอกสาร

ถัดไป คุณต้องกำหนดเส้นทางไปยังเอกสาร PDF ที่คุณต้องการแยกข้อมูลลายเซ็น แทนที่`"YOUR DOCUMENTS DIRECTORY"` ในข้อมูลโค้ดต่อไปนี้พร้อมเส้นทางจริงไปยังเอกสารของคุณ:

```csharp
string dataDir = "YOUR DOCUMENTS DIRECTORY";
string input = dataDir + "ExtractSignatureInfo.pdf";
```

## ขั้นตอนที่ 3: แยกข้อมูลลายเซ็น

ตอนนี้ มาดูส่วนหลักของโค้ดที่เราดึงข้อมูลลายเซ็นจากเอกสาร PDF กัน เราวนซ้ำแต่ละช่องในแบบฟอร์มของเอกสารและตรวจสอบว่าเป็นช่องลายเซ็นหรือไม่ หากพบช่องลายเซ็น เราจะดำเนินการแยกใบรับรองต่อไป เพิ่มข้อมูลโค้ดต่อไปนี้:

```csharp
using (Document pdfDocument = new Document(input))
{
     foreach(Field field in pdfDocument.Form)
     {
         SignatureField sf = field as SignatureField;
         if (sf != null)
         {
             // ดึงใบรับรอง
             Stream cerStream = sf.ExtractCertificate();
             if (cerStream != null)
             {
                 using (cerStream)
                 {
                     byte[] bytes = new byte[cerStream.Length];
                     using (FileStream fs = new FileStream(dataDir + @"input.cer", FileMode.CreateNew))
                     {
                         cerStream.Read(bytes, 0, bytes.Length);
                         fs.Write(bytes, 0, bytes.Length);
                     }
                 }
             }
         }
     }
}
```

## ขั้นตอนที่ 4: การแยกใบรับรอง

ในขั้นตอนนี้ เราจะแยกใบรับรองออกจากช่องลายเซ็นและบันทึกเป็นไฟล์ ใบรับรองที่แยกออกมาสามารถวิเคราะห์เพิ่มเติมหรือใช้เพื่อวัตถุประสงค์ในการตรวจสอบได้ ข้อมูลโค้ดด้านล่างสาธิตกระบวนการแยกและบันทึก:

```csharp
Stream cerStream = sf.ExtractCertificate();
if (cerStream != null)
{
     using (cerStream)
     {
         byte[] bytes = new byte[cerStream.Length];
         using (FileStream fs = new FileStream(dataDir + @"input.cer", FileMode.CreateNew))
         {
             cerStream.Read(bytes, 0, bytes.Length);
             fs.Write(bytes, 0, bytes.Length);
         }
     }
}
```

## ขั้นตอนที่ 5

: การบันทึกใบรับรอง

สุดท้าย เราจะบันทึกใบรับรองที่แยกออกมาเป็นไฟล์ ในตัวอย่างนี้ ใบรับรองจะถูกบันทึกด้วยชื่อ "input.cer" ในไดเร็กทอรีที่ระบุ คุณสามารถแก้ไขโค้ดให้เหมาะกับความต้องการของคุณได้ นี่คือข้อมูลโค้ดสำหรับบันทึกใบรับรอง:

```csharp
using (FileStream fs = new FileStream(dataDir + @"input.cer", FileMode.CreateNew))
{
     fs.Write(bytes, 0, bytes.Length);
}
```

แค่นั้นแหละ! คุณได้ดึงข้อมูลลายเซ็นสำเร็จแล้วโดยใช้ Aspose.PDF สำหรับ .NET คุณสามารถรวมโค้ดนี้เข้ากับแอปพลิเคชันของคุณเองหรือแก้ไขตามความต้องการของคุณได้

### ตัวอย่างซอร์สโค้ดสำหรับแยกข้อมูลลายเซ็นโดยใช้ Aspose.PDF สำหรับ .NET 
```csharp
try
{
	// เส้นทางไปยังไดเร็กทอรีเอกสาร
	string dataDir = "YOUR DOCUMENTS DIRECTORY";
	string input = dataDir + "ExtractSignatureInfo.pdf";
	using (Document pdfDocument = new Document(input))
	{
		foreach (Field field in pdfDocument.Form)
		{
			SignatureField sf = field as SignatureField;
			if (sf != null)
			{
				Stream cerStream = sf.ExtractCertificate();
				if (cerStream != null)
				{
					using (cerStream)
					{
						byte[] bytes = new byte[cerStream.Length];
						using (FileStream fs = new FileStream(dataDir + @"input.cer", FileMode.CreateNew))
						{
							cerStream.Read(bytes, 0, bytes.Length);
							fs.Write(bytes, 0, bytes.Length);
						}
					}
				}
			}
		}
	}
}
catch (Exception ex)
{
	Console.WriteLine(ex.Message);
}
```

## บทสรุป

ในบทช่วยสอนนี้ เราได้อธิบายคำแนะนำทีละขั้นตอนเกี่ยวกับวิธีการดึงข้อมูลลายเซ็นจากเอกสาร PDF โดยใช้ Aspose.PDF สำหรับไลบรารี .NET เราครอบคลุมกระบวนการนำเข้าไลบรารีที่จำเป็น การตั้งค่าเส้นทางเอกสาร การแตกข้อมูลลายเซ็น การแตกใบรับรอง และการบันทึกลงในไฟล์ ด้วยการทำตามขั้นตอนเหล่านี้ คุณสามารถดึงรายละเอียดลายเซ็นและดำเนินการตามความจำเป็นได้อย่างง่ายดาย

### คำถามที่พบบ่อย

#### ถาม: เหตุใดฉันจึงต้องดึงข้อมูลลายเซ็นจากเอกสาร PDF

ตอบ: การแยกข้อมูลลายเซ็นออกจากเอกสาร PDF มีประโยชน์ในการตรวจสอบความถูกต้องของเอกสารที่ลงนาม และวิเคราะห์ใบรับรองที่ใช้สำหรับลายเซ็น กระบวนการนี้ช่วยรับรองความสมบูรณ์ของเนื้อหาที่ลงนามและอาจจำเป็นสำหรับวัตถุประสงค์ทางกฎหมายและความปลอดภัย

#### ถาม: Aspose.PDF สำหรับ .NET คืออะไร

ตอบ: Aspose.PDF สำหรับ .NET เป็นไลบรารีที่ช่วยให้นักพัฒนาสามารถทำงานกับเอกสาร PDF ในแอปพลิเคชัน .NET ได้ โดยมีคุณสมบัติที่หลากหลายสำหรับการสร้าง การแก้ไข และการโต้ตอบกับไฟล์ PDF โดยทางโปรแกรม

#### ถาม: ข้อกำหนดเบื้องต้นสำหรับการดึงข้อมูลลายเซ็นโดยใช้ Aspose.PDF สำหรับ .NET มีอะไรบ้าง

ตอบ: หากต้องการดึงข้อมูลลายเซ็น คุณต้องมีความรู้พื้นฐานเกี่ยวกับภาษาการเขียนโปรแกรม C#, ไลบรารี Aspose.PDF สำหรับ .NET ที่ติดตั้งบนระบบของคุณ และเอกสาร PDF ที่ถูกต้องซึ่งมีฟิลด์ลายเซ็นอย่างน้อยหนึ่งช่อง

#### ถาม: ฉันจะนำเข้าไลบรารีที่จำเป็นสำหรับกระบวนการแยกได้อย่างไร

ตอบ: คุณสามารถนำเข้าไลบรารีที่จำเป็นได้โดยเพิ่มไฟล์`using` คำสั่งสำหรับ`Aspose.Pdf` และ`System.IO` ที่จุดเริ่มต้นของไฟล์ C# ของคุณ คำสั่งเหล่านี้ทำให้คุณสามารถใช้คลาสและวิธีการที่จำเป็นสำหรับการแยกข้อมูลลายเซ็นได้

#### ถาม: ฉันจะระบุเอกสาร PDF เพื่อแยกข้อมูลลายเซ็นได้อย่างไร

 ตอบ: คุณสามารถกำหนดเส้นทางไปยังเอกสาร PDF ได้โดยแทนที่`"YOUR DOCUMENTS DIRECTORY"` ด้วยเส้นทางจริงไปยังเอกสารของคุณในข้อมูลโค้ดที่ให้ไว้ เส้นทางนี้ใช้เพื่อโหลดเอกสาร PDF ที่คุณต้องการแยกข้อมูลลายเซ็น

#### ถาม: กระบวนการดึงข้อมูลลายเซ็นจากเอกสาร PDF คืออะไร

ตอบ: กระบวนการแยกข้อมูลเกี่ยวข้องกับการวนซ้ำผ่านช่องแบบฟอร์มของเอกสาร PDF ตรวจสอบว่าแต่ละช่องเป็นช่องลายเซ็นหรือไม่ และหากเป็นเช่นนั้น ให้แยกใบรับรองที่เกี่ยวข้อง ใบรับรองที่แยกออกมาสามารถบันทึกเป็นไฟล์เพื่อการวิเคราะห์หรือการตรวจสอบเพิ่มเติมได้

#### ถาม: ใบรับรองจะถูกดึงมาจากช่องลายเซ็นอย่างไร

ตอบ: ใบรับรองจะถูกดึงมาจากฟิลด์ลายเซ็นโดยใช้`ExtractCertificate()` วิธีการที่กำหนดโดย`SignatureField` คลาสใน Aspose.PDF สำหรับ .NET วิธีการนี้จะส่งคืนสตรีมที่มีข้อมูลใบรับรอง

#### ถาม: ฉันจะบันทึกใบรับรองที่แยกออกมาเป็นไฟล์ได้อย่างไร

 ตอบ: คุณสามารถบันทึกใบรับรองที่แตกออกมาเป็นไฟล์ได้โดยการอ่านสตรีมใบรับรองและเขียนเนื้อหาลงในไฟล์โดยใช้`FileStream` ระดับ. รหัสที่ให้ไว้ในบทช่วยสอนสาธิตกระบวนการนี้

#### ถาม: ฉันสามารถใช้ใบรับรองที่แยกออกมานี้เพื่อตรวจสอบความถูกต้องของลายเซ็นได้หรือไม่

ตอบ: ได้ ใบรับรองที่แยกออกมาสามารถนำมาใช้ในการตรวจสอบลายเซ็นได้ คุณสามารถวิเคราะห์รายละเอียดของใบรับรองและตรวจสอบความถูกต้องเพื่อให้แน่ใจว่าเอกสารที่ลงนามมีความสมบูรณ์

#### ถาม: ฉันจะรวมโค้ดนี้เข้ากับแอปพลิเคชันของตัวเองได้อย่างไร

ตอบ: คุณสามารถรวมโค้ดที่ให้มาเข้ากับแอปพลิเคชัน C# ของคุณเองได้โดยทำตามคำแนะนำทีละขั้นตอน แก้ไขเส้นทางและชื่อไฟล์ตามต้องการ และรวมโค้ดเข้ากับโปรเจ็กต์ที่มีอยู่ของคุณ

#### ถาม: มีคุณสมบัติอื่นๆ ใน Aspose.PDF สำหรับ .NET ที่เกี่ยวข้องกับการจัดการลายเซ็นหรือไม่

ตอบ: ใช่ Aspose.PDF สำหรับ .NET มีคุณสมบัติมากมายสำหรับการทำงานกับลายเซ็นดิจิทัล รวมถึงการลงนามในเอกสาร การตรวจสอบลายเซ็น และการเพิ่มข้อมูลการประทับเวลา คุณสามารถสำรวจเอกสารอย่างเป็นทางการเพื่อดูรายละเอียดเพิ่มเติมเกี่ยวกับคุณสมบัติเหล่านี้ได้

#### ถาม: ฉันจะหาแหล่งข้อมูลเพิ่มเติมสำหรับการใช้ Aspose.PDF สำหรับ .NET ได้ที่ไหน

 ตอบ: สำหรับข้อมูลเพิ่มเติม บทช่วยสอน และทรัพยากรเกี่ยวกับการใช้ Aspose.PDF สำหรับ .NET[Aspose.PDF สำหรับ .NET](https://reference.aspose.com/pdf/net/).

#### ถาม: เป็นไปได้ไหมที่จะแยกลายเซ็นออกจากเอกสาร PDF ที่เข้ารหัส

ตอบ: ความสามารถในการแยกลายเซ็นจากเอกสาร PDF ที่เข้ารหัสอาจขึ้นอยู่กับการตั้งค่าการเข้ารหัสและการอนุญาตของเอกสาร คุณอาจต้องตรวจสอบให้แน่ใจว่าคุณมีสิทธิ์ที่จำเป็นในการเข้าถึงและดึงข้อมูลลายเซ็น

#### ถาม: ฉันสามารถดึงลายเซ็นหลายลายเซ็นจากเอกสาร PDF ฉบับเดียวได้หรือไม่

ตอบ: ได้ คุณสามารถแก้ไขโค้ดที่ให้มาเพื่อวนซ้ำฟิลด์ลายเซ็นทั้งหมดในเอกสาร PDF และดึงข้อมูลลายเซ็นจากแต่ละฟิลด์ได้ ซึ่งจะทำให้คุณสามารถดึงข้อมูลเกี่ยวกับลายเซ็นหลายลายเซ็นที่มีอยู่ในเอกสารได้

#### ถาม: มีกรณีการใช้งานจริงใดบ้างในการดึงข้อมูลลายเซ็น

ตอบ: กรณีการใช้งานจริงบางกรณีในการดึงข้อมูลลายเซ็น ได้แก่ การตรวจสอบความถูกต้องของเอกสารที่ลงนามแบบดิจิทัล การวิเคราะห์รายละเอียดใบรับรองเพื่อวัตถุประสงค์ในการปฏิบัติตามข้อกำหนด และการเก็บรักษาบันทึกลายเซ็นและผู้ลงนามเพื่อวัตถุประสงค์ในการตรวจสอบ

#### ถาม: มีข้อพิจารณาทางกฎหมายเมื่อดึงข้อมูลลายเซ็นหรือไม่

ตอบ: การดึงข้อมูลลายเซ็นอาจมีผลกระทบทางกฎหมาย โดยเฉพาะอย่างยิ่งเมื่อต้องจัดการกับเอกสารที่มีผลผูกพันทางกฎหมาย ตรวจสอบให้แน่ใจว่าคุณปฏิบัติตามกฎระเบียบและกฎหมายที่เกี่ยวข้องที่เกี่ยวข้องกับลายเซ็นอิเล็กทรอนิกส์และความถูกต้องของเอกสารในเขตอำนาจศาลของคุณ