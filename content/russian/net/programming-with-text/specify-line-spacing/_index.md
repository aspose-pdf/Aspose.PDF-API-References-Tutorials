---
title: Укажите межстрочный интервал в PDF-файле
linktitle: Укажите межстрочный интервал в PDF-файле
second_title: Справочник по API Aspose.PDF для .NET
description: Узнайте, как задать межстрочный интервал в PDF с помощью Aspose.PDF для .NET с помощью этого пошагового руководства. Идеально подходит для разработчиков, ищущих точное форматирование текста.
type: docs
weight: 510
url: /ru/net/programming-with-text/specify-line-spacing/
---
## Введение

Вы когда-нибудь испытывали трудности с контролем межстрочного интервала в файле PDF? Возможно, у вас был текст, который выглядел слишком нагроможденным или просто не выглядел таким отполированным, как вам хотелось бы. В этом уроке мы рассмотрим, как можно легко задать межстрочный интервал в PDF с помощью Aspose.PDF для .NET. Мы воспользуемся простым пошаговым руководством, чтобы перейти от пустого PDF к PDF, включающему настраиваемый межстрочный интервал. Это идеальный вариант, если вам нужна точность в текстовом макете для таких документов, как отчеты, счета-фактуры или сертификаты.

## Предпосылки

Прежде чем перейти к коду, давайте убедимся, что у вас есть все необходимое:

1.  Aspose.PDF для .NET установлен. Если у вас его нет, возьмите его с[Страница загрузки Aspose.PDF](https://releases.aspose.com/pdf/net/).
2. Среда разработки .NET (например, Visual Studio).
3. Файл шрифта TrueType (`.ttf` ), который мы будем использовать в примере. Вы можете использовать любой шрифт, но для этого руководства мы будем использовать`HPSimplified.TTF` шрифт.
4. Базовые знания C# и работы с PDF.

Если вы готовы, давайте перейдем к импорту необходимых пакетов.

## Импортные пакеты

В вашем проекте C# вам нужно будет импортировать пространства имен Aspose.PDF для работы с функциями PDF. Вот как это сделать:

```csharp
using Aspose.Pdf.Text;
using System.IO;
```

Эти пространства имен позволяют создавать и обрабатывать PDF-документы, а также работать с форматированием текста и параметрами шрифтов.

Мы разобьем это на небольшие шаги, чтобы вы могли легко следовать. Каждый шаг будет сосредоточен на ключевой части процесса, от настройки вашего PDF до указания межстрочного интервала.

## Шаг 1: Настройте свой проект и определите каталог документов

Первое, что нам нужно сделать, это определить, где находятся наши файлы. Это поможет программе узнать, где найти шрифт и где сохранить полученный PDF.

```csharp
string dataDir = "YOUR DOCUMENT DIRECTORY";
string fontFile = dataDir + "HPSimplified.TTF";
```

 На этом этапе вы замените`"YOUR DOCUMENT DIRECTORY"` с фактическим путем к месту, где вы храните свои файлы. Это будет то место, где вы разместите свой файл шрифта (`HPSimplified.TTF`) и где будет сохранен PDF-файл.

## Шаг 2: Загрузите PDF-документ

Теперь нам нужно создать новый PDF-документ. Для этого руководства мы начнем с пустого документа, но вы также можете загрузить существующий PDF-файл, если это необходимо.

```csharp
Document doc = new Document();
```

Это создаст новый, пустой PDF-документ. Легко, правда?

## Шаг 3: Задайте параметры форматирования текста

 Вот где происходит волшебство. Мы укажем режим межстрочного интервала для текста, который мы хотим добавить в PDF. Aspose.PDF дает нам несколько вариантов, но в этом руководстве мы будем использовать`LineSpacingMode.FullSize`, что гарантирует полное соблюдение межстрочного интервала.

```csharp
TextFormattingOptions formattingOptions = new TextFormattingOptions();
formattingOptions.LineSpacing = TextFormattingOptions.LineSpacingMode.FullSize;
```

 Этот код устанавливает режим межстрочного интервала`FullSize` , гарантируя, что текст будет отображаться с правильным интервалом. Есть и другие варианты, такие как`Proportional` если вы хотите использовать другие варианты поведения интервалов, но сейчас давайте остановимся на`FullSize`.

## Шаг 4: Создайте фрагмент текста

Теперь мы создадим сам текст, который будет помещен в PDF. Этот текст будет соответствовать заданному нами межстрочному интервалу.

```csharp
TextFragment textFragment = new TextFragment("Hello world");
```

 Мы создали фрагмент текста со строкой`"Hello world"`. Конечно, вы можете настроить этот текст по своему усмотрению.

## Шаг 5: Загрузите и примените пользовательский шрифт

Чтобы текст выделялся, мы загрузим пользовательский шрифт TrueType из файла. Этот шаг необязателен, но он может добавить профессиональный штрих вашим PDF-файлам.

```csharp
if (fontFile != "")
{
    using (FileStream fontStream = System.IO.File.OpenRead(fontFile))
    {
        textFragment.TextState.Font = FontRepository.OpenFont(fontStream, FontTypes.TTF);
```

Здесь мы загружаем файл шрифта и применяем его к фрагменту текста. Если путь к файлу действителен, используется шрифт. В противном случае применяется шрифт по умолчанию.

## Шаг 6: Задайте положение и форматирование текста

Далее нам нужно расположить текст в PDF. Мы также применим параметры форматирования, которые мы создали ранее.

```csharp
textFragment.Position = new Position(100, 600);
textFragment.TextState.FormattingOptions = formattingOptions;
```

 The`Position` Метод задает координаты, в которых текст будет отображаться на странице (в данном случае 100 единиц слева и 600 единиц снизу). Здесь применяются параметры форматирования, включая режим межстрочного интервала.

## Шаг 7: Добавьте текст на страницу PDF-файла

Теперь, когда наш текст отформатирован и позиционирован, пришло время добавить его в PDF-документ.

```csharp
var page = doc.Pages.Add();
page.Paragraphs.Add(textFragment);
```

Этот код создает новую страницу в PDF-документе и добавляет на нее текстовый фрагмент.

## Шаг 8: Сохраните PDF-файл

Мы достигли последнего шага! Теперь, когда все настроено, давайте сохраним PDF.

```csharp
dataDir = dataDir + "SpecifyLineSpacing_out.pdf";
doc.Save(dataDir);
```

Это сохранит PDF-файл с указанным межстрочным интервалом, и ваш файл готов!

## Заключение

И все! Вы только что создали PDF-документ с пользовательским межстрочным интервалом с помощью Aspose.PDF для .NET. Это мощный инструмент, который позволяет вам контролировать каждый аспект ваших PDF-файлов, и это всего лишь один пример того, чего вы можете достичь. От размещения текста до форматирования — возможности безграничны.

Если вы хотите глубже погрузиться в манипуляции PDF, Aspose.PDF предлагает множество функций для изучения. Не стесняйтесь экспериментировать и расширять границы того, что вы можете делать со своими документами!

## Часто задаваемые вопросы

### Могу ли я настроить межстрочный интервал для других режимов?  
 Да, вы можете использовать другие режимы, такие как`Proportional` или`Fixed` в зависимости от ваших потребностей.

### Можно ли загрузить шрифты из системы, а не из файла?  
 Да, вы можете загрузить установленные в системе шрифты с помощью`FontRepository`.

### Могу ли я использовать Aspose.PDF для .NET с другими форматами файлов?  
Конечно! Aspose.PDF для .NET поддерживает множество форматов, таких как XML, HTML и другие.

### Нужна ли мне лицензия для использования Aspose.PDF для .NET?  
Да, для полной функциональности вам понадобится лицензия, которую вы можете получить[здесь](https://purchase.aspose.com/buy).

### Как установить межстрочный интервал для нескольких абзацев?  
 Вы можете подать заявку`TextFormattingOptions` каждому`TextFragment` или`TextParagraph` для управления интервалом между несколькими строками или абзацами.