---
title: ค้นหาข้อความและวาดรูปสี่เหลี่ยมผืนผ้า
linktitle: ค้นหาข้อความและวาดรูปสี่เหลี่ยมผืนผ้า
second_title: เอกสารอ้างอิง Aspose.PDF สำหรับ API ของ .NET
description: เรียนรู้วิธีค้นหาข้อความใน PDF วาดรูปสี่เหลี่ยมผืนผ้ารอบข้อความที่พบ และบันทึกเอกสารที่แก้ไขโดยใช้ Aspose.PDF สำหรับ .NET
type: docs
weight: 460
url: /th/net/programming-with-text/search-text-and-draw-rectangle/
---
บทช่วยสอนนี้จะอธิบายวิธีการใช้ Aspose.PDF สำหรับ .NET เพื่อค้นหาข้อความเฉพาะในเอกสาร PDF วาดสี่เหลี่ยมผืนผ้ารอบข้อความที่พบ และบันทึกเอกสารที่แก้ไขแล้ว โค้ดต้นฉบับ C# ที่ให้มาจะสาธิตขั้นตอนต่างๆ ทีละขั้นตอน

## ข้อกำหนดเบื้องต้น

ก่อนที่จะดำเนินการตามบทช่วยสอน โปรดแน่ใจว่าคุณมีสิ่งต่อไปนี้:

- ความรู้พื้นฐานเกี่ยวกับภาษาการเขียนโปรแกรม C#
- ติดตั้งไลบรารี Aspose.PDF สำหรับ .NET แล้ว คุณสามารถดาวน์โหลดได้จากเว็บไซต์ Aspose หรือใช้ NuGet เพื่อติดตั้งในโปรเจ็กต์ของคุณ

## ขั้นตอนที่ 1: ตั้งค่าโครงการ

เริ่มต้นด้วยการสร้างโครงการ C# ใหม่ในสภาพแวดล้อมการพัฒนาแบบบูรณาการ (IDE) ที่คุณต้องการ และเพิ่มการอ้างอิงไปยังไลบรารี Aspose.PDF สำหรับ .NET

## ขั้นตอนที่ 2: นำเข้าเนมสเปซที่จำเป็น

เพิ่มคำสั่ง using ต่อไปนี้ที่จุดเริ่มต้นของไฟล์ C# ของคุณเพื่อนำเข้าเนมสเปซที่จำเป็น:

```csharp
using Aspose.Pdf;
using Aspose.Pdf.Text;
using Aspose.Pdf.Content;
using Aspose.Pdf.Facades;
```

## ขั้นตอนที่ 3: ตั้งค่าเส้นทางไปยังไดเรกทอรีเอกสาร

 ตั้งค่าเส้นทางไปยังไดเรกทอรีเอกสารของคุณโดยใช้`dataDir` ตัวแปร:

```csharp
string dataDir = "YOUR DOCUMENT DIRECTORY";
```

 แทนที่`"YOUR DOCUMENT DIRECTORY"` พร้อมเส้นทางจริงไปยังไดเร็กทอรีเอกสารของคุณ

## ขั้นตอนที่ 4: โหลดเอกสาร PDF

 โหลดเอกสาร PDF โดยใช้`Document` ระดับ:

```csharp
Document document = new Document(dataDir + "SearchAndGetTextFromAll.pdf");
```

 แทนที่`"SearchAndGetTextFromAll.pdf"` ด้วยชื่อจริงของไฟล์ PDF ของคุณ

## ขั้นตอนที่ 5: สร้าง TextFragmentAbsorber

 สร้าง`TextFragmentAbsorber` วัตถุที่จะค้นหาอินสแตนซ์ทั้งหมดของวลีการค้นหาอินพุต:

```csharp
TextFragmentAbsorber textAbsorber = new TextFragmentAbsorber(@"[\S]+");
```

 แทนที่`@"[\S]+"` ด้วยรูปแบบนิพจน์ปกติของคุณตามที่ต้องการ

## ขั้นตอนที่ 6: เปิดใช้งานการค้นหาด้วยนิพจน์ปกติ

 เปิดใช้งานการค้นหานิพจน์ปกติโดยตั้งค่า`TextSearchOptions` คุณสมบัติของตัวดูดซับ:

```csharp
TextSearchOptions textSearchOptions = new TextSearchOptions(true);
textAbsorber.TextSearchOptions = textSearchOptions;
```

## ขั้นตอนที่ 7: ค้นหาในทุกหน้า

รับตัวดูดซับสำหรับทุกหน้าของเอกสาร:

```csharp
document.Pages.Accept(textAbsorber);
```

## ขั้นตอนที่ 8: วาดรูปสี่เหลี่ยมผืนผ้ารอบข้อความที่พบ

 สร้าง`PdfContentEditor` วัตถุและวนซ้ำผ่านส่วนของข้อความที่เรียกค้นมา โดยวาดรูปสี่เหลี่ยมผืนผ้ารอบส่วนข้อความแต่ละส่วน:

```csharp
var editor = new PdfContentEditor(document);
foreach (TextFragment textFragment in textAbsorber.TextFragments)
{
    foreach (TextSegment textSegment in textFragment.Segments)
    {
        DrawBox(editor, textFragment.Page.Number, textSegment, System.Drawing.Color.Red);
    }
}
```

## ขั้นตอนที่ 9: บันทึกเอกสารที่แก้ไข

บันทึกเอกสารที่แก้ไข:

```csharp
dataDir = dataDir + "SearchTextAndDrawRectangle_out.pdf";
document.Save(dataDir);
```

 อย่าลืมเปลี่ยน`"SearchTextAndDrawRectangle_out.pdf"` พร้อมชื่อไฟล์เอาท์พุตตามที่ต้องการ

### ตัวอย่างโค้ดต้นฉบับสำหรับการค้นหาข้อความและวาดสี่เหลี่ยมโดยใช้ Aspose.PDF สำหรับ .NET 
```csharp
// เส้นทางไปยังไดเร็กทอรีเอกสาร
string dataDir = "YOUR DOCUMENT DIRECTORY";
// เปิดเอกสาร
Document document = new Document(dataDir + "SearchAndGetTextFromAll.pdf");
//สร้างวัตถุ TextAbsorber เพื่อค้นหาวลีทั้งหมดที่ตรงกับนิพจน์ทั่วไป
TextFragmentAbsorber textAbsorber = new TextFragmentAbsorber(@"[\S]+");
TextSearchOptions textSearchOptions = new TextSearchOptions(true);
textAbsorber.TextSearchOptions = textSearchOptions;
document.Pages.Accept(textAbsorber); 
var editor = new PdfContentEditor(document); 
foreach (TextFragment textFragment in textAbsorber.TextFragments)
{
	foreach (TextSegment textSegment in textFragment.Segments)
	{
			DrawBox(editor, textFragment.Page.Number, textSegment, System.Drawing.Color.Red);
	}
}
dataDir = dataDir + "SearchTextAndDrawRectangle_out.pdf";
document.Save(dataDir);
Console.WriteLine("\nRectangle drawn successfully on searched text.\nFile saved at " + dataDir);
```

## บทสรุป

ขอแสดงความยินดี! คุณได้เรียนรู้วิธีค้นหาข้อความเฉพาะในเอกสาร PDF วาดรูปสี่เหลี่ยมผืนผ้ารอบข้อความที่พบ และบันทึกเอกสารที่แก้ไขโดยใช้ Aspose.PDF สำหรับ .NET สำเร็จแล้ว บทช่วยสอนนี้ให้คำแนะนำทีละขั้นตอนตั้งแต่การตั้งค่าโครงการไปจนถึงการดำเนินการที่จำเป็น ตอนนี้คุณสามารถนำโค้ดนี้ไปใช้กับโครงการ C# ของคุณเองเพื่อจัดการข้อความและวาดรูปสี่เหลี่ยมผืนผ้าในไฟล์ PDF

### คำถามที่พบบ่อย

#### ถาม: จุดประสงค์ของบทช่วยสอน "ค้นหาข้อความและวาดสี่เหลี่ยมผืนผ้า" คืออะไร

A: บทช่วยสอน "ค้นหาข้อความและวาดสี่เหลี่ยมผืนผ้า" มีวัตถุประสงค์เพื่อแนะนำผู้ใช้ตลอดขั้นตอนการใช้ไลบรารี Aspose.PDF สำหรับ .NET เพื่อค้นหาข้อความเฉพาะภายในเอกสาร PDF วาดสี่เหลี่ยมผืนผ้ารอบส่วนข้อความที่พบ และบันทึกเอกสารที่แก้ไข บทช่วยสอนให้คำแนะนำโดยละเอียดและตัวอย่างโค้ด C# เพื่ออธิบายขั้นตอนต่างๆ ของกระบวนการ

#### ถาม: บทช่วยสอนนี้ช่วยในการวาดรูปสี่เหลี่ยมผืนผ้ารอบข้อความเฉพาะในเอกสาร PDF ได้อย่างไร

A: บทช่วยสอนนี้ให้คำแนะนำที่ครอบคลุมเกี่ยวกับวิธีการค้นหาและวาดสี่เหลี่ยมผืนผ้ารอบ ๆ ส่วนข้อความเฉพาะภายในเอกสาร PDF โดยจะสาธิตขั้นตอนการตั้งค่าโครงการ การโหลดเอกสาร PDF การเปิดใช้งานการค้นหานิพจน์ทั่วไป การวาดสี่เหลี่ยมผืนผ้ารอบ ๆ ส่วนข้อความที่พบ และการบันทึก PDF ที่แก้ไขแล้ว

#### ถาม: มีข้อกำหนดเบื้องต้นอะไรบ้างที่ต้องปฏิบัติตามบทช่วยสอนนี้?

A: ก่อนเริ่มบทช่วยสอน คุณควรมีความเข้าใจพื้นฐานเกี่ยวกับภาษาการเขียนโปรแกรม C# นอกจากนี้ คุณต้องติดตั้งไลบรารี Aspose.PDF สำหรับ .NET คุณสามารถรับได้จากเว็บไซต์ Aspose หรือติดตั้งในโปรเจ็กต์ของคุณโดยใช้ NuGet

#### ถาม: ฉันจะตั้งค่าโครงการเพื่อทำตามบทช่วยสอนนี้ได้อย่างไร

A: เริ่มต้นด้วยการสร้างโปรเจ็กต์ C# ใหม่ในสภาพแวดล้อมการพัฒนาแบบบูรณาการ (IDE) ที่คุณต้องการ จากนั้นเพิ่มการอ้างอิงไปยังไลบรารี Aspose.PDF สำหรับ .NET ลงในโปรเจ็กต์ของคุณ วิธีนี้จะช่วยให้คุณใช้ฟังก์ชันการทำงานของไลบรารีเพื่อจัดการเอกสาร PDF ได้

#### ถาม: ฉันสามารถวาดรูปสี่เหลี่ยมผืนผ้ารอบข้อความเฉพาะโดยใช้บทช่วยสอนนี้ได้หรือไม่

A: ใช่ บทช่วยสอนนี้เน้นที่การวาดรูปสี่เหลี่ยมผืนผ้ารอบข้อความบางส่วนในเอกสาร PDF โดยจะสาธิตวิธีการค้นหาข้อความที่ต้องการโดยใช้นิพจน์ทั่วไป การสร้างรูปสี่เหลี่ยมผืนผ้ารอบข้อความบางส่วนที่ระบุ และการบันทึก PDF ที่แก้ไขแล้ว

#### ถาม: ฉันจะระบุข้อความที่ฉันต้องการค้นหาและวาดรูปสี่เหลี่ยมผืนผ้ารอบๆ ได้อย่างไร

 ก: เพื่อระบุข้อความที่คุณต้องการค้นหาและวาดรูปสี่เหลี่ยมผืนผ้ารอบๆ ให้สร้าง`TextFragmentAbsorber` วัตถุและกำหนดรูปแบบโดยใช้`Text` พารามิเตอร์ แทนที่รูปแบบเริ่มต้น`@"[\S]+"` ในโค้ดของบทช่วยสอนพร้อมรูปแบบนิพจน์ปกติที่คุณต้องการ

#### ถาม: ฉันจะเปิดใช้งานการค้นหานิพจน์ปกติสำหรับข้อความได้อย่างไร

 A: การค้นหาด้วยนิพจน์ปกติจะเปิดใช้งานได้โดยการสร้าง`TextSearchOptions` วัตถุและการตั้งค่าเป็น`true` . กำหนดวัตถุนี้ให้กับ`TextSearchOptions` ทรัพย์สินของ`TextFragmentAbsorber` อินสแตนซ์ การดำเนินการนี้จะช่วยให้แน่ใจว่ารูปแบบนิพจน์ทั่วไปจะถูกใช้ในระหว่างการค้นหาข้อความ

#### ถาม: ฉันจะวาดรูปสี่เหลี่ยมผืนผ้ารอบข้อความที่พบได้อย่างไร

 ก: หลังจากระบุกลุ่มข้อความโดยใช้`TextFragmentAbsorber` บทช่วยสอนนี้ให้ลูปเพื่อวนซ้ำผ่านส่วนต่างๆ เหล่านี้ สำหรับแต่ละส่วนของข้อความ บทช่วยสอนนี้จะสาธิตวิธีการสร้างสี่เหลี่ยมผืนผ้ารอบๆ โดยใช้`DrawBox` วิธีการและระบุลักษณะของรูปสี่เหลี่ยม

#### ถาม: ขั้นตอนการบันทึก PDF ที่ปรับเปลี่ยนแล้วพร้อมรูปสี่เหลี่ยมผืนผ้าที่วาดไว้มีอะไรบ้าง

ก: หลังจากวาดรูปสี่เหลี่ยมผืนผ้ารอบส่วนข้อความที่ต้องการแล้ว ให้ใช้`Document` ชั้นเรียน`Save` วิธีการบันทึกเอกสารที่แก้ไขแล้ว ตัวอย่างโค้ดของบทช่วยสอนจะแสดงวิธีการบันทึก PDF ที่แก้ไขแล้วและแสดงข้อความแจ้งว่าสำเร็จ

#### ถาม: ฉันสามารถปรับแต่งลักษณะของรูปสี่เหลี่ยมที่วาดได้หรือไม่

 A: ใช่ คุณสามารถปรับแต่งลักษณะของรูปสี่เหลี่ยมที่วาดได้ ในโค้ดตัวอย่างของบทช่วยสอน`DrawBox` วิธีนี้ใช้เพื่อสร้างรูปสี่เหลี่ยมผืนผ้า คุณสามารถปรับเปลี่ยนคุณสมบัติต่างๆ เช่น สี สไตล์ และความหนา เพื่อปรับแต่งลักษณะของรูปสี่เหลี่ยมผืนผ้าที่วาดได้