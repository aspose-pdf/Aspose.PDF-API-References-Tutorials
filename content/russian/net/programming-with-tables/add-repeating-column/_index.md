---
title: Добавить повторяющийся столбец в PDF-документ
linktitle: Добавить повторяющийся столбец в PDF-документ
second_title: Справочник по API Aspose.PDF для .NET
description: Узнайте, как добавлять повторяющиеся столбцы в документы PDF с помощью Aspose.PDF для .NET. Пошаговое руководство с примерами и кодом. Идеально подходит для разработчиков.
type: docs
weight: 20
url: /ru/net/programming-with-tables/add-repeating-column/
---
## Введение

Если вы работаете с PDF-документами и вам нужно добавить повторяющиеся столбцы, вы попали по адресу! Используя Aspose.PDF для .NET, вы можете легко управлять таблицами и содержимым в PDF-файле. Независимо от того, создаете ли вы динамические отчеты, счета-фактуры или любой другой структурированный документ, повторяющиеся столбцы могут стать решающим фактором в организации данных. Давайте рассмотрим пошаговое руководство по добавлению повторяющихся столбцов в PDF-документ.

## Предпосылки

Прежде чем перейти к коду, давайте убедимся, что у вас все настроено:

- Aspose.PDF для .NET: в вашем проекте должна быть установлена библиотека Aspose.PDF для .NET.
- [Загрузить Aspose.PDF для .NET](https://releases.aspose.com/pdf/net/)
- [Бесплатная пробная версия](https://releases.aspose.com/)
- Среда разработки: убедитесь, что у вас установлена совместимая с .NET среда разработки, например Visual Studio.
- Базовые знания C#: хотя мы и будем все подробно разбирать, базовые знания C# помогут вам без труда усвоить материал.
  
 Если у вас еще нет Aspose.PDF для .NET, вы можете получить[временная лицензия](https://purchase.aspose.com/temporary-license/) чтобы начать изучать его возможности.

## Импортные пакеты

Для начала вам нужно импортировать необходимые пространства имен из Aspose.PDF для .NET. Вот как это сделать:

```csharp
using Aspose.Pdf;
using Aspose.Pdf.Text;
```

Эти пакеты предоставляют основные классы и методы, необходимые для работы с PDF-документами и управления таблицами.

Теперь давайте разобьем процесс на несколько шагов, чтобы добавить повторяющиеся столбцы в документ PDF. Следуйте инструкциям!

## Шаг 1: Укажите путь к каталогу ваших документов

Прежде чем создавать или манипулировать любыми файлами, нам нужно определить путь, по которому будет сохранен сгенерированный PDF. В вашем проекте C# задайте путь к каталогу, где будут располагаться ваши файлы:

```csharp
string dataDir = "YOUR DOCUMENT DIRECTORY";
string outFile = dataDir + "AddRepeatingColumn_out.pdf";
```

 Этот путь указывает на каталог, в котором будет сохранен выходной PDF-файл. Заменить`"YOUR DOCUMENT DIRECTORY"` с реальным путем на вашем компьютере.

## Шаг 2: Создайте новый PDF-документ

 Для начала создайте новый экземпляр`Document` объект. Он будет служить контейнером для всех страниц и содержимого PDF-файла.

```csharp
Document doc = new Document();
Aspose.Pdf.Page page = doc.Pages.Add();
```

 Здесь мы создали новый PDF-документ и добавили в него пустую страницу.`doc.Pages.Add()` метод вставляет новую страницу в документ.

## Шаг 3: Создание внешней таблицы

Далее мы создаем внешнюю таблицу. Эта таблица будет охватывать всю ширину страницы и служить контейнером для других таблиц, включая ту, которая будет содержать повторяющиеся столбцы.

```csharp
Aspose.Pdf.Table outerTable = new Aspose.Pdf.Table();
outerTable.ColumnWidths = "100%";
outerTable.HorizontalAlignment = HorizontalAlignment.Left;
```

 Мы установили`ColumnWidths` значение «100%», что означает, что таблица будет растянута на всю ширину страницы.

## Шаг 4: Создание внутренней таблицы

 Теперь давайте создадим внутреннюю таблицу, которая будет иметь повторяющиеся столбцы. Ключевые свойства здесь:`Broken` , что позволяет продолжить таблицу на той же странице, и`ColumnAdjustment`, который автоматически регулирует ширину столбцов в соответствии с содержимым.

```csharp
Aspose.Pdf.Table mytable = new Aspose.Pdf.Table();
mytable.Broken = TableBroken.VerticalInSamePage;
mytable.ColumnAdjustment = ColumnAdjustment.AutoFitToContent;
```

Эта внутренняя таблица будет вложена во внешнюю таблицу.

## Шаг 5: Добавьте таблицы на страницу

Теперь, когда у нас готовы и внешняя, и внутренняя таблицы, давайте добавим их на страницу. Этот шаг гарантирует, что таблицы включены в структуру документа.

```csharp
page.Paragraphs.Add(outerTable);
var bodyRow = outerTable.Rows.Add();
var bodyCell = bodyRow.Cells.Add();
bodyCell.Paragraphs.Add(mytable);
mytable.RepeatingColumnsCount = 5;
```

 Здесь мы добавили`outerTable` на страницу, а затем во внешнюю таблицу мы вложили`mytable` . Кроме того, мы устанавливаем`RepeatingColumnsCount`до 5, указав, сколько столбцов должно повторяться при добавлении данных.

## Шаг 6: Добавьте строку заголовка

Теперь пришло время добавить заголовки в таблицу. Строка заголовка дает контекст данным и помогает структурировать столбцы. 

```csharp
Aspose.Pdf.Row row = mytable.Rows.Add();
row.Cells.Add("header 1");
row.Cells.Add("header 2");
row.Cells.Add("header 3");
row.Cells.Add("header 4");
row.Cells.Add("header 5");
row.Cells.Add("header 6");
row.Cells.Add("header 7");
row.Cells.Add("header 11");
row.Cells.Add("header 12");
row.Cells.Add("header 13");
row.Cells.Add("header 14");
row.Cells.Add("header 15");
row.Cells.Add("header 16");
row.Cells.Add("header 17");
```

Этот фрагмент кода добавляет первую строку (которую мы будем использовать в качестве заголовков) и заполняет ее ячейками, содержащими текст, например «заголовок 1», «заголовок 2» и т. д.

## Шаг 7: Добавьте строки данных

Наконец, мы можем добавить некоторые данные в таблицу. Этот цикл динамически создает строки и заполняет ячейки содержимым:

```csharp
for (int RowCounter = 0; RowCounter <= 5; RowCounter++)
{
    Aspose.Pdf.Row row1 = mytable.Rows.Add();
    row1.Cells.Add("col " + RowCounter.ToString() + ", 1");
    row1.Cells.Add("col " + RowCounter.ToString() + ", 2");
    row1.Cells.Add("col " + RowCounter.ToString() + ", 3");
    row1.Cells.Add("col " + RowCounter.ToString() + ", 4");
    row1.Cells.Add("col " + RowCounter.ToString() + ", 5");
    row1.Cells.Add("col " + RowCounter.ToString() + ", 6");
    row1.Cells.Add("col " + RowCounter.ToString() + ", 7");
    row1.Cells.Add("col " + RowCounter.ToString() + ", 11");
    row1.Cells.Add("col " + RowCounter.ToString() + ", 12");
    row1.Cells.Add("col " + RowCounter.ToString() + ", 13");
    row1.Cells.Add("col " + RowCounter.ToString() + ", 14");
    row1.Cells.Add("col " + RowCounter.ToString() + ", 15");
    row1.Cells.Add("col " + RowCounter.ToString() + ", 16");
    row1.Cells.Add("col " + RowCounter.ToString() + ", 17");
}
```

Цикл повторяется шесть раз, добавляя строки и заполняя каждую ячейку соответствующими данными столбцов (например, «col 1, 1», «col 2, 2» и т. д.).

## Шаг 8: Сохраните документ.

После добавления всех строк и столбцов последним шагом будет сохранение документа по указанному пути.

```csharp
doc.Save(outFile);
```

Ваш документ теперь сохранен с повторяющимися столбцами!

## Заключение

Вот и все! С помощью этих простых шагов вы можете создать PDF-документ с повторяющимися столбцами, используя Aspose.PDF для .NET. Используя гибкость вложенных таблиц, вы можете добиться сложных макетов, которые сделают ваши PDF-файлы профессиональными и организованными. Попробуйте это для своего следующего проекта и изучите весь потенциал Aspose.PDF для удовлетворения ваших потребностей в создании PDF-файлов.

## Часто задаваемые вопросы

### Что такое Aspose.PDF для .NET?
Aspose.PDF для .NET — это мощная библиотека, которая позволяет разработчикам создавать, редактировать и управлять PDF-документами программным способом.

### Можно ли динамически регулировать количество повторяющихся столбцов?
 Да, вы можете изменить количество повторяющихся столбцов, изменив`RepeatingColumnsCount` свойство.

### Как применить лицензию к Aspose.PDF для .NET?
 Вы можете применить лицензию из файла или потока, следуя инструкциям[документация](https://reference.aspose.com/pdf/net/).

### Можно ли добавлять изображения в ячейки таблицы?
Да, Aspose.PDF для .NET поддерживает добавление различных типов контента, включая изображения, в ячейки таблиц.

### Могу ли я дополнительно настроить макет таблицы?
Конечно! Aspose.PDF предоставляет обширные возможности для настройки стилей таблиц, включая границы, отступы, выравнивание и многое другое.