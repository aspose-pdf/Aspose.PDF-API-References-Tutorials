---
title: استخراج معلومات التوقيع
linktitle: استخراج معلومات التوقيع
second_title: Aspose.PDF لمرجع .NET API
description: استخراج معلومات التوقيع باستخدام Aspose.PDF لـ .NET.
type: docs
weight: 80
url: /ar/net/programming-with-security-and-signatures/extract-signature-info/
---
يمكن أن تكون عملية استخراج معلومات التوقيع من مستند PDF مفيدة جدًا في سيناريوهات مختلفة. سواء أكنت بحاجة إلى التحقق من صحة وثيقة موقعة أو تحليل الشهادة المستخدمة للتوقيع ، توفر مكتبة Aspose.PDF for .NET حلاً مناسبًا. في هذا البرنامج التعليمي ، سنوجهك خلال العملية خطوة بخطوة لاستخراج معلومات التوقيع باستخدام كود المصدر C # المقدم.

## متطلبات

قبل أن نبدأ ، تأكد من توفر المتطلبات الأساسية التالية:

1. المعرفة الأساسية بلغة البرمجة C #.
2. Aspose.PDF لمكتبة .NET مثبتة على نظامك.
3. وثيقة PDF صالحة مع واحد أو أكثر من حقول التوقيع.

الآن ، دعنا نتعمق في تفاصيل التنفيذ.

## الخطوة 1: استيراد المكتبات المطلوبة

 للبدء ، تحتاج إلى استيراد المكتبات الضرورية إلى مشروع C # الخاص بك. في هذه الحالة ، نحتاج إلى استيراد ملف`Aspose.Pdf` و`System.IO` مساحات الأسماء. يمكن القيام بذلك عن طريق إضافة الكود التالي في بداية ملف C # الخاص بك:

```csharp
using Aspose.Pdf;
using System.IO;
```

## الخطوة 2: ضبط مسار المستند

بعد ذلك ، تحتاج إلى تعيين المسار إلى مستند PDF الذي تريد استخراج معلومات التوقيع منه. يستبدل`"YOUR DOCUMENTS DIRECTORY"` في مقتطف الشفرة التالي بالمسار الفعلي للمستند:

```csharp
string dataDir = "YOUR DOCUMENTS DIRECTORY";
string input = dataDir + "ExtractSignatureInfo.pdf";
```

## الخطوة 3: استخراج معلومات التوقيع

الآن ، دعنا ننتقل إلى الجزء الرئيسي من الكود حيث نقوم باستخراج معلومات التوقيع من مستند PDF. نحن نكرر كل حقل في نموذج المستند ونتحقق مما إذا كان حقل توقيع. إذا تم العثور على حقل توقيع ، فإننا نواصل استخراج الشهادة. أضف مقتطف الشفرة التالي:

```csharp
using (Document pdfDocument = new Document(input))
{
     foreach(Field field in pdfDocument.Form)
     {
         SignatureField sf = field as SignatureField;
         if (sf != null)
         {
             // استخراج الشهادة
             Stream cerStream = sf.ExtractCertificate();
             if (cerStream != null)
             {
                 using (cerStream)
                 {
                     byte[] bytes = new byte[cerStream.Length];
                     using (FileStream fs = new FileStream(dataDir + @"input.cer", FileMode.CreateNew))
                     {
                         cerStream.Read(bytes, 0, bytes.Length);
                         fs.Write(bytes, 0, bytes.Length);
                     }
                 }
             }
         }
     }
}
```

## الخطوة 4: استخراج الشهادة

في هذه الخطوة ، نقوم باستخراج الشهادة من حقل التوقيع وحفظها كملف. يمكن تحليل الشهادة المستخرجة أو استخدامها لأغراض التحقق من الصحة. يوضح مقتطف الشفرة أدناه عملية الاستخراج والحفظ:

```csharp
Stream cerStream = sf.ExtractCertificate();
if (cerStream != null)
{
     using (cerStream)
     {
         byte[] bytes = new byte[cerStream.Length];
         using (FileStream fs = new FileStream(dataDir + @"input.cer", FileMode.CreateNew))
         {
             cerStream.Read(bytes, 0, bytes.Length);
             fs.Write(bytes, 0, bytes.Length);
         }
     }
}
```

## الخطوة الخامسة

: حفظ الشهادة

أخيرًا ، نحفظ الشهادة المستخرجة كملف. في هذا المثال ، يتم حفظ الشهادة باسم "input.cer" في الدليل المحدد. يمكنك تعديل الكود ليناسب متطلباتك. إليك مقتطف الشفرة لحفظ الشهادة:

```csharp
using (FileStream fs = new FileStream(dataDir + @"input.cer", FileMode.CreateNew))
{
     fs.Write(bytes, 0, bytes.Length);
}
```

هذا كل شيء! لقد نجحت في استخراج معلومات التوقيع باستخدام Aspose.PDF for .NET. لا تتردد في دمج هذا الرمز في تطبيقاتك الخاصة أو تعديله وفقًا لاحتياجاتك.

### نموذج التعليمات البرمجية المصدر لـ Extract Signature Info باستخدام Aspose.PDF for .NET 
```csharp
try
{
	// المسار إلى دليل المستندات.
	string dataDir = "YOUR DOCUMENTS DIRECTORY";
	string input = dataDir + "ExtractSignatureInfo.pdf";
	using (Document pdfDocument = new Document(input))
	{
		foreach (Field field in pdfDocument.Form)
		{
			SignatureField sf = field as SignatureField;
			if (sf != null)
			{
				Stream cerStream = sf.ExtractCertificate();
				if (cerStream != null)
				{
					using (cerStream)
					{
						byte[] bytes = new byte[cerStream.Length];
						using (FileStream fs = new FileStream(dataDir + @"input.cer", FileMode.CreateNew))
						{
							cerStream.Read(bytes, 0, bytes.Length);
							fs.Write(bytes, 0, bytes.Length);
						}
					}
				}
			}
		}
	}
}
catch (Exception ex)
{
	Console.WriteLine(ex.Message);
}
```

## خاتمة

في هذا البرنامج التعليمي ، استعرضنا دليلًا تفصيليًا حول كيفية استخراج معلومات التوقيع من مستند PDF باستخدام Aspose.PDF لمكتبة .NET. قمنا بتغطية عملية استيراد المكتبات المطلوبة ، وتحديد مسار المستند ، واستخراج معلومات التوقيع ، واستخراج الشهادة ، وحفظها في ملف. باتباع هذه الخطوات ، يمكنك بسهولة استرداد تفاصيل التوقيع والعمل معها حسب الحاجة.

### التعليمات

#### س: لماذا أحتاج إلى استخراج معلومات التوقيع من مستند PDF؟

ج: يعد استخراج معلومات التوقيع من مستند PDF مفيدًا للتحقق من صحة المستند الموقع وتحليل الشهادة المستخدمة للتوقيع. تساعد هذه العملية في ضمان سلامة المحتوى الموقع ويمكن أن تكون ضرورية للأغراض القانونية والأمنية.

#### س: ما هو Aspose.PDF لـ .NET؟

ج: Aspose.PDF for .NET هي مكتبة تتيح للمطورين العمل مع مستندات PDF في تطبيقات .NET. يوفر مجموعة واسعة من الميزات لإنشاء ملفات PDF وتعديلها والتفاعل معها برمجيًا.

#### س: ما هي المتطلبات الأساسية لاستخراج معلومات التوقيع باستخدام Aspose.PDF for .NET؟

ج: لاستخراج معلومات التوقيع ، تحتاج إلى معرفة أساسية بلغة البرمجة C # ، ومكتبة Aspose.PDF for .NET المثبتة على نظامك ، ووثيقة PDF صالحة تحتوي على حقل توقيع واحد أو أكثر.

#### س: كيف يمكنني استيراد المكتبات المطلوبة لعملية الاستخراج؟

ج: يمكنك استيراد المكتبات الضرورية عن طريق إضافة ملف`using` توجيهات لـ`Aspose.Pdf` و`System.IO` في بداية ملف C # الخاص بك. تمكنك هذه التوجيهات من استخدام الفئات والطرق المطلوبة لاستخراج معلومات التوقيع.

#### س: كيف أحدد وثيقة PDF لاستخراج معلومات التوقيع؟

 ج: يمكنك ضبط المسار إلى مستند PDF عن طريق الاستبدال`"YOUR DOCUMENTS DIRECTORY"` بالمسار الفعلي للمستند في مقتطف الشفرة المقدم. يستخدم هذا المسار لتحميل وثيقة PDF التي تريد استخراج معلومات التوقيع منها.

#### س: ما هي عملية استخراج معلومات التوقيع من وثيقة PDF؟

ج: تتضمن عملية الاستخراج التكرار عبر حقول النموذج في مستند PDF ، والتحقق مما إذا كان كل حقل هو حقل توقيع ، وإذا كان الأمر كذلك ، استخراج الشهادة المرتبطة. يمكن حفظ الشهادة المستخرجة كملف لمزيد من التحليل أو التحقق من صحتها.

#### س: كيف يتم استخلاص الشهادة من حقل التوقيع؟

ج: يتم استخراج الشهادة من حقل التوقيع باستخدام`ExtractCertificate()` الطريقة التي يوفرها`SignatureField` فئة في Aspose.PDF لـ .NET. تقوم هذه الطريقة بإرجاع دفق يحتوي على بيانات الشهادة.

#### س: كيف أحفظ الشهادة المستخرجة كملف؟

 ج: يمكنك حفظ الشهادة المستخرجة كملف بقراءة مسار الشهادة وكتابة محتوياتها في ملف باستخدام امتداد`FileStream` فصل. يوضح الكود المقدم في البرنامج التعليمي هذه العملية.

#### س: هل يمكنني استخدام هذه الشهادة المستخرجة للتحقق من صحة التوقيع؟

ج: نعم ، يمكن استخدام الشهادة المستخرجة للتحقق من صحة التوقيع. يمكنك تحليل تفاصيل الشهادة والتحقق من صحتها للتأكد من سلامة الوثيقة الموقعة.

#### س: كيف يمكنني دمج هذا الرمز في تطبيقاتي الخاصة؟

ج: يمكنك دمج الكود المقدم في تطبيقات C # الخاصة بك باتباع الدليل المفصل خطوة بخطوة. قم بتعديل المسارات وأسماء الملفات حسب الحاجة ، ودمج الكود في مشاريعك الحالية.

#### س: هل هناك ميزات أخرى في Aspose.PDF for .NET تتعلق بإدارة التوقيع؟

ج: نعم ، يوفر Aspose.PDF for .NET مجموعة من الميزات للعمل مع التوقيعات الرقمية ، بما في ذلك توقيع المستندات والتحقق من التواقيع وإضافة معلومات الطابع الزمني. يمكنك استكشاف الوثائق الرسمية لمزيد من التفاصيل حول هذه الميزات.

#### س: أين يمكنني العثور على موارد إضافية لاستخدام Aspose.PDF لـ .NET؟

 ج: لمزيد من المعلومات والبرامج التعليمية والموارد حول استخدام Aspose.PDF لـ .NET ،[Aspose.PDF for .NET](https://reference.aspose.com/pdf/net/).

#### س: هل من الممكن استخراج التوقيعات من مستندات PDF المشفرة؟

ج: قد تعتمد القدرة على استخراج التوقيعات من مستندات PDF المشفرة على إعدادات التشفير والأذونات الخاصة بالمستند. قد تحتاج إلى التأكد من أن لديك الأذونات اللازمة للوصول إلى معلومات التوقيع واستخراجها.

#### س: هل يمكنني استخراج عدة تواقيع من مستند PDF واحد؟

ج: نعم ، يمكنك تعديل الكود المقدم للتكرار من خلال جميع حقول التوقيع في مستند PDF واستخراج معلومات التوقيع من كل واحد. يتيح لك ذلك استخراج معلومات حول التواقيع المتعددة الموجودة في المستند.

#### س: ما هي بعض حالات الاستخدام العملي لاستخراج معلومات التوقيع؟

ج: تتضمن بعض حالات الاستخدام العملي لاستخراج معلومات التوقيع التحقق من صحة المستندات الموقعة رقميًا ، وتحليل تفاصيل الشهادة لأغراض الامتثال ، والاحتفاظ بسجل للتوقيعات والموقعين لأغراض التدقيق.

#### س: هل هناك اعتبارات قانونية عند استخراج معلومات التوقيع؟

ج: قد يكون لاستخراج معلومات التوقيع آثار قانونية ، خاصة عند التعامل مع المستندات الملزمة قانونًا. تأكد من امتثالك للوائح والقوانين ذات الصلة المتعلقة بالتوقيعات الإلكترونية وتوثيق الأصالة في منطقتك.