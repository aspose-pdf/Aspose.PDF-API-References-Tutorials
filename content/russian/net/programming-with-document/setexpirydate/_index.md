---
title: Установить дату истечения срока действия в PDF-файле
linktitle: Установить дату истечения срока действия в PDF-файле
second_title: Справочник по Aspose.PDF для .NET API
description: Узнайте, как установить дату истечения срока действия в PDF-файле с помощью Aspose.PDF для .NET, с помощью этого пошагового руководства.
type: docs
weight: 300
url: /ru/net/programming-with-document/setexpirydate/
---
Aspose.PDF for .NET — это мощная библиотека, предоставляющая различные функции для работы с PDF-файлами. Одной из таких функций является возможность установить дату истечения срока действия PDF-документа. В этом уроке мы покажем вам процесс установки даты истечения срока действия PDF-документа с помощью Aspose.PDF для .NET. 

## Шаг 1. Установите путь к каталогу документов.

Прежде чем начать, нам нужно указать путь к каталогу, в котором находится наш PDF-документ. Мы сохраним этот путь в переменной с именем «dataDir».

```csharp
string dataDir = "YOUR DOCUMENT DIRECTORY";
```

## Шаг 2. Создание нового PDF-документа

 Чтобы создать новый PDF-документ, нам нужно создать новый экземпляр`Aspose.Pdf.Document` объект. Мы можем сделать это, используя следующий код:

```csharp
Aspose.Pdf.Document doc = new Aspose.Pdf.Document();
```

## Шаг 3. Добавление новой страницы в документ PDF

После того, как мы создали PDF-документ, мы можем добавить к нему новую страницу. Мы можем сделать это, используя следующий код:

```csharp
doc.Pages.Add();
```

## Шаг 4. Добавление текста в PDF-документ

После добавления страницы в PDF-документ мы можем добавить к ней текст, используя`Paragraphs` коллекция. Мы можем сделать это, используя следующий код:

```csharp
doc.Pages[1].Paragraphs.Add(new TextFragment("Hello World..."));
```

## Шаг 5. Установка даты истечения срока действия PDF с помощью JavaScript

Чтобы установить дату истечения срока действия PDF, нам нужно создать объект JavaScript. Мы можем сделать это, используя следующий код:

```csharp
JavascriptAction javaScript = new JavascriptAction(
"var year=2017;"
+ "var month=5;"
+ "today = new Date(); today = new Date(today.getFullYear(), today.getMonth());"
+ "expiry = new Date(year, month);"
+ "if (today.getTime() > expiry.getTime())"
+ "app.alert('The file is expired. You need a new one.');");

// Установить JavaScript как действие открытия PDF-файла
doc.OpenAction = javaScript;
```

В этом коде мы устанавливаем дату истечения срока действия на май 2017 года.

## Шаг 6. Сохраните PDF-файл

 После того, как вы установили дату истечения срока действия, вам необходимо сохранить PDF-файл. Для этого вы можете использовать`Save` метод`Document` объект и укажите путь к месту, где вы хотите сохранить обновленный PDF-файл.

```csharp
dataDir = dataDir + "SetExpiryDate_out.pdf";
// Сохранить PDF-документ
doc.Save(dataDir);
```

### Пример исходного кода для установки даты истечения срока действия с использованием Aspose.PDF для .NET

Вот полный пример исходного кода для установки даты истечения срока действия с помощью Aspose.PDF для .NET:

```csharp
// Путь к каталогу документов.
string dataDir = "YOUR DOCUMENT DIRECTORY";

// Создать экземпляр объекта документа
Aspose.Pdf.Document doc = new Aspose.Pdf.Document();
// Добавить страницу в коллекцию страниц PDF-файла
doc.Pages.Add();
// Добавить фрагмент текста в коллекцию абзацев объекта страницы
doc.Pages[1].Paragraphs.Add(new TextFragment("Hello World..."));
// Создайте объект JavaScript, чтобы установить дату истечения срока действия PDF-файла.
JavascriptAction javaScript = new JavascriptAction(
"var year=2017;"
+ "var month=5;"
+ "today = new Date(); today = new Date(today.getFullYear(), today.getMonth());"
+ "expiry = new Date(year, month);"
+ "if (today.getTime() > expiry.getTime())"
+ "app.alert('The file is expired. You need a new one.');");
// Установить JavaScript как действие открытия PDF-файла
doc.OpenAction = javaScript;

dataDir = dataDir + "SetExpiryDate_out.pdf";
// Сохранить PDF-документ
doc.Save(dataDir);
```

## Заключение

Установка даты истечения срока действия PDF-документа с помощью Aspose.PDF для .NET — это полезная функция, позволяющая гарантировать, что документ действителен только в течение определенного периода. Следуя пошаговому руководству и используя предоставленный исходный код C#, разработчики могут легко установить дату истечения срока действия и создавать PDF-файлы с ограниченным сроком действия. Эта функция может быть особенно полезна для документов, к которым необходимо получить доступ или которые необходимо распространять в течение ограниченного периода времени.

### Часто задаваемые вопросы по установленной дате истечения срока действия в PDF-файле

#### Вопрос: Могу ли я установить другую дату истечения срока действия для PDF-документа?

 О: Да, вы можете установить другую дату истечения срока действия для документа PDF, изменив код JavaScript на шаге 5. В приведенном примере дата истечения срока действия установлена на май 2017 года. Чтобы установить другую дату истечения срока действия, вам необходимо изменить`year` и`month` переменные в коде JavaScript на нужные год и месяц.

#### Вопрос: Что произойдет, если срок действия PDF-документа истечет?

О: Когда срок действия PDF-документа истечет, как указано в коде JavaScript, программа просмотра отобразит предупреждающее сообщение, указывающее, что срок действия файла истек и пользователю нужен новый. Это предупреждающее сообщение будет отображаться при открытии PDF-файла.

#### Вопрос: Могу ли я использовать конкретное время для даты истечения срока действия, а не только дату?

 О: Да, вы можете установить конкретное время истечения срока действия в коде JavaScript. Изменив`expiry` переменную в коде JavaScript, чтобы включить желаемое время, вы можете установить конкретное время для даты истечения срока действия.