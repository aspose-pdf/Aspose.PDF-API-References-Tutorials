---
title: เพิ่มรูปภาพในไฟล์ PDF
linktitle: เพิ่มรูปภาพในไฟล์ PDF
second_title: เอกสารอ้างอิง Aspose.PDF สำหรับ API ของ .NET
description: เรียนรู้วิธีการเพิ่มรูปภาพลงในไฟล์ PDF ด้วยโปรแกรมโดยใช้ Aspose.PDF สำหรับ .NET มีคำแนะนำทีละขั้นตอน ตัวอย่างโค้ด และคำถามที่พบบ่อยเพื่อให้ใช้งานได้อย่างราบรื่น
type: docs
weight: 10
url: /th/net/programming-with-images/add-image/
---
## การแนะนำ

เคยสงสัยไหมว่าจะแทรกภาพลงในไฟล์ PDF ด้วยโปรแกรมได้อย่างไร ไม่ว่าคุณจะกำลังพัฒนาระบบสร้างเอกสารหรือเพิ่มองค์ประกอบการสร้างแบรนด์ลงในไฟล์ PDF ของคุณ Aspose.PDF สำหรับ .NET จะทำให้ทุกอย่างง่ายอย่างเหลือเชื่อ มาเรียนรู้วิธีเพิ่มภาพลงใน PDF โดยใช้ Aspose.PDF สำหรับ .NET ทีละขั้นตอนกันเลย

## ข้อกำหนดเบื้องต้น

ก่อนที่จะเริ่มเขียนโค้ด มาดูข้อกำหนดพื้นฐานที่จำเป็นในการเริ่มต้นกันก่อน:

- Aspose.PDF สำหรับไลบรารี .NET: ดาวน์โหลดและติดตั้งเวอร์ชันล่าสุดจาก[ที่นี่](https://releases.aspose.com/pdf/net/).
- สภาพแวดล้อมการพัฒนา .NET: Visual Studio หรือ IDE อื่น ๆ ตามที่คุณเลือก
- ความรู้พื้นฐานเกี่ยวกับ C#: ความคุ้นเคยกับการเขียนโปรแกรม C# ขั้นพื้นฐานและหลักการเชิงวัตถุ
- ไฟล์ PDF และรูปภาพ: ไฟล์ PDF ตัวอย่างและรูปภาพที่จะแทรก

## การนำเข้าแพ็คเกจที่จำเป็น

หากต้องการเริ่มใช้งาน Aspose.PDF คุณต้องนำเข้าเนมสเปซที่จำเป็น โดยคุณสามารถทำได้ดังนี้:

```csharp
using System.IO;
using Aspose.Pdf;
using System;
```

การนำเข้าเหล่านี้จะช่วยให้คุณโต้ตอบกับเอกสาร PDF จัดการเนื้อหา และจัดการสตรีมไฟล์ได้อย่างมีประสิทธิภาพ

ตอนนี้เราลองแบ่งงานการเพิ่มรูปภาพลงในเอกสาร PDF ออกเป็นขั้นตอนที่ทำตามได้ง่าย ๆ

## ขั้นตอนที่ 1: ตั้งค่าเส้นทางเอกสารและเปิด PDF

ก่อนที่คุณจะเพิ่มรูปภาพ สิ่งแรกที่คุณต้องทำคือค้นหาไฟล์ PDF ของคุณและเปิดมัน นี่คือโค้ดสำหรับการดำเนินการดังกล่าว:

```csharp
// เส้นทางไปยังไดเร็กทอรีเอกสาร
string dataDir = "YOUR DOCUMENT DIRECTORY";

// เปิดเอกสาร
Document pdfDocument = new Document(dataDir + "AddImage.pdf");
```
 การ`Document`คลาสจาก Aspose.PDF ใช้สำหรับเปิดและทำงานกับไฟล์ PDF ที่มีอยู่ คุณจะต้องระบุเส้นทางไดเร็กทอรีที่ไฟล์ PDF ของคุณตั้งอยู่

## ขั้นตอนที่ 2: กำหนดพิกัดภาพ

หากต้องการวางรูปภาพใน PDF อย่างถูกต้อง คุณจะต้องกำหนดพิกัดที่รูปภาพควรปรากฏ ซึ่งทำได้โดยระบุมุมซ้ายล่างและมุมขวาบนของรูปสี่เหลี่ยมผืนผ้า

```csharp
// ตั้งค่าพิกัด
int lowerLeftX = 100;
int lowerLeftY = 100;
int upperRightX = 200;
int upperRightY = 200;
```
พิกัดเหล่านี้กำหนดตำแหน่งที่จะวางรูปภาพบนเพจ พิกัดด้านซ้ายล่าง (100, 100) แสดงจุดเริ่มต้น ในขณะที่พิกัดด้านขวาบน (200, 200) กำหนดขนาดและจุดสิ้นสุดของรูปภาพ

## ขั้นตอนที่ 3: เลือกหน้าที่จะแทรกภาพ

ขั้นต่อไป คุณต้องระบุหน้าใน PDF ที่คุณต้องการเพิ่มรูปภาพ Aspose.PDF ช่วยให้คุณเข้าถึงหน้าใดก็ได้ในเอกสารโดยใช้การจัดทำดัชนีแบบฐานศูนย์

```csharp
// รับหน้าที่จำเป็นต้องเพิ่มรูปภาพ
Page page = pdfDocument.Pages[1];
```
ในตัวอย่างนี้ เราจะเพิ่มรูปภาพลงในหน้าแรกของ PDF (หน้า[1] หมายถึงหน้าแรกเนื่องจากเป็นการสร้างดัชนีแบบหนึ่งเดียว

## ขั้นตอนที่ 4: โหลดภาพลงในสตรีม

ตอนนี้โหลดรูปภาพจากไดเร็กทอรีของคุณลงในสตรีม เพื่อให้สามารถประมวลผลและแทรกเข้าใน PDF ได้

```csharp
// โหลดภาพเข้าสู่สตรีม
FileStream imageStream = new FileStream(dataDir + "aspose-logo.jpg", FileMode.Open);
```
 การ`FileStream` คลาสนี้ใช้เพื่อเปิดไฟล์ภาพ ไฟล์ภาพ (`aspose-logo.jpg`) โหลดจากไดเร็กทอรีที่ระบุและเปิดในโหมดอ่าน (`FileMode.Open`-

## ขั้นตอนที่ 5: เพิ่มรูปภาพลงในหน้า PDF ทรัพยากร

เมื่อโหลดรูปภาพลงในสตรีมแล้ว คุณสามารถเพิ่มรูปภาพนั้นลงในทรัพยากรหน้า PDF ได้

```csharp
// เพิ่มรูปภาพลงในคอลเล็กชันรูปภาพของทรัพยากรหน้า
page.Resources.Images.Add(imageStream);
```
ขั้นตอนนี้จะเพิ่มรูปภาพลงในคอลเล็กชันทรัพยากรของเพจ รูปภาพจะพร้อมให้แสดงผลบนเพจได้

## ขั้นตอนที่ 6: บันทึกสถานะกราฟิกปัจจุบัน

 ก่อนที่จะวางภาพบนหน้าคุณควรบันทึกสถานะกราฟิกปัจจุบันโดยใช้`GSave` ตัวดำเนินการ การดำเนินการนี้จะช่วยให้มั่นใจได้ว่าการเปลี่ยนแปลงใดๆ ที่ใช้กับรูปภาพจะไม่ส่งผลกระทบต่อส่วนที่เหลือของเอกสาร

```csharp
//การใช้ตัวดำเนินการ GSave: ตัวดำเนินการนี้จะบันทึกสถานะกราฟิกปัจจุบัน
page.Contents.Add(new Aspose.Pdf.Operators.GSave());
```
 การ`GSave` ผู้ดำเนินการจะบันทึกการตั้งค่ากราฟิกปัจจุบัน ซึ่งจะช่วยให้คุณคืนค่าได้ในภายหลัง และให้แน่ใจว่าการวางภาพจะไม่รบกวนเนื้อหาอื่น ๆ บนหน้า

## ขั้นตอนที่ 7: กำหนดตำแหน่งการวางภาพด้วยสี่เหลี่ยมผืนผ้าและเมทริกซ์

 ตอนนี้สร้าง`Rectangle` วัตถุที่กำหนดว่ารูปภาพจะถูกวางไว้ที่ใดบนหน้าและ`Matrix` เพื่อควบคุมการวางตำแหน่งและการปรับขนาด

```csharp
// สร้างวัตถุสี่เหลี่ยมผืนผ้าและเมทริกซ์
Aspose.Pdf.Rectangle rectangle = new Aspose.Pdf.Rectangle(lowerLeftX, lowerLeftY, upperRightX, upperRightY);
Matrix matrix = new Matrix(new double[] { rectangle.URX - rectangle.LLX, 0, 0, rectangle.URY - rectangle.LLY, rectangle.LLX, rectangle.LLY });
```
 การ`Rectangle` กำหนดพิกัดของภาพบนหน้า PDF และ`Matrix` ช่วยให้มั่นใจถึงการปรับขนาดและตำแหน่งที่ถูกต้อง

## ขั้นตอนที่ 8: เชื่อมโยงเมทริกซ์เพื่อวางภาพ

 การ`ConcatenateMatrix` ตัวดำเนินการใช้เพื่อใช้การแปลงเมทริกซ์ เพื่อให้แน่ใจว่าวางภาพได้อย่างถูกต้อง

```csharp
// การใช้ตัวดำเนินการ ConcatenateMatrix (เมทริกซ์เชื่อม): กำหนดว่าจะต้องวางรูปภาพอย่างไร
page.Contents.Add(new Aspose.Pdf.Operators.ConcatenateMatrix(matrix));
```
การแปลงนี้จะทำให้แน่ใจว่ารูปภาพจะถูกวางไว้ในตำแหน่งที่ถูกต้องบนหน้าโดยใช้ค่าเมทริกซ์ที่กำหนดไว้

## ขั้นตอนที่ 9: เรนเดอร์ภาพบนหน้า PDF

 สุดท้ายใช้`Do` ตัวดำเนินการเพื่อเรนเดอร์ภาพจริงลงบนหน้า PDF

```csharp
XImage ximage = page.Resources.Images[page.Resources.Images.Count];
// การใช้ตัวดำเนินการ Do: ตัวดำเนินการนี้จะวาดภาพ
page.Contents.Add(new Aspose.Pdf.Operators.Do(ximage.Name));
```
 การ`Do` ตัวดำเนินการวาดภาพในตำแหน่งที่กำหนดโดยการแปลงเมทริกซ์ครั้งก่อน

## ขั้นตอนที่ 10: คืนค่าสถานะกราฟิก

 เมื่อเพิ่มรูปภาพแล้ว ให้คืนสถานะกราฟิกก่อนหน้าโดยใช้`GRestore` ผู้ดำเนินการ

```csharp
// การใช้ตัวดำเนินการ GRestore: ตัวดำเนินการนี้จะคืนสถานะกราฟิก
page.Contents.Add(new Aspose.Pdf.Operators.GRestore());
```
ขั้นตอนนี้จะช่วยให้แน่ใจว่าการเปลี่ยนแปลงใดๆ ที่เกิดขึ้นกับสถานะกราฟิก (เช่น การแปลงหรือการปรับขนาด) จะถูกยกเลิก และทำให้เอกสารส่วนที่เหลือไม่ได้รับผลกระทบ

## ขั้นตอนที่ 11: บันทึกเอกสาร PDF ที่อัปเดต

สุดท้ายให้บันทึกไฟล์ PDF ที่มีรูปภาพที่เพิ่มใหม่ลงในไฟล์

```csharp
dataDir = dataDir + "AddImage_out.pdf";
// บันทึกเอกสารอัพเดต
pdfDocument.Save(dataDir);
```
 การ`Save` วิธีนี้ใช้ในการบันทึกเอกสาร PDF ที่มีการเพิ่มรูปภาพ และบันทึกไฟล์ที่อัปเดตโดยใช้ชื่อ "AddImage_out.pdf"

## บทสรุป

การแทรกภาพลงในไฟล์ PDF โดยใช้ Aspose.PDF สำหรับ .NET เป็นเรื่องง่ายเมื่อคุณแบ่งแยกเป็นขั้นตอน โดยใช้ตัวดำเนินการต่างๆ เช่น`GSave`, `ConcatenateMatrix` , และ`Do`คุณสามารถควบคุมการจัดวางและการแสดงผลรูปภาพในเอกสาร PDF ได้อย่างง่ายดาย เทคนิคนี้จำเป็นสำหรับการปรับแต่งและการสร้างแบรนด์ไฟล์ PDF ด้วยโลโก้ ลายน้ำ หรือรูปภาพอื่นๆ

## คำถามที่พบบ่อย

### ฉันสามารถเพิ่มรูปภาพหลาย ๆ รูปลงในหน้าเดียวได้ไหม  
ใช่ คุณสามารถเพิ่มรูปภาพหลายภาพลงในหน้าเดียวกันได้โดยทำซ้ำขั้นตอนการโหลดและวางรูปภาพแต่ละภาพ

### ฉันจะควบคุมขนาดของภาพที่แทรกได้อย่างไร?  
ขนาดของภาพจะถูกควบคุมโดยพิกัดสี่เหลี่ยมผืนผ้า (`lowerLeftX`, `lowerLeftY`, `upperRightX`, `upperRightY`-

### ฉันสามารถแทรกประเภทไฟล์อื่น เช่น PNG หรือ GIF ได้หรือไม่?  
ใช่ Aspose.PDF รองรับรูปแบบภาพต่างๆ รวมถึง PNG, GIF, BMP และ JPEG

### สามารถเพิ่มรูปภาพแบบไดนามิกได้หรือไม่  
ใช่ คุณสามารถโหลดและแทรกภาพแบบไดนามิกได้ด้วยการระบุเส้นทางไฟล์หรือใช้สตรีม

### Aspose.PDF อนุญาตให้เพิ่มรูปภาพจำนวนมากในหลายหน้าได้หรือไม่  
ใช่ คุณสามารถวนซ้ำผ่านหน้าต่างๆ ในเอกสารและเพิ่มรูปภาพลงในหลายหน้าโดยใช้วิธีการเดียวกันได้