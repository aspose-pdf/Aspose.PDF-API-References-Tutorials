---
title: Добавить Java-скрипт в PDF-файл
linktitle: Добавить PDF-файл Java Script
second_title: Справочник по API Aspose.PDF для .NET
description: Узнайте, как добавить JavaScript в PDF-файл с помощью Aspose.PDF для .NET. Пошаговое руководство с обучающими материалами по коду для сценариев на уровне документа и страницы.
type: docs
weight: 10
url: /ru/net/programming-with-document/addjavascripttopage/
---
## Введение

Вы когда-нибудь задумывались, как улучшить свои PDF-файлы с помощью интерактивных элементов, таких как всплывающие оповещения или функции автоматической печати? Что ж, хорошие новости — вы можете! Используя Aspose.PDF для .NET, вы можете легко добавлять JavaScript в свои PDF-документы. Независимо от того, автоматизируете ли вы задачи или создаете динамический пользовательский опыт, внедрение JavaScript в PDF-файлы придает вашим файлам дополнительный уровень функциональности.

## Предпосылки

Прежде чем перейти к написанию кода, вам необходимо настроить несколько вещей:

-  Aspose.PDF для .NET: Загрузите библиотеку с сайта[Релизы Aspose](https://releases.aspose.com/pdf/net/) или получить[бесплатная пробная версия](https://releases.aspose.com/).
- Среда разработки: любая совместимая с .NET среда разработки, например Visual Studio.
- Базовые знания C#: это руководство предполагает, что вы знакомы с базовым синтаксисом C#.
-  Временная лицензия (необязательно): Вы можете получить[временная лицензия](https://purchase.aspose.com/temporary-license/) если вы хотите избежать ограничений в процессе разработки.

## Импортные пакеты

Прежде чем начать писать код, вам нужно будет импортировать необходимые пространства имен из библиотеки Aspose.PDF. Эти пространства имен позволят вам легко манипулировать PDF-файлами и добавлять действия JavaScript.

```csharp
using System.IO;
using System;
using Aspose.Pdf;
using Aspose.Pdf.Annotations;
using Aspose.Pdf.Text;
```

Теперь, когда вы импортировали нужные пространства имен, вы готовы приступить к написанию кода.

## Шаг 1: Загрузите существующий PDF-файл

Сначала самое главное — вам нужно загрузить PDF-документ, в который вы хотите добавить JavaScript. Этот шаг закладывает основу для всех дальнейших изменений. Представьте, что у вас есть PDF-файл, который вы хотите улучшить с помощью динамической функциональности, например, автоматической печати документа при открытии.

Вот как можно загрузить этот PDF-файл:

```csharp
// Путь к каталогу документов.
string dataDir = "YOUR DOCUMENT DIRECTORY";

// Загрузить существующий PDF-файл
Document doc = new Document(dataDir + "input.pdf");
```

 В этом фрагменте кода мы используем`Document` класс для загрузки существующего PDF-файла из указанного каталога. Обязательно замените`"YOUR DOCUMENT DIRECTORY"` с фактическим путем к вашему PDF-файлу.

## Шаг 2: Добавьте JavaScript на уровне документа

Теперь давайте добавим немного JavaScript, который будет запускаться при открытии документа. В этом примере мы напишем скрипт, который открывает диалоговое окно печати, как только пользователь открывает PDF.

JavaScript на уровне документа идеально подходит для действий, которые вы хотите применить ко всему PDF-файлу. Думайте об этом как о настройке глобального правила для вашего документа.

Вот код:

```csharp
// Добавление JavaScript на уровне документа
// Создайте экземпляр JavascriptAction с нужным оператором JavaScript
JavascriptAction javaScript = new JavascriptAction("this.print({bUI:true,bSilent:false,bShrinkToFit:true});");

// Назначить объект JavascriptAction действию OpenAction документа
doc.OpenAction = javaScript;
```

 На этом этапе мы создаем`JavascriptAction` объект, который определяет функцию JavaScript для открытия диалогового окна печати при открытии документа.`doc.OpenAction` Затем этому действию JavaScript присваивается свойство.

## Шаг 3: Добавьте JavaScript на уровне страницы

Не каждое действие должно влиять на весь документ. Иногда вы хотите, чтобы определенные действия происходили при открытии или закрытии определенных страниц. Здесь мы настроим действия JavaScript для открытия и закрытия определенной страницы (например, страницы 2).

JavaScript на уровне страницы полезен для целевых взаимодействий. Это может быть что угодно: от отображения сообщения при переходе пользователя на страницу до пользовательских действий, таких как автоматическое заполнение полей форм.

Вот как это сделать:

```csharp
// Добавление JavaScript на уровне страницы
doc.Pages[2].Actions.OnOpen = new JavascriptAction("app.alert('Page 2 opened')");
doc.Pages[2].Actions.OnClose = new JavascriptAction("app.alert('Page 2 closed')");
```

В этом фрагменте кода мы добавляем два действия JavaScript:
1. Действие OnOpen: отображает предупреждение «Страница 2 открыта», когда пользователь открывает страницу 2.
2. Действие OnClose: отображает предупреждение «Страница 2 закрыта», когда пользователь покидает страницу 2.

Это добавляет слой интерактивности в ваш PDF. Представьте, что вы проводите пользователя через ряд шагов на разных страницах, с оповещениями, которые всплывают, когда он входит или покидает страницу.

## Шаг 4: Сохраните PDF-документ.

Теперь вы добавили JavaScript и в документ, и на определенные страницы. Последний шаг — сохранить измененный PDF в нужном месте. Эта часть простая, но важная — не забудьте сохранить свою работу!

Вот код:

```csharp
// Укажите путь к выходному файлу
dataDir = dataDir + "JavaScript-Added_out.pdf";

// Сохраните обновленный PDF-документ.
doc.Save(dataDir);

Console.WriteLine("\nJavaScript added successfully to the PDF.\nFile saved at " + dataDir);
```

 В этом фрагменте мы сохраняем обновленный документ с добавленным JavaScript в новый файл с именем`"JavaScript-Added_out.pdf"`. Это гарантирует, что вы не перезапишете исходный файл, и у вас будет резервная копия для работы.

## Заключение

Добавление JavaScript в файлы PDF с помощью Aspose.PDF для .NET — это мощный способ создания интерактивных, динамических PDF-файлов. Независимо от того, автоматизируете ли вы такие задачи, как печать или создание пользовательских оповещений, возможность встраивать JavaScript в ваш PDF-файл делает ваши документы более интересными и функциональными.

## Часто задаваемые вопросы

### Можно ли добавить несколько действий JavaScript на разные страницы PDF-файла?
Да, вы можете назначать различные действия JavaScript отдельным страницам или всему документу.

### Можно ли удалить JavaScript из PDF-файла после его добавления?
Да, вы можете удалить или изменить существующие действия JavaScript, очистив`Actions` свойства документа или страницы.

### Какие функции JavaScript можно использовать в PDF-файле?
Вы можете использовать любой JavaScript, поддерживаемый движком JavaScript Adobe Acrobat, например, для печати, оповещений и манипуляций с формами.

### Работает ли JavaScript во всех программах для просмотра PDF-файлов?
Большинство действий JavaScript будут работать в программах просмотра PDF, которые поддерживают интерактивные PDF, например Adobe Acrobat. Однако некоторые базовые программы просмотра PDF могут не поддерживать JavaScript.

### Могу ли я запускать действия JavaScript на основе ввода данных пользователем в PDF-файле?
Да, вы можете привязать JavaScript к полям формы, чтобы инициировать действия на основе пользовательского ввода.