---
title: กำหนดวันหมดอายุในไฟล์ PDF
linktitle: กำหนดวันหมดอายุในไฟล์ PDF
second_title: Aspose.PDF สำหรับการอ้างอิง .NET API
description: เรียนรู้วิธีตั้งวันหมดอายุในไฟล์ PDF โดยใช้ Aspose.PDF สำหรับ .NET พร้อมคำแนะนำทีละขั้นตอนนี้
type: docs
weight: 300
url: /th/net/programming-with-document/setexpirydate/
---
Aspose.PDF สำหรับ .NET เป็นไลบรารีที่มีประสิทธิภาพซึ่งมีคุณสมบัติต่างๆ สำหรับการทำงานกับไฟล์ PDF คุณสมบัติอย่างหนึ่งคือความสามารถในการกำหนดวันหมดอายุสำหรับเอกสาร PDF ในบทช่วยสอนนี้ เราจะแนะนำคุณตลอดขั้นตอนการตั้งค่าวันหมดอายุสำหรับเอกสาร PDF โดยใช้ Aspose.PDF สำหรับ .NET 

## ขั้นตอนที่ 1: กำหนดเส้นทางไปยังไดเร็กทอรีเอกสาร

ก่อนที่เราจะเริ่ม เราต้องกำหนดเส้นทางไปยังไดเร็กทอรีที่มีเอกสาร PDF ของเราอยู่ เราจะเก็บเส้นทางนี้ไว้ในตัวแปรที่เรียกว่า "dataDir"

```csharp
string dataDir = "YOUR DOCUMENT DIRECTORY";
```

## ขั้นตอนที่ 2: การสร้างเอกสาร PDF ใหม่

 ในการสร้างเอกสาร PDF ใหม่ เราจำเป็นต้องสร้างอินสแตนซ์ใหม่`Aspose.Pdf.Document` วัตถุ. เราสามารถทำได้โดยใช้รหัสต่อไปนี้:

```csharp
Aspose.Pdf.Document doc = new Aspose.Pdf.Document();
```

## ขั้นตอนที่ 3: การเพิ่มหน้าใหม่ลงในเอกสาร PDF

เมื่อเราสร้างเอกสาร PDF แล้ว เราก็สามารถเพิ่มหน้าใหม่ลงไปได้ เราสามารถทำได้โดยใช้รหัสต่อไปนี้:

```csharp
doc.Pages.Add();
```

## ขั้นตอนที่ 4: การเพิ่มข้อความลงในเอกสาร PDF

หลังจากเพิ่มหน้าลงในเอกสาร PDF แล้ว เราสามารถเพิ่มข้อความลงในเอกสารได้โดยใช้`Paragraphs` ของสะสม. เราสามารถทำได้โดยใช้รหัสต่อไปนี้:

```csharp
doc.Pages[1].Paragraphs.Add(new TextFragment("Hello World..."));
```

## ขั้นตอนที่ 5: การตั้งค่าวันหมดอายุของ PDF โดยใช้ JavaScript

หากต้องการกำหนดวันหมดอายุของ PDF เราจำเป็นต้องสร้างอ็อบเจ็กต์ JavaScript เราสามารถทำได้โดยใช้รหัสต่อไปนี้:

```csharp
JavascriptAction javaScript = new JavascriptAction(
"var year=2017;"
+ "var month=5;"
+ "today = new Date(); today = new Date(today.getFullYear(), today.getMonth());"
+ "expiry = new Date(year, month);"
+ "if (today.getTime() > expiry.getTime())"
+ "app.alert('The file is expired. You need a new one.');");

// ตั้งค่า JavaScript เป็นการดำเนินการแบบเปิดของ PDF
doc.OpenAction = javaScript;
```

ในโค้ดนี้ เรากำลังตั้งค่าวันหมดอายุเป็นเดือนพฤษภาคม 2017

## ขั้นตอนที่ 6: บันทึกไฟล์ PDF

 หลังจากที่คุณกำหนดวันหมดอายุแล้ว คุณจะต้องบันทึกไฟล์ PDF เมื่อต้องการทำเช่นนี้ คุณสามารถใช้`Save` วิธีการของ`Document` object และส่งผ่านเส้นทางไปยังตำแหน่งที่คุณต้องการบันทึกไฟล์ PDF ที่อัปเดต

```csharp
dataDir = dataDir + "SetExpiryDate_out.pdf";
// บันทึกเอกสาร PDF
doc.Save(dataDir);
```

### ตัวอย่างซอร์สโค้ดสำหรับกำหนดวันหมดอายุโดยใช้ Aspose.PDF สำหรับ .NET

นี่คือตัวอย่างซอร์สโค้ดที่สมบูรณ์สำหรับการตั้งค่าวันหมดอายุโดยใช้ Aspose.PDF สำหรับ .NET:

```csharp
// เส้นทางไปยังไดเร็กทอรีเอกสาร
string dataDir = "YOUR DOCUMENT DIRECTORY";

// สร้างอินสแตนซ์วัตถุเอกสาร
Aspose.Pdf.Document doc = new Aspose.Pdf.Document();
// เพิ่มหน้าไปยังคอลเลกชันหน้าของไฟล์ PDF
doc.Pages.Add();
// เพิ่มส่วนของข้อความลงในคอลเลกชันย่อหน้าของออบเจ็กต์หน้า
doc.Pages[1].Paragraphs.Add(new TextFragment("Hello World..."));
// สร้างวัตถุ JavaScript เพื่อกำหนดวันหมดอายุของ PDF
JavascriptAction javaScript = new JavascriptAction(
"var year=2017;"
+ "var month=5;"
+ "today = new Date(); today = new Date(today.getFullYear(), today.getMonth());"
+ "expiry = new Date(year, month);"
+ "if (today.getTime() > expiry.getTime())"
+ "app.alert('The file is expired. You need a new one.');");
// ตั้งค่า JavaScript เป็นการดำเนินการแบบเปิดของ PDF
doc.OpenAction = javaScript;

dataDir = dataDir + "SetExpiryDate_out.pdf";
// บันทึกเอกสาร PDF
doc.Save(dataDir);
```

## บทสรุป

การตั้งค่าวันหมดอายุสำหรับเอกสาร PDF โดยใช้ Aspose.PDF สำหรับ .NET เป็นคุณสมบัติที่มีประโยชน์เพื่อให้แน่ใจว่าเอกสารจะใช้งานได้ตามระยะเวลาที่กำหนดเท่านั้น ด้วยการทำตามคำแนะนำทีละขั้นตอนและใช้ซอร์สโค้ด C# ที่ให้มา นักพัฒนาสามารถกำหนดวันหมดอายุและสร้าง PDF ได้อย่างง่ายดายโดยมีระยะเวลาจำกัด คุณลักษณะนี้จะเป็นประโยชน์อย่างยิ่งสำหรับเอกสารที่จำเป็นต้องเข้าถึงหรือแจกจ่ายในระยะเวลาที่จำกัด

### คำถามที่พบบ่อยเกี่ยวกับการกำหนดวันหมดอายุในรูปแบบไฟล์ PDF

#### ถาม: ฉันสามารถกำหนดวันหมดอายุอื่นสำหรับเอกสาร PDF ได้หรือไม่

 ตอบ: ได้ คุณสามารถกำหนดวันหมดอายุอื่นสำหรับเอกสาร PDF ได้โดยแก้ไขโค้ด JavaScript ในขั้นตอนที่ 5 ในตัวอย่างที่ให้ไว้ วันหมดอายุถูกกำหนดเป็นเดือนพฤษภาคม 2017 หากต้องการกำหนดวันหมดอายุอื่น คุณต้องแก้ไข`year` และ`month` ตัวแปรในโค้ด JavaScript ให้เป็นปีและเดือนที่ต้องการ

#### ถาม: จะเกิดอะไรขึ้นเมื่อเอกสาร PDF หมดอายุ

ตอบ: เมื่อเอกสาร PDF หมดอายุ ตามที่ระบุไว้ในโค้ด JavaScript โปรแกรมดูจะแสดงข้อความแจ้งเตือนว่าไฟล์หมดอายุและผู้ใช้ต้องการไฟล์ใหม่ ข้อความแจ้งเตือนนี้จะแสดงเมื่อเปิด PDF

#### ถาม: ฉันสามารถใช้เวลาเฉพาะสำหรับวันหมดอายุแทนวันที่เพียงอย่างเดียวได้หรือไม่

 ตอบ: ได้ คุณสามารถตั้งเวลาเฉพาะสำหรับวันหมดอายุได้ในโค้ด JavaScript โดยการปรับเปลี่ยน`expiry` ตัวแปรในโค้ด JavaScript เพื่อรวมเวลาที่ต้องการ คุณสามารถตั้งเวลาเฉพาะสำหรับวันหมดอายุได้