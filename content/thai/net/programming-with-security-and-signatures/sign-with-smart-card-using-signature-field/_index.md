---
title: ลงนามด้วยสมาร์ทการ์ดโดยใช้ช่องลายเซ็น
linktitle: ลงนามด้วยสมาร์ทการ์ดโดยใช้ช่องลายเซ็น
second_title: เอกสารอ้างอิง Aspose.PDF สำหรับ API ของ .NET
description: เรียนรู้วิธีการลงนาม PDF อย่างปลอดภัยโดยใช้สมาร์ทการ์ดด้วย Aspose.PDF สำหรับ .NET ปฏิบัติตามคำแนะนำทีละขั้นตอนของเราเพื่อการใช้งานที่ง่ายดาย
type: docs
weight: 120
url: /th/net/programming-with-security-and-signatures/sign-with-smart-card-using-signature-field/
---
## การแนะนำ

ในโลกดิจิทัลทุกวันนี้ การรักษาความปลอดภัยเอกสารมีความสำคัญมากกว่าที่เคย ไม่ว่าคุณจะเป็นนักพัฒนา เจ้าของธุรกิจ หรือเพียงแค่ผู้ที่ต้องจัดการกับข้อมูลที่ละเอียดอ่อน การทราบวิธีการลงนามใน PDF ทางอิเล็กทรอนิกส์จะช่วยประหยัดเวลาและทำให้มั่นใจได้ว่าเอกสารของคุณได้รับการรับรอง ในคู่มือนี้ เราจะแนะนำคุณเกี่ยวกับกระบวนการลงนามใน PDF โดยใช้สมาร์ทการ์ดและฟิลด์ลายเซ็นด้วย Aspose.PDF สำหรับ .NET 

## ข้อกำหนดเบื้องต้น

ก่อนที่เราจะเจาะลึกรายละเอียดขั้นตอนการลงนาม เรามาตรวจสอบกันก่อนว่าคุณได้เตรียมทุกอย่างที่จำเป็นเพื่อเริ่มต้นแล้ว นี่คือรายการตรวจสอบข้อกำหนดเบื้องต้น:

1. Aspose.PDF สำหรับ .NET: ตรวจสอบให้แน่ใจว่าคุณได้ติดตั้งไลบรารี Aspose.PDF ในสภาพแวดล้อม .NET ของคุณแล้ว คุณสามารถดาวน์โหลดได้จาก[เว็บไซต์](https://releases.aspose.com/pdf/net/).

2. Visual Studio: คุณจะต้องมี IDE เพื่อเขียนและรันโค้ด .NET Visual Studio Community Edition เป็นตัวเลือกฟรีที่ยอดเยี่ยม

3. สมาร์ทการ์ด: จำเป็นสำหรับการลงนามในไฟล์ PDF ของคุณ ตรวจสอบว่าคุณมีเครื่องอ่านสมาร์ทการ์ดและติดตั้งใบรับรองที่จำเป็นในเครื่องของคุณแล้ว

4. ความรู้พื้นฐานเกี่ยวกับ C#: ความคุ้นเคยกับการเขียนโปรแกรม C# จะช่วยให้คุณเข้าใจชิ้นส่วนโค้ดที่เราจะใช้

5. ตัวอย่างเอกสาร PDF: เตรียมเอกสาร PDF ตัวอย่างไว้สำหรับการทดสอบ คุณสามารถสร้าง PDF เปล่าหรือใช้เอกสารที่มีอยู่แล้วก็ได้

## แพ็คเกจนำเข้า

ก่อนที่เราจะเริ่มเขียนโค้ด เรามาอิมพอร์ตแพ็คเกจที่จำเป็นกันก่อน คุณจะต้องรวมเนมสเปซต่อไปนี้ไว้ในไฟล์ C# ของคุณ:

```csharp
using Aspose.Pdf.Facades;
using Aspose.Pdf.Forms;
using System;
using System.Collections.Generic;
using System.IO;
using System.Linq;
using System.Text;
```

เนมสเปซเหล่านี้จะทำให้คุณสามารถเข้าถึงคลาสและวิธีการที่จำเป็นสำหรับการทำงานกับ PDF และการจัดการลายเซ็นดิจิทัล

## คู่มือทีละขั้นตอนในการลงนาม PDF ด้วยสมาร์ทการ์ด

ตอนนี้เราได้จัดเตรียมข้อกำหนดเบื้องต้นเรียบร้อยแล้ว เรามาแบ่งกระบวนการลงนามออกเป็นขั้นตอนที่จัดการได้ เราจะอธิบายแต่ละขั้นตอนอย่างละเอียด เพื่อให้คุณเข้าใจถึงสิ่งที่เกิดขึ้นเบื้องหลัง

### ขั้นตอนที่ 1: ตั้งค่าไดเรกทอรีเอกสารของคุณ

สิ่งที่ต้องทำ: กำหนดเส้นทางไปยังไดเร็กทอรีเอกสารของคุณ

```csharp
string dataDir = "YOUR DOCUMENTS DIRECTORY";
```

 คำอธิบาย : แทนที่`"YOUR DOCUMENTS DIRECTORY"` ด้วยเส้นทางจริงที่ไฟล์ PDF ของคุณตั้งอยู่ นี่คือที่ที่เราจะอ่าน PDF เปล่าและบันทึกเอกสารที่ลงนามแล้ว

### ขั้นตอนที่ 2: คัดลอก PDF เปล่า

สิ่งที่ต้องทำ: สร้างสำเนา PDF เปล่าของคุณเพื่อใช้งาน

```csharp
File.Copy(dataDir + "blank.pdf", dataDir + "externalSignature1.pdf", true);
```

 คำอธิบาย: บรรทัดนี้คัดลอก`blank.pdf`ไฟล์ไปยังไฟล์ใหม่ที่ชื่อ`externalSignature1.pdf` . การ`true` พารามิเตอร์อนุญาตให้เขียนทับถ้าไฟล์มีอยู่แล้ว

### ขั้นตอนที่ 3: เปิดเอกสาร PDF

สิ่งที่ต้องทำ: เปิด PDF ที่คัดลอกมาเพื่ออ่านและเขียน

```csharp
using (FileStream fs = new FileStream(dataDir + "externalSignature1.pdf", FileMode.Open, FileAccess.ReadWrite))
{
    using (Document doc = new Document(fs))
    {
        // ขั้นตอนต่อไปจะดำเนินไปที่นี่
    }
}
```

 คำอธิบาย: เราใช้`FileStream` เพื่อเปิดไฟล์ PDF ของเรา`Document` คลาสจาก Aspose.PDF ช่วยให้เราสามารถจัดการเนื้อหา PDF ได้

### ขั้นตอนที่ 4: สร้างช่องลายเซ็น

สิ่งที่ต้องทำ: กำหนดฟิลด์ลายเซ็นใน PDF ที่จะวางลายเซ็น

```csharp
SignatureField field1 = new SignatureField(doc.Pages[1], new Rectangle(100, 400, 10, 10));
```

 คำอธิบาย: ที่นี่เราจะสร้าง`SignatureField` ในหน้าที่สอง (ดัชนีหน้าเริ่มจาก 1) ของ PDF`Rectangle` กำหนดตำแหน่งและขนาดของช่องลายเซ็น

### ขั้นตอนที่ 5: เข้าถึงที่เก็บใบรับรองสมาร์ทการ์ด

สิ่งที่ต้องทำ: เปิดที่เก็บใบรับรองเพื่อเลือกใบรับรองสมาร์ทการ์ดของคุณ

```csharp
X509Store store = new X509Store(StoreLocation.CurrentUser);
store.Open(OpenFlags.ReadOnly);
```

คำอธิบาย: เราเข้าถึงที่เก็บใบรับรองสำหรับผู้ใช้ปัจจุบัน ซึ่งเป็นที่ที่ใบรับรองสมาร์ทการ์ดของคุณถูกจัดเก็บไว้

### ขั้นตอนที่ 6: เลือกใบรับรอง

สิ่งที่ต้องทำ: แจ้งผู้ใช้ให้เลือกใบรับรองจากร้านค้า

```csharp
X509Certificate2Collection sel = X509Certificate2UI.SelectFromCollection(store.Certificates, null, null, X509SelectionFlag.SingleSelection);
```

คำอธิบาย: บรรทัดนี้จะเปิดกล่องโต้ตอบเพื่อให้คุณเลือกใบรับรอง คุณสามารถเลือกใบรับรองที่เชื่อมโยงกับสมาร์ทการ์ดของคุณได้

### ขั้นตอนที่ 7: สร้างลายเซ็นภายนอก

 สิ่งที่ต้องทำ: สร้างอินสแตนซ์ของ`ExternalSignature` โดยใช้ใบรับรองที่เลือก

```csharp
Aspose.Pdf.Forms.ExternalSignature externalSignature = new Aspose.Pdf.Forms.ExternalSignature(sel[0])
{
    Authority = "Me",
    Reason = "Reason",
    ContactInfo = "Contact"
};
```

 คำอธิบาย: เราเริ่มต้น`ExternalSignature` ด้วยใบรับรองที่เลือกไว้ คุณยังสามารถตั้งค่าสิทธิ์ เหตุผลในการลงนาม และข้อมูลการติดต่อได้อีกด้วย

### ขั้นตอนที่ 8: เพิ่มช่องลายเซ็นลงในเอกสาร

สิ่งที่ต้องทำ: เพิ่มช่องลายเซ็นลงในเอกสาร

```csharp
field1.PartialName = "sig1";
doc.Form.Add(field1, 1);
```

คำอธิบาย: เราตั้งชื่อช่องลายเซ็นและเพิ่มลงในหน้าแรกของเอกสาร เพื่อเตรียมไฟล์ PDF สำหรับการลงนาม

### ขั้นตอนที่ 9: ลงนามในเอกสาร

สิ่งที่ต้องทำ: ใช้ลายเซ็นภายนอกเพื่อลงนามใน PDF

```csharp
field1.Sign(externalSignature);
doc.Save();
```

คำอธิบาย: บรรทัดนี้ลงนามในเอกสารโดยใช้ลายเซ็นภายนอก และบันทึกการเปลี่ยนแปลงลงใน PDF เอกสารของคุณได้รับการลงนามแล้ว!

### ขั้นตอนที่ 10: ตรวจสอบลายเซ็น

สิ่งที่ต้องทำ: ตรวจสอบว่าลายเซ็นถูกต้องหรือไม่

```csharp
using (PdfFileSignature pdfSign = new PdfFileSignature(new Document(dataDir + "externalSignature1.pdf")))
{
    IList<string> sigNames = pdfSign.GetSignNames();
    for (int index = 0; index <= sigNames.Count - 1; index++)
    {
        if (!pdfSign.VerifySigned(sigNames[index]) || !pdfSign.VerifySignature(sigNames[index]))
        {
            throw new ApplicationException("Not verified");
        }
    }
}
```

คำอธิบาย: เราสร้างอินสแตนซ์ของ`PdfFileSignature` เพื่อตรวจสอบลายเซ็นในเอกสาร หากลายเซ็นไม่ถูกต้อง จะมีการโยนข้อยกเว้น

## บทสรุป

ขอแสดงความยินดี! คุณเพิ่งเรียนรู้วิธีการลงนามในเอกสาร PDF โดยใช้สมาร์ทการ์ดและฟิลด์ลายเซ็นด้วย Aspose.PDF สำหรับ .NET กระบวนการนี้ไม่เพียงแต่ช่วยรักษาความปลอดภัยให้กับเอกสารของคุณเท่านั้น แต่ยังช่วยรับรองความถูกต้องอีกด้วย ทำให้เป็นทักษะที่สำคัญในโลกดิจิทัลในปัจจุบัน ไม่ว่าคุณจะลงนามในสัญญา ใบแจ้งหนี้ หรือเอกสารสำคัญอื่นๆ การทราบวิธีการนำลายเซ็นดิจิทัลไปใช้จะช่วยประหยัดเวลาและทำให้คุณอุ่นใจได้

## คำถามที่พบบ่อย

### Aspose.PDF สำหรับ .NET คืออะไร?
Aspose.PDF สำหรับ .NET เป็นไลบรารีอันทรงพลังที่ช่วยให้นักพัฒนาสามารถสร้าง จัดการ และแปลงเอกสาร PDF ในแอปพลิเคชัน .NET ได้

### ฉันต้องมีสมาร์ทการ์ดในการลงนามใน PDF หรือไม่
ใช่ ต้องใช้สมาร์ทการ์ดเพื่อลงนาม PDF อย่างปลอดภัยด้วยใบรับรองดิจิทัล

### ฉันสามารถใช้ Aspose.PDF ได้ฟรีหรือไม่?
 Aspose.PDF เสนอรุ่นทดลองใช้งานฟรีซึ่งคุณสามารถดาวน์โหลดได้[ที่นี่](https://releases.aspose.com/).

### ฉันจะตรวจสอบ PDF ที่ลงนามแล้วได้อย่างไร
 คุณสามารถใช้`PdfFileSignature` คลาสใน Aspose.PDF เพื่อตรวจสอบลายเซ็นในเอกสาร PDF ของคุณ

### ฉันสามารถหาเอกสารเพิ่มเติมเกี่ยวกับ Aspose.PDF ได้จากที่ใด
 คุณสามารถตรวจสอบได้[เอกสาร Aspose.PDF](https://reference.aspose.com/pdf/net/) สำหรับรายละเอียดและตัวอย่างเพิ่มเติม