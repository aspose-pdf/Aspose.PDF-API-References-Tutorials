---
title: Извлечь выделенный текст в файл PDF
linktitle: Извлечь выделенный текст в файл PDF
second_title: Aspose.PDF для справочника API .NET
description: Узнайте, как извлечь выделенный текст из PDF-файла с помощью Aspose.PDF для .NET, из этого пошагового руководства.
type: docs
weight: 60
url: /ru/net/annotations/extracthighlightedtext/
---
Чтобы извлечь выделенный текст из PDF-файла, вы можете использовать Aspose.PDF для .NET API. Этот API предоставляет простой способ получить весь выделенный текст в документе.

## Шаг 1. Загрузите PDF-документ

 Первым шагом в извлечении выделенного текста в PDF-файле является загрузка документа с помощью Aspose.PDF for .NET API. Вы можете сделать это, создав новый экземпляр`Document` class и передавая путь к PDF-документу в качестве параметра. 

```csharp
// Путь к каталогу документов.
string dataDir ="YOUR DOCUMENT DIRECTORY";
Document doc = new Document(dataDir + "ExtractHighlightedText.pdf");
```

## Шаг 2. Переберите все аннотации

 Следующим шагом будет просмотр всех аннотаций в документе PDF. Вы можете сделать это с помощью`foreach` петля, вот так:

```csharp
foreach (Annotation annotation in doc.Pages[1].Annotations)
{
	// Код идет здесь
}
```

## Шаг 3. Отфильтруйте аннотации текстовой разметки

 Внутри`foreach` цикла, вам нужно будет отфильтровать все аннотации, которые не являются аннотациями текстовой разметки. Вы можете сделать это, проверив, является ли аннотация экземпляром`TextMarkupAnnotation` сорт.

```csharp
if (annotation is TextMarkupAnnotation)
{
	// Код идет здесь
}
```

## Шаг 4: Извлеките выделенные фрагменты текста

 После того, как вы отфильтровали все аннотации текстовой разметки, вы можете получить выделенные фрагменты текста для каждой аннотации. Вы можете сделать это, позвонив в`GetMarkedTextFragments()` метод на`TextMarkupAnnotation` объект.

```csharp
TextMarkupAnnotation highlightedAnnotation = annotation as TextMarkupAnnotation;
TextFragmentCollection collection = highlightedAnnotation.GetMarkedTextFragments();
```

## Шаг 5: Отобразите выделенный текст

 Наконец, вы можете отобразить выделенный текст пользователю. Вы можете сделать это, перебирая каждый`TextFragment` объект в`TextFragmentCollection` и вызов`Text` свойство.

```csharp
foreach (TextFragment tf in collection)
{
	Console.WriteLine(tf.Text);
}
```

### Пример исходного кода для извлечения выделенного текста с использованием Aspose.PDF для .NET

```csharp
// Путь к каталогу документов.
string dataDir ="YOUR DOCUMENT DIRECTORY";
Document doc = new Document(dataDir + "ExtractHighlightedText.pdf");

foreach (Annotation annotation in doc.Pages[1].Annotations)
{
	if (annotation is TextMarkupAnnotation)
	{
		TextMarkupAnnotation highlightedAnnotation = annotation as TextMarkupAnnotation;
		TextFragmentCollection collection = highlightedAnnotation.GetMarkedTextFragments();
		foreach (TextFragment tf in collection)
		{
			Console.WriteLine(tf.Text);
		}
	}
}
```

## Заключение

В этом руководстве мы рассмотрели, как извлечь выделенный текст из документа PDF с помощью Aspose.PDF для .NET. Следуя пошаговому руководству и используя предоставленный исходный код C#, разработчики могут легко извлекать и управлять выделенным текстом в своих PDF-документах.

### Часто задаваемые вопросы по извлечению выделенного текста в файле PDF

#### Вопрос. Что такое текстовые аннотации в документе PDF?

О: Текстовые аннотации — это аннотации, которые выделяют или отмечают определенный текст в документе PDF. Примеры аннотаций текстовой разметки включают выделение, подчеркивание и зачеркивание.

#### В: Могу ли я извлечь текст из аннотаций других типов, используя Aspose.PDF для .NET?

О: Да, Aspose.PDF для .NET предоставляет различные методы для извлечения текста из различных типов аннотаций, включая аннотации с разметкой текста, аннотации произвольного текста и многое другое.

#### В: Поддерживает ли Aspose.PDF для .NET извлечение текста из PDF-файлов, защищенных паролем?

О: Да, Aspose.PDF для .NET поддерживает извлечение текста из PDF-файлов, защищенных паролем. Вам необходимо указать правильный пароль при загрузке документа PDF с помощью`Document` сорт.

#### В: Могу ли я фильтровать выделенный текст по другим критериям, таким как цвет или автор?

О: Да, вы можете фильтровать выделенный текст по другим критериям, таким как цвет, автор или дата создания. Aspose.PDF для .NET предоставляет методы для доступа и фильтрации аннотаций на основе их свойств.

#### В: Можно ли сохранить извлеченный выделенный текст в отдельный файл?

О: Да, вы можете сохранить извлеченный выделенный текст в отдельный файл или сохранить его в структуре данных для дальнейшей обработки или анализа.
