---
title: تخزين الصورة في مجموعة XImage
linktitle: تخزين الصورة في مجموعة XImage
second_title: مرجع واجهة برمجة التطبيقات Aspose.PDF لـ .NET
description: تعرف على كيفية تخزين الصور في مجموعة XImage باستخدام Aspose.PDF لـ .NET في هذا الدليل الكامل خطوة بخطوة.
type: docs
weight: 290
url: /ar/net/programming-with-images/store-image-in-ximage-collection/
---
## مقدمة

في العصر الرقمي الحالي، يعد التعامل مع المستندات ومعالجتها برمجيًا أمرًا ضروريًا للعديد من التطبيقات. يتيح برنامج Aspose.PDF for .NET للمطورين العمل مع ملفات PDF دون عناء، مما يعزز سير العمل ويتيح إنشاء محتوى ديناميكي. في هذا الدليل، سنتعمق في عملية تخزين صورة في مجموعة XImage، وهي ميزة حيوية تتيح لك تضمين الصور المرئية مباشرة في ملفات PDF الخاصة بك. هل أنت مستعد لبدء هذه الرحلة لإنشاء محتوى مذهل؟

## المتطلبات الأساسية

قبل أن نتعمق في الكود والعمليات، ستحتاج إلى التأكد من أن لديك بعض الأشياء في مكانها:

- بيئة .NET: يجب أن يكون لديك .NET Framework مثبتًا على جهازك. اختر الإصدار المناسب بناءً على متطلبات مشروعك.
- Aspose.PDF لـ .NET: تأكد من أن لديك مكتبة Aspose.PDF. يمكنك تنزيلها من[هنا](https://releases.aspose.com/pdf/net/) أو ابدأ بفترة تجريبية مجانية[هنا](https://releases.aspose.com/).
- ملف الصورة: تحتاج أيضًا إلى ملف صورة (مثل JPG أو PNG) تريد تخزينه في ملف PDF. في هذا المثال، سنستخدم ملفًا يسمى "aspose-logo.jpg".
- الفهم الأساسي لـ C#: إن الإلمام ببرمجة C# سيساعدك على المتابعة بسلاسة.

## استيراد الحزم

للبدء في استخدام Aspose.PDF لـ .NET، تحتاج إلى استيراد المساحات المطلوبة. تضع هذه الخطوة الأساس للاستفادة من جميع الوظائف التي تقدمها المكتبة.

```csharp
using System;
using System.IO;
using Aspose.Pdf.Operators;
```

من خلال استيراد هذه المساحات الاسمية، يمكنك تمكين ميزات مختلفة في Aspose.PDF، بما في ذلك إنشاء المستندات ومعالجة الصور والمزيد.

دعنا نقسم هذا إلى خطوات قابلة للإدارة، مما يجعل من الأسهل عليك متابعتها.

## الخطوة 1: إعداد دليل المستندات الخاص بك

ما هو أول شيء عليك القيام به؟ حدد المكان الذي ستحفظ فيه مستنداتك. ستحتاج إلى إعداد متغير يحمل المسار إلى دليل المستندات. هذا هو المكان الذي سيتم فيه حفظ ملف PDF الخاص بك.

```csharp
string dataDir = "YOUR DOCUMENT DIRECTORY"; // استبدله بدليل المستند الفعلي الخاص بك.
```

## الخطوة 2: تهيئة المستند

الآن، حان الوقت لإنشاء مستند PDF جديد. هذه الخطوة هي التي تجعل ملف PDF الخاص بك ينبض بالحياة. 

```csharp
Aspose.Pdf.Document document = new Document();
```

هنا، نقوم بإنشاء كائن مستند جديد والذي سيعمل كقماشتنا.

## الخطوة 3: إضافة صفحة جديدة

تحتاج كل تحفة فنية إلى لوحة، أليس كذلك؟ في حالتنا، نحتاج إلى صفحة للعمل عليها داخل المستند.

```csharp
document.Pages.Add();
Page page = document.Pages[1]; // احصل على الصفحة الأولى.
```

نحن نضيف صفحة جديدة إلى مستندنا. الآن، سنعمل على هذه الصفحة.

## الخطوة 4: تحميل ملف الصورة

بعد ذلك، ستحتاج إلى تحميل الصورة إلى برنامجك. هذه الخطوة تشبه إلى حد كبير فتح كتاب للقراءة؛ حيث يتعين عليك الوصول إلى المحتوى قبل أن تتمكن من استخدامه.

```csharp
using (FileStream imageStream = new FileStream(dataDir + "aspose-logo.jpg", FileMode.Open))
{
```

يفتح هذا السطر ملف الصورة كدفق، مما يسمح لنا بالتعامل معه وتضمينه في ملف PDF.

## الخطوة 5: إضافة الصورة إلى موارد الصفحة

الآن بعد أن أصبحت الصورة جاهزة للنشر، فقد حان الوقت لإضافتها إلى موارد الصفحة، مما يعني في الأساس إخبار ملف PDF، "مرحبًا، لدي صورة رائعة أريدك أن تتذكرها!"

```csharp
page.Resources.Images.Add(imageStream, ImageFilterType.Flate);
XImage ximage = page.Resources.Images[page.Resources.Images.Count];
```

 يقوم هذا الكود بالعمل الشاق المتمثل في إضافة الصورة إلى ملف PDF وتعيينها إلى`XImage` متغير يمكننا الرجوع إليه لاحقًا.

## الخطوة 6: الاستعداد لرسم الصورة

وهنا يأتي الجزء الممتع، وهو وضع الصورة على الصفحة. ستحتاج إلى ضبط الإحداثيات بحيث يتم وضع الصورة بالضبط حيث تريدها.

```csharp
page.Contents.Add(new GSave());
```

يحفظ هذا الخط حالة الرسومات لاستعادتها لاحقًا. إنه مثل التقاط صورة لكيفية إعداد الأشياء قبل تغيير أي شيء.

## الخطوة 7: تحديد موضع الصورة وحجمها

الآن، قم بتحديد حجم الصورة والمكان الذي ترغب في وضعها فيه:

```csharp
int lowerLeftX = 0;
int lowerLeftY = 0;
int upperRightX = 600;
int upperRightY = 600;
Aspose.Pdf.Rectangle rectangle = new Aspose.Pdf.Rectangle(lowerLeftX, lowerLeftY, upperRightX, upperRightY);
```

يحدد هذا الجزء من التعليمات البرمجية أبعاد المستطيل الذي ستلائم صورتك، مما يمنحها منزلاً على صفحتك.

## الخطوة 8: إنشاء مصفوفة التحويل 

للتحكم في كيفية وضع الصورة، سنقوم بتعريف مصفوفة تحويل. وهذا يحكم كيفية ظهور الصورة عند إحداثيات الوجهة.

```csharp
Matrix matrix = new Matrix(new double[] { rectangle.URX - rectangle.LLX, 0, 0, rectangle.URY - rectangle.LLY, rectangle.LLX, rectangle.LLY });
```

فكر في هذا الأمر كأنك ترسم خريطة قبل أن تبدأ رحلتك. فهذا يساعد في تحديد كيفية ظهور الصورة على الصفحة.

## الخطوة 9: وضع الصورة على الصفحة

الآن، حان الوقت لإخبار ملف PDF بالمكان الذي يجب وضع تلك الصورة فيه.

```csharp
page.Contents.Add(new ConcatenateMatrix(matrix));
page.Contents.Add(new Do(ximage.Name));
page.Contents.Add(new GRestore());
```

هنا، نضيف أوامر إلى مجرى محتوى ملف PDF والتي ستقوم فعليًا برسم الصورة وفقًا للمصفوفة التي أنشأناها للتو.

## الخطوة 10: احفظ المستند

أخيرًا، يمكننا حفظ تحفتنا الفنية! هذه هي اللحظة التي تتجمع فيها كل جهودك الشاقة في صورة ملموسة.

```csharp
document.Save(dataDir + "FlateDecodeCompression.pdf");
```

لقد طلبت من Aspose.PDF حفظ المستند باسم الملف المقدم. عند تشغيل هذا الكود، ستجد ملف PDF الذي تم إنشاؤه حديثًا في الدليل المحدد، مكتملًا بالصورة المضمنة.

## خاتمة

والآن، لقد تعلمت كيفية استخدام Aspose.PDF لـ .NET لتخزين صورة في مجموعة XImage نقطة بنقطة. أليس من الممتع أن ترى الكود الخاص بك يتخذ شكلًا ويولد شيئًا مفيدًا؟ سواء كنت تقوم ببناء تطبيقات أو تبحث فقط عن أتمتة التقارير، فإن هذا الدليل بمثابة قطعة أساسية رائعة. تذكر أن قوة Aspose.PDF يمكن أن تساعدك في العديد من المهام بخلاف هذه المهمة فقط، لذا استمر في الاستكشاف!

## الأسئلة الشائعة

### ما هي تنسيقات الملفات المدعومة للصور في Aspose.PDF؟
يدعم Aspose.PDF تنسيقات الصور المختلفة، بما في ذلك JPG، PNG، BMP، وGIF.

### هل يمكنني تغيير حجم الصورة عند إضافتها إلى ملف PDF؟
نعم، عن طريق ضبط الإحداثيات المحددة في المستطيل، يمكنك تغيير حجم الصورة المعروضة في ملف PDF.

### هل أحتاج إلى ترخيص لاستخدام Aspose.PDF؟
 تقدم Aspose نسخة تجريبية مجانية وخيارات شراء متنوعة. يمكنك العثور عليها[هنا](https://purchase.aspose.com/buy).

### كيف يمكنني الحصول على الدعم إذا واجهت مشاكل؟
 يمكنك طلب المساعدة من مجتمع Aspose[هنا](https://forum.aspose.com/c/pdf/10).

### هل توجد طريقة لتطبيق الضغط على الصور المضافة إلى ملف PDF؟
نعم، عند إضافة الصور إلى ملف PDF، يمكنك تحديد نوع مرشح الصورة لاستخدام طرق الضغط مثل Flate.