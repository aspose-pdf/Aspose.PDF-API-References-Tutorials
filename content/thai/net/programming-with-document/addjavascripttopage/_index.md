---
title: เพิ่ม Java Script ลงในไฟล์ PDF
linktitle: เพิ่มไฟล์ PDF สคริปต์ Java
second_title: เอกสารอ้างอิง Aspose.PDF สำหรับ API ของ .NET
description: เรียนรู้วิธีการเพิ่ม JavaScript ลงในไฟล์ PDF โดยใช้ Aspose.PDF สำหรับ .NET คำแนะนำทีละขั้นตอนพร้อมบทช่วยสอนเกี่ยวกับโค้ดสำหรับการเขียนสคริปต์ในระดับเอกสารและหน้า
type: docs
weight: 10
url: /th/net/programming-with-document/addjavascripttopage/
---
## การแนะนำ

คุณเคยสงสัยไหมว่าจะปรับปรุง PDF ของคุณด้วยองค์ประกอบแบบโต้ตอบ เช่น การแจ้งเตือนแบบป๊อปอัปหรือฟังก์ชันการพิมพ์อัตโนมัติได้อย่างไร ข่าวดีก็คือ คุณสามารถทำได้! เมื่อใช้ Aspose.PDF สำหรับ .NET คุณสามารถเพิ่ม JavaScript ลงในเอกสาร PDF ได้อย่างราบรื่น ไม่ว่าคุณจะกำลังสร้างงานอัตโนมัติหรือสร้างประสบการณ์ผู้ใช้แบบไดนามิก การฝัง JavaScript ใน PDF จะทำให้ไฟล์ของคุณมีฟังก์ชันการทำงานในระดับพิเศษ

## ข้อกำหนดเบื้องต้น

ก่อนที่เราจะเข้าสู่ขั้นตอนการเขียนโค้ด มีบางสิ่งที่คุณจำเป็นต้องตั้งค่า:

-  Aspose.PDF สำหรับ .NET: ดาวน์โหลดไลบรารีจาก[การเปิดตัว Aspose](https://releases.aspose.com/pdf/net/) หรือรับ[ทดลองใช้งานฟรี](https://releases.aspose.com/).
- สภาพแวดล้อมการพัฒนา: IDE ที่เข้ากันได้กับ .NET เช่น Visual Studio
- ความรู้พื้นฐานเกี่ยวกับ C#: คู่มือนี้ถือว่าคุณมีความคุ้นเคยกับรูปแบบพื้นฐานของ C#
-  ใบอนุญาตชั่วคราว (ทางเลือก): คุณสามารถรับได้[ใบอนุญาตชั่วคราว](https://purchase.aspose.com/temporary-license/) หากคุณต้องการหลีกเลี่ยงข้อจำกัดในระหว่างการพัฒนาของคุณ

## แพ็คเกจนำเข้า

ก่อนที่คุณจะเริ่มเขียนโค้ด คุณจะต้องนำเข้าเนมสเปซที่จำเป็นจากไลบรารี Aspose.PDF เนมสเปซเหล่านี้จะช่วยให้คุณจัดการ PDF และเพิ่มการดำเนินการ JavaScript ได้อย่างง่ายดาย

```csharp
using System.IO;
using System;
using Aspose.Pdf;
using Aspose.Pdf.Annotations;
using Aspose.Pdf.Text;
```

ตอนนี้คุณได้นำเข้าเนมสเปซที่ถูกต้องแล้ว คุณก็พร้อมที่จะเริ่มเขียนโค้ดได้เลย

## ขั้นตอนที่ 1: โหลด PDF ที่มีอยู่

สิ่งแรกที่ต้องทำคือโหลดเอกสาร PDF ที่คุณต้องการเพิ่ม JavaScript ขั้นตอนนี้จะเป็นการเตรียมการสำหรับการปรับเปลี่ยนเพิ่มเติมทั้งหมด ลองนึกภาพว่าคุณมี PDF ที่ต้องการปรับปรุงด้วยฟังก์ชันแบบไดนามิก เช่น พิมพ์เอกสารโดยอัตโนมัติเมื่อเปิดขึ้นมา

คุณสามารถโหลดไฟล์ PDF ได้ดังนี้:

```csharp
// เส้นทางไปยังไดเร็กทอรีเอกสาร
string dataDir = "YOUR DOCUMENT DIRECTORY";

// โหลดไฟล์ PDF ที่มีอยู่
Document doc = new Document(dataDir + "input.pdf");
```

 ในโค้ดตัวอย่างนี้ เราใช้`Document` คลาสที่จะโหลดไฟล์ PDF ที่มีอยู่จากไดเร็กทอรีที่ระบุ ตรวจสอบให้แน่ใจว่าได้แทนที่`"YOUR DOCUMENT DIRECTORY"` พร้อมเส้นทางจริงไปยังไฟล์ PDF ของคุณ

## ขั้นตอนที่ 2: เพิ่ม JavaScript ในระดับเอกสาร

ตอนนี้เรามาเพิ่ม JavaScript ที่จะทริกเกอร์เมื่อเปิดเอกสารกัน ในตัวอย่างนี้ เราจะเขียนสคริปต์ที่เปิดกล่องโต้ตอบการพิมพ์ทันทีที่ผู้ใช้เปิด PDF

JavaScript ระดับเอกสารเหมาะอย่างยิ่งสำหรับการดำเนินการที่คุณต้องการใช้กับ PDF ทั้งหมด ลองนึกถึงการตั้งค่ากฎทั่วไปสำหรับเอกสารของคุณ

นี่คือโค้ด:

```csharp
// การเพิ่ม JavaScript ในระดับเอกสาร
// สร้างอินสแตนซ์ JavascriptAction ด้วยคำสั่ง JavaScript ที่ต้องการ
JavascriptAction javaScript = new JavascriptAction("this.print({bUI:true,bSilent:false,bShrinkToFit:true});");

// กำหนดวัตถุ JavascriptAction ให้กับ OpenAction ของเอกสาร
doc.OpenAction = javaScript;
```

 ในขั้นตอนนี้เราจะสร้าง`JavascriptAction` วัตถุที่กำหนดฟังก์ชัน JavaScript เพื่อเปิดกล่องโต้ตอบการพิมพ์เมื่อเปิดเอกสาร`doc.OpenAction` คุณสมบัติจะได้รับการกำหนดการดำเนินการ JavaScript นี้

## ขั้นตอนที่ 3: เพิ่ม JavaScript ในระดับหน้า

ไม่จำเป็นที่ทุกการกระทำจะต้องส่งผลต่อเอกสารทั้งหมด บางครั้งคุณต้องการให้การกระทำบางอย่างเกิดขึ้นเมื่อเปิดหรือปิดหน้าบางหน้า ที่นี่ เราจะตั้งค่าการกระทำ JavaScript เมื่อเปิดและปิดหน้าใดหน้าหนึ่ง (สมมติว่าหน้า 2)

JavaScript ระดับหน้ามีประโยชน์สำหรับการโต้ตอบแบบกำหนดเป้าหมาย อาจเป็นอะไรก็ได้ตั้งแต่การแสดงข้อความเมื่อผู้ใช้ไปที่หน้า ไปจนถึงการดำเนินการแบบกำหนดเอง เช่น การกรอกข้อมูลในฟอร์มโดยอัตโนมัติ

วิธีทำมีดังต่อไปนี้:

```csharp
// การเพิ่ม JavaScript ในระดับหน้า
doc.Pages[2].Actions.OnOpen = new JavascriptAction("app.alert('Page 2 opened')");
doc.Pages[2].Actions.OnClose = new JavascriptAction("app.alert('Page 2 closed')");
```

ในโค้ดตัวอย่างนี้ เราเพิ่มการดำเนินการ JavaScript สองรายการ:
1. การดำเนินการ OnOpen: แสดงการแจ้งเตือนว่า “เปิดหน้า 2 แล้ว” เมื่อผู้ใช้เปิดหน้า 2
2. การดำเนินการ OnClose: แสดงการแจ้งเตือนว่า “หน้า 2 ปิดแล้ว” เมื่อผู้ใช้ย้ายออกจากหน้า 2

การดำเนินการนี้จะเพิ่มเลเยอร์ของการโต้ตอบให้กับ PDF ของคุณ ลองจินตนาการว่าคุณกำลังแนะนำผู้ใช้ผ่านขั้นตอนต่างๆ บนหน้าต่างๆ พร้อมการแจ้งเตือนที่ปรากฏขึ้นเมื่อพวกเขาเข้าหรือออกจากหน้านั้นๆ

## ขั้นตอนที่ 4: บันทึกเอกสาร PDF

ตอนนี้คุณได้เพิ่ม JavaScript ลงในเอกสารและหน้าเฉพาะแล้ว ขั้นตอนสุดท้ายคือการบันทึก PDF ที่แก้ไขแล้วไปยังตำแหน่งที่คุณต้องการ ขั้นตอนนี้ง่ายแต่สำคัญมาก อย่าลืมบันทึกงานของคุณ!

นี่คือโค้ด:

```csharp
// ระบุเส้นทางไฟล์เอาท์พุต
dataDir = dataDir + "JavaScript-Added_out.pdf";

// บันทึกเอกสาร PDF ที่ได้รับการอัพเดต
doc.Save(dataDir);

Console.WriteLine("\nJavaScript added successfully to the PDF.\nFile saved at " + dataDir);
```

 ในสไนปเป็ตนี้ เราบันทึกเอกสารที่อัปเดตพร้อมเพิ่ม JavaScript ลงในไฟล์ใหม่ที่ชื่อ`"JavaScript-Added_out.pdf"`วิธีนี้รับประกันว่าคุณจะไม่ถูกเขียนทับไฟล์ต้นฉบับและยังทำให้คุณมีข้อมูลสำรองไว้ใช้งานอีกด้วย

## บทสรุป

การเพิ่ม JavaScript ลงในไฟล์ PDF โดยใช้ Aspose.PDF สำหรับ .NET ถือเป็นวิธีที่มีประสิทธิภาพในการสร้าง PDF แบบโต้ตอบและไดนามิก ไม่ว่าคุณจะกำลังดำเนินการงานอัตโนมัติ เช่น การพิมพ์หรือการสร้างการแจ้งเตือนแบบกำหนดเอง ความสามารถในการฝัง JavaScript ลงใน PDF จะทำให้เอกสารของคุณน่าสนใจและใช้งานได้ดีขึ้น

## คำถามที่พบบ่อย

### ฉันสามารถเพิ่มการกระทำ JavaScript หลายรายการลงในหน้าต่างๆ ใน PDF ได้หรือไม่
ใช่ คุณสามารถกำหนดการดำเนินการ JavaScript ที่แตกต่างกันให้กับหน้าแต่ละหน้าหรือเอกสารทั้งหมดได้

### ฉันสามารถลบ JavaScript ออกจาก PDF หลังจากเพิ่มมันแล้วได้หรือไม่?
ใช่ คุณสามารถลบหรือแก้ไขการดำเนินการ JavaScript ที่มีอยู่ได้โดยการล้าง`Actions` คุณสมบัติของเอกสารหรือหน้า

### ฉันสามารถใช้ฟังก์ชัน JavaScript ประเภทใดใน PDF ได้บ้าง?
คุณสามารถใช้ JavaScript ใดๆ ที่ได้รับการสนับสนุนโดยกลไก JavaScript ของ Adobe Acrobat เช่น การพิมพ์ การแจ้งเตือน และการจัดการแบบฟอร์ม

### JavaScript ทำงานในโปรแกรมดู PDF ทั้งหมดหรือไม่
การทำงานของ JavaScript ส่วนใหญ่จะทำงานในโปรแกรมอ่าน PDF ที่รองรับ PDF แบบโต้ตอบ เช่น Adobe Acrobat อย่างไรก็ตาม โปรแกรมอ่าน PDF พื้นฐานบางโปรแกรมอาจไม่รองรับ JavaScript

### ฉันสามารถเรียกใช้การดำเนินการ JavaScript ตามอินพุตของผู้ใช้ใน PDF ได้หรือไม่
ใช่ คุณสามารถผูก JavaScript เข้ากับฟอร์มฟิลด์เพื่อทริกเกอร์การดำเนินการตามอินพุตของผู้ใช้ได้