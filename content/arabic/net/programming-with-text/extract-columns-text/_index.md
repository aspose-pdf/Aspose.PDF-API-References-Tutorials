---
title: استخراج نص الأعمدة في ملف PDF
linktitle: استخراج نص الأعمدة في ملف PDF
second_title: مرجع واجهة برمجة التطبيقات Aspose.PDF لـ .NET
description: تعرف على كيفية استخراج أعمدة نصية من ملفات PDF باستخدام Aspose.PDF لـ .NET. يشرح هذا الدليل كل خطوة من خلال أمثلة التعليمات البرمجية والشروحات.
type: docs
weight: 150
url: /ar/net/programming-with-text/extract-columns-text/
---
## مقدمة

هل تعمل مع ملفات PDF وتحتاج إلى استخراج نص بتنسيق عمود معين؟ سواء كنت تقوم بمعالجة الفواتير أو التقارير أو أي مستندات منظمة، فإن استخراج النص بدقة من ملف PDF قد يكون مهمة صعبة. وهنا يأتي دور Aspose.PDF for .NET لتبسيط العملية. في هذا البرنامج التعليمي، سنوضح لك كيفية استخراج أعمدة النص من ملف PDF بسهولة. 

## المتطلبات الأساسية

قبل الغوص في الكود، دعنا نغطي الأشياء الأساسية التي ستحتاجها:

-  Aspose.PDF for .NET: تأكد من تثبيت أحدث إصدار من Aspose.PDF for .NET. إذا لم يكن لديك الإصدار الأحدث، فيمكنك[تحميله هنا](https://releases.aspose.com/pdf/net/).
- بيئة التطوير: ستحتاج إلى Visual Studio أو بيئة تطوير .NET أخرى للعمل مع الكود.
- مستند PDF: احتفظ بنموذج مستند PDF في متناول يدك، ويفضل أن يحتوي على أعمدة من النص، حيث سنقوم باستخراج النص منه.

 إذا لم تقم بتثبيت Aspose.PDF لـ .NET بعد، فيمكنك الحصول على[نسخة تجريبية مجانية](https://releases.aspose.com/) أو[شراء ترخيص](https://purchase.aspose.com/buy) للحصول على الميزات الكاملة. يمكنك أيضًا التقدم بطلب للحصول على[رخصة مؤقتة](https://purchase.aspose.com/temporary-license) إذا لزم الأمر.

## استيراد مساحات الأسماء

لاستخدام Aspose.PDF لـ .NET في مشروعك، ستحتاج إلى استيراد المساحات التالية:

```csharp
using System.IO;
using Aspose.Pdf;
using Aspose.Pdf.Text;
using System;
```

## دليل خطوة بخطوة: استخراج أعمدة النص من ملف PDF

الآن، دعنا نحلل كل جزء من الكود لفهم كيفية عمله بشكل أفضل. تابع معنا خطوة بخطوة، موضحًا كل جزء من العملية.

## الخطوة 1: تحميل مستند PDF

 أول شيء عليك فعله هو تحميل ملف PDF الخاص بك إلى`Document`هذا هو كيفية تفاعل Aspose.PDF مع مستندك.

```csharp
string dataDir = "YOUR DOCUMENT DIRECTORY";
Document pdfDocument = new Document(dataDir + "ExtractTextPage.pdf");
```

 في هذه الخطوة، نقوم ببساطة بتحديد الدليل الذي يتم تخزين مستند PDF فيه. استبدل`"YOUR DOCUMENT DIRECTORY"` مع المسار إلى ملف PDF المحلي الخاص بك.`Document` يقوم الكائن بتحميل ملف PDF إلى الذاكرة، مما يجعله متاحًا لمزيد من المعالجة.

## الخطوة 2: إعداد أداة امتصاص شظايا النص

 بعد ذلك، سوف نستخدم`TextFragmentAbsorber` لامتصاص أو التقاط كل النص من ملف PDF. تم تصميم فئة الامتصاص هذه لاستخراج أجزاء نصية من مناطق معينة في ملف PDF، مما يجعلها مثالية لاستخراج أعمدة من النص.

```csharp
TextFragmentAbsorber tfa = new TextFragmentAbsorber();
pdfDocument.Pages.Accept(tfa);
TextFragmentCollection tfc = tfa.TextFragments;
```

هنا، نقوم بإنشاء مثيل لـ`TextFragmentAbsorber` وتطبيقه على جميع صفحات PDF باستخدام`Accept()` . ال`TextFragmentCollection` يخزن النص المستخرج، ومن هذه المجموعة، يمكننا معالجة النص أو استخراجه حسب الحاجة.

## الخطوة 3: ضبط حجم الخط للنص المستخرج

بمجرد التقاط أجزاء النص، قد ترغب في تقليل حجم الخط، خاصةً عندما يكون النص الأصلي كبيرًا جدًا. في هذا المثال، نقوم بتقليل حجم الخط بنسبة 70%.

```csharp
foreach (TextFragment tf in tfc)
{
    // تقليل حجم الخط بنسبة 70%
    tf.TextState.FontSize = tf.TextState.FontSize * 0.7f;
}
```

هذا الكود يتكرر في كل مرة`TextFragment` في المجموعة ويقلل حجم الخط بنسبة 70%. يمكن أن يؤدي تعديل حجم الخط إلى تسهيل إدارة النص المستخرج، خاصة إذا كنت تقوم بتنسيقه لأغراض مختلفة.

## الخطوة 4: حفظ المستند في مجرى الذاكرة

 بعد تعديل النص نقوم بحفظ ملف PDF في`MemoryStream`يتيح لنا هذا الاحتفاظ بالمستند في الذاكرة لمزيد من المعالجة دون الحاجة إلى كتابته مرة أخرى على القرص.

```csharp
Stream st = new MemoryStream();
pdfDocument.Save(st);
pdfDocument = new Document(st);
```

هنا، نقوم بحفظ ملف PDF في مجرى ذاكرة ثم إعادة تحميل المستند. هذه الطريقة مفيدة عندما تعمل بملفات كبيرة وترغب في تجنب عمليات القرص غير الضرورية.

## الخطوة 5: استخراج النص بالكامل باستخدام Text Absorber

 الآن بعد أن قمنا بإعداد ملف PDF، حان الوقت لاستخراج النص. سنستخدم`TextAbsorber` للحصول على كل النص من المستند.

```csharp
TextAbsorber textAbsorber = new TextAbsorber();
pdfDocument.Pages.Accept(textAbsorber);
String extractedText = textAbsorber.Text;
```

 في هذه الخطوة،`TextAbsorber` يمتص كل النص من ملف PDF، ويتم تخزين النص المستخرج في`extractedText` السلسلة. هذا هو المكان الذي تحدث فيه السحر - أصبحت أعمدة النص لديك الآن بتنسيق نص عادي!

## الخطوة 6: احفظ النص المستخرج في ملف

 وأخيرًا، نقوم بحفظ النص المستخرج في`.txt` ملف لسهولة الوصول إليه ومزيد من الاستخدام.

```csharp
dataDir = dataDir + "ExtractColumnsText_out.txt";
System.IO.File.WriteAllText(dataDir, extractedText);
Console.WriteLine("\nColumns text extracted successfully from Pages of PDF Document.\nFile saved at " + dataDir);
```

 يكتب هذا الكود النص المستخرج في ملف جديد`.txt` يقوم بحفظ الملف في الدليل المحدد. يتم عرض رسالة في وحدة التحكم لتأكيد نجاح العملية.

## خاتمة

هذا كل ما في الأمر! إن استخراج أعمدة نصية من ملف PDF باستخدام Aspose.PDF لـ .NET أسهل مما قد تظن. فباستخدام بضعة أسطر فقط من التعليمات البرمجية، يمكنك تحميل ملف PDF واستخراج نص معين وتعديل التنسيق وحفظ النتائج في ملف نصي.

تُعد هذه التقنية مفيدة بشكل لا يصدق لمعالجة المستندات المنظمة مثل الجداول أو التقارير أو أي محتوى منظم في أعمدة. سواء كنت بحاجة إلى أتمتة استخراج البيانات أو معالجة مستندات ضخمة، فإن Aspose.PDF يوفر لك الأدوات اللازمة لتحقيق ذلك بكفاءة.

## الأسئلة الشائعة

### هل يمكنني استخراج النص من صفحات محددة من ملف PDF؟  
 نعم! يمكنك تعديل`TextFragmentAbsorber` لاستهداف صفحات محددة باستخدام`pdfDocument.Pages[pageIndex].Accept(tfa);` طريقة.

### هل من الممكن استخراج النص من عمود واحد فقط في ملف PDF متعدد الأعمدة؟  
 نعم، ولكنك ستحتاج إلى العمل مع إحداثيات أجزاء النص باستخدام`TextFragment.Rectangle` لاستهداف مناطق محددة من الوثيقة.

### كيف يمكنني تحسين دقة استخراج النص؟  
 للحصول على دقة أفضل، تأكد من أن بنية ملف PDF محددة جيدًا وتجنب المستندات ذات التخطيطات المعقدة. يمكنك أيضًا ضبط التنسيقات بدقة`TextFragmentAbsorber` لاستخراج النص بناءً على أنماط الخطوط أو أحجامها أو مناطقها.

### هل يدعم Aspose.PDF استخراج النص من المستندات الممسوحة ضوئيًا؟  
نعم، ولكنك ستحتاج إلى استخدام تقنية التعرف الضوئي على الحروف (OCR). توفر Aspose أدوات لهذا أيضًا.

### كيف أتعامل مع ملفات PDF كبيرة الحجم تحتوي على آلاف الصفحات؟  
بالنسبة لملفات PDF الكبيرة، قم بمعالجة المستند في أجزاء عن طريق استخراج النص من بضع صفحات في كل مرة لتجنب استخدام قدر كبير من الذاكرة.