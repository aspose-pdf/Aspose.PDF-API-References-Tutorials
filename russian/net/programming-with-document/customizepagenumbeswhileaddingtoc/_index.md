---
title: Настройка номеров страниц при добавлении оглавления
linktitle: Настройка номеров страниц при добавлении оглавления
second_title: Aspose.PDF для справочника API .NET
description: Узнайте, как настроить номера страниц при добавлении оглавления (TOC) с помощью Aspose.PDF для .NET с помощью этого пошагового руководства и примера кода.
type: docs
weight: 100
url: /ru/net/programming-with-document/customizepagenumbeswhileaddingtoc/
---
В этом руководстве мы рассмотрим, как настраивать номера страниц при добавлении оглавления (TOC) с помощью Aspose.PDF для .NET. Мы предоставим пошаговое руководство вместе с примером кода, чтобы помочь вам в этом.

## Шаг 1. Загрузка существующего файла PDF

Во-первых, нам нужно загрузить существующий файл PDF. В этом уроке мы будем использовать файл «42824.pdf», расположенный в каталоге «ВАШ ДОКУМЕНТАРИЙ». Замените этот путь к каталогу фактическим путем к каталогу вашего документа.

```csharp
string dataDir = "YOUR DOCUMENT DIRECTORY";
string inFile = dataDir + "42824.pdf";
string outFile = dataDir + "42824_out.pdf";
Document doc = new Document(inFile);
```

## Шаг 2: Добавление страницы оглавления

 Далее нам нужно добавить новую страницу в начало документа, которая будет служить страницей оглавления. Мы можем добиться этого с помощью`Insert()` метод`Pages` коллекция`Document` объект.

```csharp
Aspose.Pdf.Page tocPage = doc.Pages.Insert(1);
```

## Шаг 3: Создание объекта TOC

 Чтобы создать объект TOC, нам сначала нужно создать`TocInfo` объекта и установить его свойства. В этом уроке мы установим заголовок TOC на «Table Of Contents» и префикс номера страницы на «P».

```csharp
TocInfo tocInfo = new TocInfo();
TextFragment title = new TextFragment("Table Of Contents");
title.TextState.FontSize = 20;
title.TextState.FontStyle = FontStyles.Bold;
tocInfo.Title = title;
tocInfo.PageNumbersPrefix = "P";
tocPage.TocInfo = tocInfo;
```

## Шаг 4: Создание записей оглавления

Чтобы создать записи TOC, нам нужно пройтись по всем страницам документа, кроме страницы TOC, и создать объект заголовка для каждой страницы. Затем мы можем добавить объект заголовка на страницу оглавления и указать его целевую страницу.

```csharp
for (int i = 1; i < doc.Pages.Count; i++)
{
    // Создать объект заголовка
    Aspose.Pdf.Heading heading2 = new Aspose.Pdf.Heading(1);
    TextSegment segment2 = new TextSegment();
    heading2.TocPage = tocPage;
    heading2.Segments.Add(segment2);
    // Укажите целевую страницу для объекта заголовка
    heading2.DestinationPage = doc.Pages[i + 1];
    // Целевая страница
    heading2.Top = doc.Pages[i + 1].Rect.Height;
    // Координата пункта назначения
    segment2.Text = "Page " + i.ToString();
    // Добавить заголовок на страницу, содержащую оглавление
    tocPage.Paragraphs.Add(heading2);
}
```

## Шаг 5: Сохранение обновленного документа

Наконец, нам нужно сохранить обновленный документ в новый файл. Мы можем добиться этого с помощью`Save()` метод`Document` объект.

```csharp
doc.Save(outFile);
```

### Пример исходного кода для настройки номеров страниц при добавлении оглавления с использованием Aspose.PDF для .NET

```csharp
string dataDir = "YOUR DOCUMENT DIRECTORY";
string inFile = dataDir + "42824.pdf";
string outFile = dataDir + "42824_out.pdf";
// Загрузите существующие файлы PDF
Document doc = new Document(inFile);
// Получить доступ к первой странице файла PDF
Aspose.Pdf.Page tocPage = doc.Pages.Insert(1);
// Создайте объект для представления информации TOC
TocInfo tocInfo = new TocInfo();
TextFragment title = new TextFragment("Table Of Contents");
title.TextState.FontSize = 20;
title.TextState.FontStyle = FontStyles.Bold;
// Установите заголовок для оглавления
tocInfo.Title = title;
tocInfo.PageNumbersPrefix = "P";
tocPage.TocInfo = tocInfo;
for (int i = 1; i<doc.Pages.Count; i++)
{
	// Создать объект заголовка
	Aspose.Pdf.Heading heading2 = new Aspose.Pdf.Heading(1);
	TextSegment segment2 = new TextSegment();
	heading2.TocPage = tocPage;
	heading2.Segments.Add(segment2);
	// Укажите целевую страницу для объекта заголовка
	heading2.DestinationPage = doc.Pages[i + 1];
	// Целевая страница
	heading2.Top = doc.Pages[i + 1].Rect.Height;
	// Координата пункта назначения
	segment2.Text = "Page " + i.ToString();
	// Добавить заголовок на страницу, содержащую оглавление
	tocPage.Paragraphs.Add(heading2);
}

// Сохраните обновленный документ
doc.Save(outFile);
```

## Заключение

В этом руководстве мы предоставили пошаговое руководство по настройке номеров страниц при добавлении оглавления с помощью Aspose.PDF для .NET. Мы также предоставили пример кода, который вы можете использовать в качестве справочного материала при реализации этой функции в своем

### Часто задаваемые вопросы

#### В: Что такое оглавление (TOC) в документе PDF?

О: Оглавление (TOC) в документе PDF — это средство навигации, которое предоставляет упорядоченный список разделов или глав документа вместе с соответствующими номерами страниц. Это позволяет читателям быстро переходить к определенным разделам документа.

#### В: Зачем мне настраивать номера страниц в оглавлении?

О: Настройка номеров страниц в оглавлении может быть полезна, если вы хотите использовать определенный формат нумерации страниц или включить дополнительную информацию вместе с номерами страниц. Это позволяет вам создать более персонализированное и информативное оглавление.

#### В: Могу ли я включить в оглавление гиперссылки на определенные разделы или страницы документа PDF?

О: Да, Aspose.PDF для .NET позволяет создавать гиперссылки в оглавлении, которые ссылаются на определенные разделы или страницы в документе PDF. Это повышает интерактивность и навигацию по документу PDF.

#### В: Совместим ли Aspose.PDF для .NET со стандартами PDF/A?

О: Да, Aspose.PDF для .NET поддерживает стандарты PDF/A, включая PDF/A-1, PDF/A-2 и PDF/A-3. Он позволяет создавать PDF-документы, соответствующие требованиям архивирования и долгосрочного хранения.

#### В: Могу ли я добавить дополнительное форматирование к записям оглавления, например стили шрифта или цвета?

О: Да, вы можете добавить дополнительное форматирование к записям оглавления, например стили шрифтов, цвета и размеры шрифтов, используя Aspose.PDF для .NET. Это позволяет настроить внешний вид оглавления в соответствии с вашими требованиями.
