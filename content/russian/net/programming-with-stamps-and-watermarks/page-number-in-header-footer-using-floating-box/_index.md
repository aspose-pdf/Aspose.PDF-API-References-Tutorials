---
title: Номер страницы в верхнем и нижнем колонтитуле с использованием плавающего поля
linktitle: Номер страницы в верхнем и нижнем колонтитуле с использованием плавающего поля
second_title: Справочник по API Aspose.PDF для .NET
description: Узнайте, как добавить номер страницы в верхний и нижний колонтитулы PDF-документа с помощью Aspose.PDF для .NET.
type: docs
weight: 150
url: /ru/net/programming-with-stamps-and-watermarks/page-number-in-header-footer-using-floating-box/
---
В этом уроке мы шаг за шагом покажем вам, как добавить номер страницы в верхний и нижний колонтитулы документа PDF с помощью FloatingBox с Aspose.PDF для .NET. Мы будем использовать предоставленный исходный код C# для создания документа PDF, добавим страницу, создадим FloatingBox, установим его положение и добавим к нему номер страницы, затем сохраним измененный документ PDF.

## Шаг 1: Настройка среды

Прежде чем начать, убедитесь, что у вас есть следующее:

- Установленная среда разработки .NET.
- Библиотека Aspose.PDF для .NET, загруженная и указанная в вашем проекте.

## Шаг 2: Создание PDF-документа и добавление страницы

Первый шаг — создать экземпляр PDF-документа и добавить в него страницу. Вот как:

```csharp
// Путь к каталогу документов.
string dataDir = "YOUR DOCUMENTS DIRECTORY";

// Создайте экземпляр PDF-документа
Aspose.Pdf.Document pdf = new Aspose.Pdf.Document();

// Добавить страницу в PDF-документ
Aspose.Pdf.Page page = pdf.Pages.Add();
```

Обязательно замените «КАТАЛОГ ВАШИХ ДОКУМЕНТОВ» фактическим путем к каталогу, в котором вы хотите сохранить PDF-документ.

## Шаг 3: Создание FloatingBox и добавление номера страницы

Теперь, когда страница добавлена в документ PDF, мы можем создать FloatingBox, задать его положение и добавить к нему номер страницы. Вот как:

```csharp
// Создайте FloatingBox шириной 140 и высотой 80.
Aspose.Pdf.FloatingBox box1 = new Aspose.Pdf.FloatingBox(140, 80);

// Установить левую позицию абзаца
box1. Left = 2;

// Установить верхнюю позицию абзаца
box1. Top = 10;

// Добавьте номер страницы в FloatingBox
box1.Paragraphs.Add(new Aspose.Pdf.Text.TextFragment("Page: ($p/ $P )"));

// Добавьте FloatingBox на страницу
page.Paragraphs.Add(box1);
```

Код выше создает FloatingBox шириной 140 и высотой 80. Затем мы задаем его положение, указывая значения left и top. Наконец, мы добавляем номер страницы к FloatingBox, используя TextFragment, содержащий синтаксис "($p/ $P )", который будет заменен текущим номером страницы и общим количеством страниц.

## Шаг 4: Сохранение измененного PDF-документа

После добавления номера страницы в верхний или нижний колонтитул с помощью FloatingBox мы можем сохранить измененный PDF-документ. Вот как:

```csharp
// Сохраните измененный PDF-документ.
pdf.Save(dataDir + "PageNumberinHeaderFooterUsingFloatingBox_out.pdf");
```

Приведенный выше код сохраняет отредактированный PDF-документ в указанном каталоге.

### Пример исходного кода для номера страницы в верхнем и нижнем колонтитуле с использованием плавающего поля с использованием Aspose.PDF для .NET 
```csharp

// Путь к каталогу документов.
string dataDir = "YOUR DOCUMENT DIRECTORY";

// Создать экземпляр документа
Aspose.Pdf.Document pdf = new Aspose.Pdf.Document();

// Добавить страницу в документ PDF
Aspose.Pdf.Page page = pdf.Pages.Add();

// Инициализирует новый экземпляр класса FloatingBox.
Aspose.Pdf.FloatingBox box1 = new Aspose.Pdf.FloatingBox(140, 80);

// Плавающее значение, указывающее левую позицию абзаца
box1.Left = 2;

// Плавающее значение, указывающее верхнюю позицию абзаца
box1.Top = 10;

// Добавьте макросы в коллекцию абзацев FloatingBox
box1.Paragraphs.Add(new Aspose.Pdf.Text.TextFragment("Page: ($p/ $P )"));

// Добавить плавающий блок на страницу
page.Paragraphs.Add(box1);

// Сохранить документ
pdf.Save(dataDir + "PageNumberinHeaderFooterUsingFloatingBox_out.pdf");

```

## Заключение

Поздравляем! Вы узнали, как добавить номер страницы в верхний и нижний колонтитулы PDF-документа с помощью FloatingBox с Aspose.PDF для .NET. Теперь вы можете настраивать верхние и нижние колонтитулы, добавляя динамическую информацию, такую как номер страницы.

### Часто задаваемые вопросы

#### В: Что такое FloatingBox и как его использовать для добавления номеров страниц в верхний или нижний колонтитул PDF-документа?

A: FloatingBox — это универсальный элемент макета в Aspose.PDF, который может содержать различный контент, включая текст и изображения. В этом руководстве он используется для создания контейнера для номера страницы, позволяя динамически вставлять текущий номер страницы и общее количество страниц в верхний или нижний колонтитул.

#### В: Каким образом предоставленный исходный код C# позволяет добавлять номера страниц с помощью FloatingBox?

A: Фрагмент кода демонстрирует, как создать документ PDF, добавить страницу, создать FloatingBox, задать его положение на странице и вставить номер страницы с помощью TextFragment. Синтаксис "($p/ $P )" в TextFragment заменяется на текущий номер страницы и общее количество страниц.

#### В: Могу ли я настроить внешний вид и форматирование номера страницы, добавленного с помощью FloatingBox?

A: Да, вы можете настроить внешний вид номера страницы, изменив свойства TextFragment в FloatingBox. Вы можете изменить размер шрифта, цвет, стиль, выравнивание и другие параметры форматирования.

#### В: Можно ли добавлять различные динамические элементы, такие как дата и время, в верхний или нижний колонтитул, используя аналогичный подход?

A: Конечно, вы можете добавлять различные динамические элементы, такие как дата, время, метаданные документа или пользовательский текст, изменяя содержимое TextFragment внутри FloatingBox. Вы можете использовать макросы, такие как "($p/ $P )" для номеров страниц или "($date)" для текущей даты.

#### В: Как указать положение FloatingBox в верхнем или нижнем колонтитуле?
 A: Приведенный код устанавливает положение FloatingBox с помощью`Left` и`Top` Свойства. Вы можете настроить эти значения, чтобы расположить FloatingBox по своему усмотрению в разделе верхнего или нижнего колонтитула.

#### В: Могу ли я использовать другой шрифт или стиль для номера страницы в верхнем или нижнем колонтитуле?

A: Да, вы можете настроить шрифт, стиль и другие свойства форматирования текста номера страницы, изменив свойства TextFragment в FloatingBox.

#### В: Что произойдет, если содержимое FloatingBox превысит его размеры?

A: Если содержимое FloatingBox превышает его размеры, оно может быть обрезано или могут возникнуть проблемы с макетом. Убедитесь, что размеры FloatingBox подходят для размещения контента, и рассмотрите возможность корректировки макета страницы при необходимости.

#### В: Можно ли добавить несколько FloatingBox с разным содержимым в верхний или нижний колонтитул одной и той же страницы?

A: Да, вы можете добавить несколько FloatingBox с разным содержимым в верхний или нижний колонтитул одной и той же страницы, создав отдельные экземпляры FloatingBox и добавив их в коллекцию Paragraphs страницы.

#### В: Могу ли я использовать подход FloatingBox для добавления контента в другие разделы PDF-документа, например в текст или поля?

A: Хотя плавающие блоки обычно используются для верхних и нижних колонтитулов, вы также можете использовать их для добавления контента в другие разделы PDF-документа, такие как тело или поля, размещая их соответствующим образом на странице.