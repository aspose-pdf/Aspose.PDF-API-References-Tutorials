---
title: استخراج معلومات التوقيع
linktitle: استخراج معلومات التوقيع
second_title: مرجع واجهة برمجة التطبيقات Aspose.PDF لـ .NET
description: استخراج معلومات التوقيع باستخدام Aspose.PDF لـ .NET.
type: docs
weight: 80
url: /ar/net/programming-with-security-and-signatures/extract-signature-info/
---
يمكن أن تكون عملية استخراج معلومات التوقيع من مستند PDF مفيدة للغاية في سيناريوهات مختلفة. سواء كنت بحاجة إلى التحقق من صحة مستند موقّع أو تحليل الشهادة المستخدمة للتوقيع، توفر مكتبة Aspose.PDF for .NET حلاً ملائمًا. في هذا البرنامج التعليمي، سنرشدك خلال عملية استخراج معلومات التوقيع خطوة بخطوة باستخدام كود المصدر C# المقدم.

## متطلبات

قبل أن نبدأ، تأكد من توفر المتطلبات الأساسية التالية:

1. المعرفة الأساسية للغة البرمجة C#.
2. تم تثبيت مكتبة Aspose.PDF لـ .NET على نظامك.
3. مستند PDF صالح يحتوي على حقل توقيع واحد أو أكثر.

الآن، دعونا ننتقل إلى تفاصيل التنفيذ.

## الخطوة 1: استيراد المكتبات المطلوبة

 للبدء، تحتاج إلى استيراد المكتبات الضرورية إلى مشروع C# الخاص بك. في هذه الحالة، نحتاج إلى استيراد`Aspose.Pdf` و`System.IO` يمكن القيام بذلك عن طريق إضافة الكود التالي في بداية ملف C# الخاص بك:

```csharp
using Aspose.Pdf;
using System.IO;
```

## الخطوة 2: تعيين مسار المستند

بعد ذلك، تحتاج إلى تعيين المسار إلى مستند PDF الذي تريد استخراج معلومات التوقيع منه. استبدل`"YOUR DOCUMENTS DIRECTORY"` في مقتطف التعليمات البرمجية التالي مع المسار الفعلي للمستند الخاص بك:

```csharp
string dataDir = "YOUR DOCUMENTS DIRECTORY";
string input = dataDir + "ExtractSignatureInfo.pdf";
```

## الخطوة 3: استخراج معلومات التوقيع

الآن، دعنا ننتقل إلى الجزء الرئيسي من الكود حيث نقوم باستخراج معلومات التوقيع من مستند PDF. نكرر كل حقل في نموذج المستند ونتحقق مما إذا كان حقل توقيع. إذا تم العثور على حقل توقيع، ننتقل إلى استخراج الشهادة. أضف مقتطف الكود التالي:

```csharp
using (Document pdfDocument = new Document(input))
{
     foreach(Field field in pdfDocument.Form)
     {
         SignatureField sf = field as SignatureField;
         if (sf != null)
         {
             // استخراج الشهادة
             Stream cerStream = sf.ExtractCertificate();
             if (cerStream != null)
             {
                 using (cerStream)
                 {
                     byte[] bytes = new byte[cerStream.Length];
                     using (FileStream fs = new FileStream(dataDir + @"input.cer", FileMode.CreateNew))
                     {
                         cerStream.Read(bytes, 0, bytes.Length);
                         fs.Write(bytes, 0, bytes.Length);
                     }
                 }
             }
         }
     }
}
```

## الخطوة 4: استخراج الشهادة

في هذه الخطوة، نقوم باستخراج الشهادة من حقل التوقيع وحفظها كملف. يمكن تحليل الشهادة المستخرجة بشكل أكبر أو استخدامها لأغراض التحقق. يوضح مقطع التعليمات البرمجية أدناه عملية الاستخراج والحفظ:

```csharp
Stream cerStream = sf.ExtractCertificate();
if (cerStream != null)
{
     using (cerStream)
     {
         byte[] bytes = new byte[cerStream.Length];
         using (FileStream fs = new FileStream(dataDir + @"input.cer", FileMode.CreateNew))
         {
             cerStream.Read(bytes, 0, bytes.Length);
             fs.Write(bytes, 0, bytes.Length);
         }
     }
}
```

## الخطوة 5

: حفظ الشهادة

أخيرًا، نقوم بحفظ الشهادة المستخرجة كملف. في هذا المثال، يتم حفظ الشهادة باسم "input.cer" في الدليل المحدد. يمكنك تعديل الكود ليناسب متطلباتك. فيما يلي مقتطف الكود لحفظ الشهادة:

```csharp
using (FileStream fs = new FileStream(dataDir + @"input.cer", FileMode.CreateNew))
{
     fs.Write(bytes, 0, bytes.Length);
}
```

هذا كل شيء! لقد نجحت في استخراج معلومات التوقيع باستخدام Aspose.PDF لـ .NET. لا تتردد في دمج هذا الكود في تطبيقاتك الخاصة أو تعديله وفقًا لاحتياجاتك.

### عينة من كود المصدر لاستخراج معلومات التوقيع باستخدام Aspose.PDF لـ .NET 
```csharp
try
{
	// المسار إلى دليل المستندات.
	string dataDir = "YOUR DOCUMENTS DIRECTORY";
	string input = dataDir + "ExtractSignatureInfo.pdf";
	using (Document pdfDocument = new Document(input))
	{
		foreach (Field field in pdfDocument.Form)
		{
			SignatureField sf = field as SignatureField;
			if (sf != null)
			{
				Stream cerStream = sf.ExtractCertificate();
				if (cerStream != null)
				{
					using (cerStream)
					{
						byte[] bytes = new byte[cerStream.Length];
						using (FileStream fs = new FileStream(dataDir + @"input.cer", FileMode.CreateNew))
						{
							cerStream.Read(bytes, 0, bytes.Length);
							fs.Write(bytes, 0, bytes.Length);
						}
					}
				}
			}
		}
	}
}
catch (Exception ex)
{
	Console.WriteLine(ex.Message);
}
```

## خاتمة

في هذا البرنامج التعليمي، قمنا باستعراض دليل خطوة بخطوة حول كيفية استخراج معلومات التوقيع من مستند PDF باستخدام مكتبة Aspose.PDF for .NET. قمنا بتغطية عملية استيراد المكتبات المطلوبة، وتعيين مسار المستند، واستخراج معلومات التوقيع، واستخراج الشهادة، وحفظها في ملف. باتباع هذه الخطوات، يمكنك بسهولة استرداد تفاصيل التوقيع والعمل بها حسب الحاجة.

### الأسئلة الشائعة

#### س: لماذا أحتاج إلى استخراج معلومات التوقيع من مستند PDF؟

ج: يعد استخراج معلومات التوقيع من مستند PDF مفيدًا للتحقق من صحة المستند الموقّع وتحليل الشهادة المستخدمة للتوقيع. تساعد هذه العملية في ضمان سلامة المحتوى الموقّع ويمكن أن تكون ضرورية للأغراض القانونية والأمنية.

#### س: ما هو Aspose.PDF لـ .NET؟

ج: Aspose.PDF for .NET هي مكتبة تتيح للمطورين العمل مع مستندات PDF في تطبيقات .NET. وهي توفر مجموعة واسعة من الميزات لإنشاء ملفات PDF وتعديلها والتفاعل معها برمجيًا.

#### س: ما هي المتطلبات الأساسية لاستخراج معلومات التوقيع باستخدام Aspose.PDF لـ .NET؟

ج: لاستخراج معلومات التوقيع، تحتاج إلى معرفة أساسية بلغة البرمجة C#، ومكتبة Aspose.PDF for .NET المثبتة على نظامك، ومستند PDF صالح يحتوي على حقل توقيع واحد أو أكثر.

#### س: كيف أقوم باستيراد المكتبات المطلوبة لعملية الاستخراج؟

أ: يمكنك استيراد المكتبات اللازمة عن طريق إضافة`using` التوجيهات ل`Aspose.Pdf` و`System.IO` في بداية ملف C# الخاص بك. تتيح لك هذه التوجيهات استخدام الفئات والطرق المطلوبة لاستخراج معلومات التوقيع.

#### س: كيف أحدد مستند PDF لاستخراج معلومات التوقيع؟

 أ: يمكنك تعيين المسار إلى مستند PDF عن طريق استبدال`"YOUR DOCUMENTS DIRECTORY"` مع المسار الفعلي إلى مستندك في مقتطف التعليمات البرمجية المقدم. يُستخدم هذا المسار لتحميل مستند PDF الذي تريد استخراج معلومات التوقيع منه.

#### س: ما هي عملية استخراج معلومات التوقيع من مستند PDF؟

ج: تتضمن عملية الاستخراج تكرار حقول النموذج في مستند PDF، والتحقق مما إذا كان كل حقل حقل توقيع، وإذا كان كذلك، استخراج الشهادة المرتبطة به. يمكن حفظ الشهادة المستخرجة كملف لمزيد من التحليل أو التحقق من صحتها.

#### س: كيف يتم استخراج الشهادة من حقل التوقيع؟

أ: يتم استخراج الشهادة من حقل التوقيع باستخدام`ExtractCertificate()` الطريقة التي تقدمها`SignatureField` الفئة في Aspose.PDF لـ .NET. تعيد هذه الطريقة دفقًا يحتوي على بيانات الشهادة.

#### س: كيف يمكنني حفظ الشهادة المستخرجة كملف؟

 أ: يمكنك حفظ الشهادة المستخرجة كملف عن طريق قراءة مجرى الشهادة وكتابة محتوياتها في ملف باستخدام`FileStream` يوضح الكود الموجود في البرنامج التعليمي هذه العملية.

#### س: هل يمكنني استخدام هذه الشهادة المستخرجة للتحقق من صحة التوقيع؟

ج: نعم، يمكن استخدام الشهادة المستخرجة للتحقق من صحة التوقيع. يمكنك تحليل تفاصيل الشهادة والتحقق من صحتها لضمان سلامة الوثيقة الموقعة.

#### س: كيف يمكنني دمج هذا الكود في تطبيقاتي الخاصة؟

ج: يمكنك دمج الكود المقدم في تطبيقات C# الخاصة بك باتباع الدليل خطوة بخطوة. قم بتعديل المسارات وأسماء الملفات حسب الحاجة، وأدرج الكود في مشاريعك الحالية.

#### س: هل هناك ميزات أخرى في Aspose.PDF لـ .NET تتعلق بإدارة التوقيعات؟

ج: نعم، يوفر Aspose.PDF for .NET مجموعة من الميزات للعمل مع التوقيعات الرقمية، بما في ذلك توقيع المستندات والتحقق من التوقيعات وإضافة معلومات الطابع الزمني. يمكنك استكشاف الوثائق الرسمية لمزيد من التفاصيل حول هذه الميزات.

#### س: أين يمكنني العثور على موارد إضافية لاستخدام Aspose.PDF لـ .NET؟

 ج: لمزيد من المعلومات والبرامج التعليمية والموارد حول استخدام Aspose.PDF لـ .NET،[Aspose.PDF لـ .NET](https://reference.aspose.com/pdf/net/).

#### س: هل من الممكن استخراج التوقيعات من مستندات PDF المشفرة؟

ج: قد تعتمد القدرة على استخراج التوقيعات من مستندات PDF المشفرة على إعدادات التشفير وأذونات المستند. قد تحتاج إلى التأكد من حصولك على الأذونات اللازمة للوصول إلى معلومات التوقيع واستخراجها.

#### س: هل يمكنني استخراج توقيعات متعددة من مستند PDF واحد؟

ج: نعم، يمكنك تعديل الكود المقدم لتكرار جميع حقول التوقيع في مستند PDF واستخراج معلومات التوقيع من كل منها. يتيح لك هذا استخراج معلومات حول التوقيعات المتعددة الموجودة في المستند.

#### س: ما هي بعض حالات الاستخدام العملية لاستخراج معلومات التوقيع؟

أ: تتضمن بعض حالات الاستخدام العملية لاستخراج معلومات التوقيع التحقق من صحة المستندات الموقعة رقميًا، وتحليل تفاصيل الشهادة لأغراض الامتثال، والحفاظ على سجل التوقيعات والموقعين لأغراض التدقيق.

#### س: هل هناك أية اعتبارات قانونية عند استخراج معلومات التوقيع؟

ج: قد يكون لاستخراج معلومات التوقيع آثار قانونية، وخاصة عند التعامل مع مستندات ملزمة قانونًا. تأكد من امتثالك للأنظمة والقوانين ذات الصلة بالتوقيعات الإلكترونية ومصداقية المستندات في ولايتك القضائية.