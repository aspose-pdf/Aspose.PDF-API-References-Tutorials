---
title: แปลงสตรีมภาพเป็นไฟล์ PDF
linktitle: แปลงสตรีมภาพเป็นไฟล์ PDF
second_title: เอกสารอ้างอิง Aspose.PDF สำหรับ API ของ .NET
description: แปลงสตรีมภาพเป็นไฟล์ PDF ได้อย่างง่ายดายด้วย Aspose.PDF สำหรับ .NET
type: docs
weight: 70
url: /th/net/programming-with-images/convert-image-stream-to-pdf/
---
คู่มือนี้จะแนะนำคุณทีละขั้นตอนเกี่ยวกับการแปลงสตรีมภาพเป็นไฟล์ PDF โดยใช้ Aspose.PDF สำหรับ .NET ตรวจสอบให้แน่ใจว่าคุณได้ตั้งค่าสภาพแวดล้อมของคุณแล้ว และทำตามขั้นตอนด้านล่าง:

## ขั้นตอนที่ 1: กำหนดไดเรกทอรีเอกสาร

ก่อนเริ่มต้น ตรวจสอบให้แน่ใจว่าคุณได้ตั้งค่าไดเรกทอรีที่ถูกต้องสำหรับเอกสารแล้ว แทนที่`"YOUR DOCUMENT DIRECTORY"` ในโค้ดพร้อมเส้นทางไปยังไดเร็กทอรีที่มีรูปภาพของคุณอยู่

```csharp
string dataDir = "YOUR DOCUMENT DIRECTORY";
```

## ขั้นตอนที่ 2: สร้างอินสแตนซ์ของวัตถุเอกสาร

 ในขั้นตอนนี้เราจะสร้างอินสแตนซ์`Document` วัตถุที่ใช้ constructor ที่ว่างเปล่าของ`Aspose.Pdf.Document` ระดับ.

```csharp
Aspose.Pdf.Document pdf1 = new Aspose.Pdf.Document();
```

## ขั้นตอนที่ 3: เพิ่มหน้าลงในเอกสาร PDF

เพิ่มหน้าลงในเอกสาร PDF โดยใช้`Add` วิธีการของ`Pages` วัตถุของ`pdf1`.

```csharp
Aspose.Pdf.Page sec = pdf1.Pages.Add();
```

## ขั้นตอนที่ 4: อ่านสตรีมภาพ

 ในขั้นตอนนี้เราจะสร้าง`FileStream` วัตถุที่จะอ่านไฟล์ภาพจากสตรีม

```csharp
FileStream fs = File.OpenRead(dataDir + "aspose.jpg");
```

## ขั้นตอนที่ 5: อ่านภาพลงในอาร์เรย์ไบต์

 อ่านภาพจากสตรีมและเก็บไว้ในอาร์เรย์ไบต์โดยใช้`Read` วิธีการของ`fs` วัตถุ.

```csharp
byte[] data = new byte[fs.Length];
fs.Read(data, 0, data.Length);
```

## ขั้นตอนที่ 6: สร้างวัตถุ MemoryStream จากอาร์เรย์ไบต์

 สร้าง`MemoryStream` วัตถุจากอาร์เรย์ไบต์ที่ประกอบด้วยรูปภาพ

```csharp
MemoryStream ms = new MemoryStream(data);
```

## ขั้นตอนที่ 7: สร้างวัตถุรูปภาพ

 ในขั้นตอนนี้เราจะสร้าง`Image` วัตถุที่ใช้`Aspose.Pdf.Image` คลาส ระบุสตรีมของภาพโดยใช้`ImageStream` ทรัพย์สินและส่งต่อ`ms` วัตถุที่เราสร้างไว้ก่อนหน้านี้

```csharp
Aspose.Pdf.Image imageht = new Aspose.Pdf.Image();
imageht. ImageStream = ms;
```

## ขั้นตอนที่ 8: เพิ่มวัตถุรูปภาพลงในคอลเล็กชั่นย่อหน้า

 เพิ่ม`imageht` คัดค้านการ`Paragraphs` การรวบรวมของ`sec` ส่วน.

```csharp
sec.Paragraphs.Add(imageht);
```

## ขั้นตอนที่ 9: บันทึกเอกสาร PDF

 บันทึกเอกสาร PDF โดยใช้`Save` วิธีการของ`pdf1` วัตถุ ระบุเส้นทางเอาท์พุตของไฟล์ PDF

```csharp
pdf1.Save(dataDir + "ConvertMemoryStreamImageToPdf_out.pdf");
```

## ขั้นตอนที่ 10: ปิดวัตถุ MemoryStream

 ปิด`ms` วัตถุที่ใช้`Close` วิธีการปล่อยทรัพยากร

```csharp
ms. Close();
```

### ตัวอย่างโค้ดต้นฉบับสำหรับการแปลง Image Stream เป็น PDF โดยใช้ Aspose.PDF สำหรับ .NET 
```csharp
// เส้นทางไปยังไดเร็กทอรีเอกสาร
string dataDir = "YOUR DOCUMENT DIRECTORY";
// สร้างอินสแตนซ์เอกสารโดยเรียกคอนสตรัคเตอร์ที่ว่างเปล่า
Aspose.Pdf.Document pdf1 = new Aspose.Pdf.Document();
// เพิ่มหน้าลงในเอกสาร PDF
Aspose.Pdf.Page sec = pdf1.Pages.Add();
// สร้างวัตถุ FileStream เพื่ออ่านไฟล์ imag
FileStream fs = File.OpenRead(dataDir + "aspose.jpg");
// อ่านภาพลงในอาร์เรย์ไบต์
byte[] data = new byte[fs.Length];
fs.Read(data, 0, data.Length);
// สร้างวัตถุ MemoryStream จากอาร์เรย์ไบต์ของภาพ
MemoryStream ms = new MemoryStream(data);
// สร้างวัตถุภาพ
Aspose.Pdf.Image imageht = new Aspose.Pdf.Image();
// ระบุแหล่งที่มาของภาพเป็น MemoryStream
imageht.ImageStream = ms;
// เพิ่มวัตถุรูปภาพลงในคอลเล็กชั่นย่อหน้าของส่วน
sec.Paragraphs.Add(imageht);
// บันทึกไฟล์ PDF
pdf1.Save(dataDir + "ConvertMemoryStreamImageToPdf_out.pdf");
// ปิดวัตถุ MemoryStream
ms.Close();
```

## บทสรุป

ขอแสดงความยินดี ! คุณได้แปลงสตรีมภาพเป็นไฟล์ PDF โดยใช้ Aspose.PDF สำหรับ .NET สำเร็จแล้ว ไฟล์ PDF ที่สร้างขึ้นจะถูกบันทึกไว้ในไดเร็กทอรีที่ระบุ ตอนนี้คุณสามารถใช้ไฟล์ PDF นี้ในโครงการหรือแอปพลิเคชันของคุณได้แล้ว

### คำถามที่พบบ่อย

#### ถาม: จุดประสงค์ของการแปลงสตรีมภาพเป็นไฟล์ PDF โดยใช้ Aspose.PDF สำหรับ .NET คืออะไร

A: การแปลงสตรีมภาพเป็นไฟล์ PDF อาจเป็นประโยชน์สำหรับการรวมรูปภาพลงในเอกสาร PDF การสร้าง PDF ที่ใช้รูปภาพ หรือการฝังรูปภาพภายในเนื้อหาข้อความ

#### ถาม: Aspose.PDF สำหรับ .NET ช่วยในการแปลงสตรีมภาพเป็นไฟล์ PDF ได้อย่างไร

A: Aspose.PDF สำหรับ .NET มอบกระบวนการที่สะดวกและเป็นขั้นตอนทีละขั้นตอนในการสร้างเอกสาร PDF อ่านสตรีมภาพ และฝังภาพลงในไฟล์ PDF

#### ถาม: เหตุใดการกำหนดไดเรกทอรีเอกสารจึงมีความสำคัญในกระบวนการแปลงสตรีมภาพเป็น PDF

A: การระบุไดเร็กทอรีเอกสารจะทำให้แน่ใจว่าสตรีมรูปภาพและไฟล์ PDF ที่ได้จะอยู่ในเส้นทางเอาต์พุตที่ต้องการอย่างถูกต้อง

#### ถาม: ฉันจะสร้างเอกสาร PDF โดยใช้ Aspose.PDF สำหรับ .NET ในกระบวนการแปลงสตรีมรูปภาพเป็น PDF ได้อย่างไร

 ก. สร้างตัวอย่าง`Document` วัตถุที่ใช้`Aspose.Pdf.Document` ตัวสร้างที่ว่างเปล่าของคลาสเพื่อสร้างเอกสาร PDF

####  ถาม: บทบาทของมันคืออะไร`Pages` object in the image stream to PDF conversion process?

 ก. การ`Pages` วัตถุช่วยให้คุณสามารถเพิ่มหน้าในเอกสาร PDF และจัดการเนื้อหาได้

#### ถาม: สตรีมภาพจะอ่านและประมวลผลสตรีมภาพเป็นกระบวนการแปลง PDF ได้อย่างไร

 A: สตรีมภาพจะถูกอ่านโดยใช้`FileStream` วัตถุและเนื้อหาจะถูกเก็บไว้ในอาร์เรย์ไบต์ จากนั้นอาร์เรย์ไบต์จะถูกใช้เพื่อสร้าง`MemoryStream` วัตถุซึ่งใช้ในการสร้างในภายหลัง`Image` วัตถุ.

#### ถาม: รูปภาพจะถูกฝังลงในเอกสาร PDF ในระหว่างกระบวนการแปลงอย่างไร

 ก. อัน`Image` วัตถุถูกสร้างขึ้นโดยใช้`Aspose.Pdf.Image` คลาสและสตรีมภาพได้รับการกำหนดให้กับ`ImageStream` ทรัพย์สิน.`Image` จากนั้นเพิ่มวัตถุเข้าไป`Paragraphs` การรวบรวมเอกสาร PDF

#### ถาม: ฉันสามารถปรับแต่งตำแหน่ง ขนาด หรือคุณลักษณะอื่นๆ ของรูปภาพในไฟล์ PDF ผลลัพธ์ได้หรือไม่

 A: ใช่ คุณสามารถปรับเปลี่ยนตำแหน่ง ขนาด และคุณลักษณะอื่นๆ ของรูปภาพได้โดยการปรับคุณสมบัติของ`Image` วัตถุก่อนที่จะเพิ่มมันเข้าไปใน`Paragraphs` ของสะสม.

#### ถาม: ขั้นตอนสุดท้ายในกระบวนการแปลงสตรีมภาพเป็น PDF คืออะไร

 A: เอกสาร PDF จะถูกบันทึกโดยใช้`Save` วิธีการของ`Document` วัตถุ และ`MemoryStream` วัตถุถูกปิดโดยใช้`Close`วิธีการปล่อยทรัพยากร