---
title: Установить дату истечения срока действия в PDF-файле
linktitle: Установить дату истечения срока действия в PDF-файле
second_title: Справочник по API Aspose.PDF для .NET
description: Узнайте, как установить дату истечения срока действия в файлах PDF с помощью Aspose.PDF для .NET. Повысьте безопасность документов с помощью этого пошагового руководства.
type: docs
weight: 300
url: /ru/net/programming-with-document/setexpirydate/
---
## Введение

В сегодняшнюю цифровую эпоху управление и защита документов важнее, чем когда-либо. Представьте себе отправку PDF-файла, который автоматически становится недоступным после определенной даты. Звучит как магия, не так ли? Что ж, с Aspose.PDF для .NET вы можете легко установить дату истечения срока действия для ваших PDF-файлов. Эта функция особенно полезна для конфиденциальных документов, которые необходимо ограничить после определенного периода. В этом руководстве мы шаг за шагом проведем вас через процесс установки даты истечения срока действия в PDF-файле. Итак, хватайте свою шляпу кодера, и давайте нырнем!

## Предпосылки

Прежде чем начать, вам необходимо подготовить несколько вещей:

1. Среда разработки: Убедитесь, что у вас настроена среда разработки .NET. Это может быть Visual Studio или любая другая IDE, поддерживающая .NET.
2.  Aspose.PDF для .NET: Вам необходимо установить библиотеку Aspose.PDF. Если вы еще этого не сделали, вы можете загрузить ее с[здесь](https://releases.aspose.com/pdf/net/).
3. Базовые знания C#: Этот урок предполагает, что у вас есть базовые знания программирования на C#. Если вы новичок в C#, не волнуйтесь! Мы сделаем все просто и понятно.

## Импортные пакеты

Чтобы начать работу с Aspose.PDF, вам нужно импортировать необходимые пространства имен в ваш проект C#. Вот как это можно сделать:

```csharp
using System.IO;
using System;
using Aspose.Pdf;
using Aspose.Pdf.Annotations;
using Aspose.Pdf.Text;
```

Эти пространства имен предоставляют вам доступ к основным функциям, необходимым для работы с PDF-документами в Aspose.PDF.

## Шаг 1: Настройте каталог документов

Прежде всего, вам нужно указать путь к каталогу ваших документов. Это то место, где будет сохранен ваш выходной PDF. 

```csharp
string dataDir = "YOUR DOCUMENT DIRECTORY";
```

 Заменять`"YOUR DOCUMENT DIRECTORY"` с фактическим путем, по которому вы хотите сохранить свой PDF-файл. Это как сказать вашей программе: «Эй, вот где я храню свои файлы!»

## Шаг 2: Создание объекта документа

 Далее вам необходимо создать новый экземпляр`Document` класс. Это ваш холст, на котором вы будете создавать свой PDF.

```csharp
Aspose.Pdf.Document doc = new Aspose.Pdf.Document();
```

 Подумайте о`Document` объект как чистый лист бумаги. Вы можете добавлять в него содержимое по своему усмотрению!

## Шаг 3: Добавьте страницу в PDF-файл

Теперь, когда вы настроили документ, пришло время добавить к нему страницу. Здесь будет размещаться ваш контент.

```csharp
doc.Pages.Add();
```

Вы только что создали новую страницу в вашем PDF. Это как добавление новой страницы в ваш блокнот, где вы можете записывать свои мысли.

## Шаг 4: Добавьте текст на страницу

Давайте сделаем эту страницу немного интереснее, добавив немного текста. Мы добавим простое сообщение «Hello World».

```csharp
doc.Pages[1].Paragraphs.Add(new TextFragment("Hello World..."));
```

Эта строка кода добавляет фрагмент текста на первую страницу вашего PDF. Это как написать заголовок вверху страницы!

## Шаг 5: Создайте JavaScript для даты истечения срока действия

Теперь начинается самое интересное! Вы создадите действие JavaScript, которое будет проверять дату истечения срока действия PDF. Если текущая дата превышает дату истечения срока действия, пользователь получит сообщение.

```csharp
JavascriptAction javaScript = new JavascriptAction(
"var year=2017;"
+ "var month=5;"
+ "today = new Date(); today = new Date(today.getFullYear(), today.getMonth());"
+ "expiry = new Date(year, month);"
+ "if (today.getTime() > expiry.getTime())"
+ "app.alert('The file is expired. You need a new one.');");
```

Вот что происходит:
- Вы определяете год и месяц истечения срока действия.
- Вы получаете сегодняшнюю дату.
- Вы сравниваете сегодняшнюю дату с датой истечения срока действия.
- Если сегодняшняя дата уже истекла, появится сообщение!

## Шаг 6: Установите JavaScript в качестве действия открытия PDF-файла

Теперь вам нужно установить действие JavaScript как действие открытия для вашего документа PDF. Это означает, что JavaScript будет запущен сразу после открытия PDF.

```csharp
doc.OpenAction = javaScript;
```

Эта строка сообщает PDF-файлу, что нужно выполнить JavaScript, когда кто-то его открывает. Это как установить напоминание, которое срабатывает, как только вы открываете календарь!

## Шаг 7: Сохраните PDF-документ.

Наконец, пришло время сохранить ваш PDF-документ с функцией указания срока действия. 

```csharp
dataDir = dataDir + "SetExpiryDate_out.pdf";
doc.Save(dataDir);
```

Эта строка сохраняет ваш PDF в указанном каталоге с именем "SetExpiryDate_out.pdf". Это как поместить готовую работу в рамку!

## Заключение

И вот оно! Вы успешно создали PDF-файл с датой истечения срока действия с помощью Aspose.PDF для .NET. Эта функция не только повышает безопасность, но и гарантирует, что конфиденциальная информация будет под контролем. Независимо от того, отправляете ли вы контракты, отчеты или любые другие важные документы, установка даты истечения срока действия может изменить правила игры.

## Часто задаваемые вопросы

### Что такое Aspose.PDF для .NET?
Aspose.PDF для .NET — это мощная библиотека, которая позволяет разработчикам создавать, обрабатывать и конвертировать PDF-документы в приложениях .NET.

### Могу ли я использовать Aspose.PDF бесплатно?
 Да, вы можете использовать бесплатную пробную версию Aspose.PDF. Вы можете скачать ее[здесь](https://releases.aspose.com/).

### Как приобрести Aspose.PDF?
Вы можете купить Aspose.PDF, посетив[страница покупки](https://purchase.aspose.com/buy).

### Что делать, если мне нужна поддержка?
Если у вас есть вопросы или вам нужна помощь, вы можете посетить[Форум поддержки Aspose](https://forum.aspose.com/c/pdf/10).

### Могу ли я получить временную лицензию на Aspose.PDF?
 Да, вы можете запросить временную лицензию.[здесь](https://purchase.aspose.com/temporary-license/).